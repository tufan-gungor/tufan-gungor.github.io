<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Calling Conventions for Reverse Engineering" /><meta name="author" content="Tufan Gungor" /><meta property="og:locale" content="en" /><meta name="description" content="What is Calling Convention ?" /><meta property="og:description" content="What is Calling Convention ?" /><link rel="canonical" href="https://tufan-gungor.github.io/posts/x86-calling-conventions/" /><meta property="og:url" content="https://tufan-gungor.github.io/posts/x86-calling-conventions/" /><meta property="og:site_name" content="tufan." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-12T19:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Calling Conventions for Reverse Engineering" /><meta name="twitter:site" content="@tufan_gngr" /><meta name="twitter:creator" content="@Tufan Gungor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Tufan Gungor"},"dateModified":"2022-07-13T06:06:51+03:00","datePublished":"2022-07-12T19:00:00+03:00","description":"What is Calling Convention ?","headline":"Calling Conventions for Reverse Engineering","mainEntityOfPage":{"@type":"WebPage","@id":"https://tufan-gungor.github.io/posts/x86-calling-conventions/"},"url":"https://tufan-gungor.github.io/posts/x86-calling-conventions/"}</script><title>Calling Conventions for Reverse Engineering | tufan.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="tufan."><meta name="application-name" content="tufan."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/favicons/tufan_logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">tufan.</a></div><div class="site-subtitle font-italic">Malware Analysis & Threat Intelligence</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tufan-gungor" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/tufan_gngr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tufan.gngr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Calling Conventions for Reverse Engineering</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Calling Conventions for Reverse Engineering</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1657641600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-12 </em> </span> <span> Updated <em class="timeago" data-ts="1657681611" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-13 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2138 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><h2 id="what-is-calling-convention-"><span class="mr-2">What is Calling Convention ?</span><a href="#what-is-calling-convention-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The term “calling convention” describes;</p><ul><li>how arguments passed to the function and how values are returned from functions,<li>whether the caller or the callee will cleans the stack.</ul><p>There are different conventions based on processor, OS and language. Also, not every compiler implements the “calling conventions” the same way. Therefore, only the standard 4 calling conventions will be discussed in this article.</p><ul><li>__cdecl<li>__stdcall<li>__fastcall<li>__thiscall</ul><p>Also, developers can sometimes use custom calling conventions. For detailed information on this subject, you can subscribe to <a href="https://www.patreon.com/oalabs">OALabs from Patreon</a> and view the __usercall tutorial. They have very good videos on this subject.</p><h3 id="__cdecl"><span class="mr-2">__cdecl</span><a href="#__cdecl" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>__cdecl (which stands for C declaration) is the default calling convention in C and C++. Therefore, you will come across this definition many times while reading assembly in tools such as IDA and Ghidra.</p><p>Characteristics of <code class="language-plaintext highlighter-rouge">__cdecl:</code></p><ol><li>Arguments are passed <code class="language-plaintext highlighter-rouge">on the stack in reverse order</code> (pushed right-to-left),<li><code class="language-plaintext highlighter-rouge">Caller</code> cleans the stack.<li>The return value is stored in <code class="language-plaintext highlighter-rouge">EAX</code>.</ol><p>Let’s say we have a function called “sumNumbers” and it takes 5 integer arguments, then returns the sum of these numbers.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">sumNumbers</span><span class="p">(</span><span class="kt">int</span> <span class="n">number1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">number2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">number3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">number4</span><span class="p">,</span> <span class="kt">int</span> <span class="n">number5</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">numSum</span> <span class="o">=</span> <span class="n">number1</span> <span class="o">+</span> <span class="n">number2</span> <span class="o">+</span> <span class="n">number3</span> <span class="o">+</span> <span class="n">number4</span> <span class="o">+</span> <span class="n">number5</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">numSum</span><span class="p">;</span>

<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">numberSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">numberSum</span> <span class="o">=</span> <span class="n">sumNumbers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Result: %d"</span><span class="p">,</span><span class="n">numberSum</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>After compiling this code, when we open it in a tool like Ghidra or IDA, it will look like below.</p><p><img data-src="/assets/img/calling_conventions/Untitled.png" alt="Untitled" data-proofer-ignore></p><ul><li>As seen in the first box, the arguments were passed to the stack in reverse order, then the function called. Which is the first key point to recognize __cdecl. <code class="language-plaintext highlighter-rouge">(1)</code><li>And in the second box, <code class="language-plaintext highlighter-rouge">0x14 (20) is added to the ESP</code>. As 5 arguments are sent to the stack and each argument takes up 4 bytes, <code class="language-plaintext highlighter-rouge">caller cleans the stack</code> 20 byte. <code class="language-plaintext highlighter-rouge">(2)</code><li>In __cdecl, you will usually see the line <code class="language-plaintext highlighter-rouge">add esp,&lt;area to be cleaned&gt;,</code> 1 step after the function call.<li>And as seen in the last box, the <code class="language-plaintext highlighter-rouge">return value in EAX</code> is passed to the printf function to be printed. <code class="language-plaintext highlighter-rouge">(3)</code><li>Also you can see that, the reverse engineering tools usually recognize calling functions. (Blue Underline in screenshot.) But we still won’t trust the information there too much. We will examine the reason specifically under the “Why are calling conventions important for reverse engineering ? “ part.</ul><h3 id="__stdcall"><span class="mr-2">__stdcall</span><a href="#__stdcall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>__stdcall is the standard calling convention for Win32 API calls. __stdcall characteristics almost identical with __cdecl calling convention.</p><p>Characteristics of <code class="language-plaintext highlighter-rouge">__stdcall:</code></p><ol><li>Arguments are passed <code class="language-plaintext highlighter-rouge">on the stack in reverse order</code> (pushed right-to-left), → Same as __cdecl,<li>Callee cleans the stack.<li>The return value is stored in <code class="language-plaintext highlighter-rouge">EAX</code>. → Same as __cdecl.</ol><p>As you can see, the only difference between __cdecl and __stdcall is that, in __cdecl calling convention caller cleans the stack, while in __stdcall calling convention callee cleans the stack.</p><p>In this example we will look at the InternetOpenA API, which takes 5 arguments;</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">HINTERNET</span> <span class="nf">InternetOpenA</span><span class="p">(</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span> <span class="n">LPCSTR</span> <span class="n">lpszAgent</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span> <span class="n">DWORD</span>  <span class="n">dwAccessType</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span> <span class="n">LPCSTR</span> <span class="n">lpszProxy</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span> <span class="n">LPCSTR</span> <span class="n">lpszProxyBypass</span><span class="p">,</span>
  <span class="p">[</span><span class="n">in</span><span class="p">]</span> <span class="n">DWORD</span>  <span class="n">dwFlags</span>
<span class="p">);</span>
</pre></table></code></div></div><p>Let’s compile the code below for analyzing InternetOpenA WIN32 API.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="cp">#pragma comment(lib, "wininet.lib")
#include</span> <span class="cpf">&lt;WinSock2.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;wininet.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">RESULT</span><span class="p">{};</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="n">size</span><span class="p">];</span>
    <span class="n">DWORD</span> <span class="n">length</span><span class="p">;</span>

    <span class="n">HINTERNET</span> <span class="n">internet</span> <span class="o">=</span> <span class="n">InternetOpenA</span><span class="p">(</span><span class="s">"Mozilla/5.0"</span><span class="p">,</span> <span class="n">INTERNET_OPEN_TYPE_DIRECT</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">internet</span><span class="p">)</span>
        <span class="n">ExitProcess</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>

    <span class="n">HINTERNET</span> <span class="n">response</span> <span class="o">=</span> <span class="n">InternetOpenUrlA</span><span class="p">(</span><span class="n">internet</span><span class="p">,</span> <span class="s">"http://www.google.com"</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">response</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">InternetCloseHandle</span><span class="p">(</span><span class="n">internet</span><span class="p">);</span>
        <span class="n">ExitProcess</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">InternetReadFile</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">length</span><span class="p">);</span>
    <span class="n">InternetCloseHandle</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
    <span class="n">InternetCloseHandle</span><span class="p">(</span><span class="n">internet</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">buf</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>After compiling this code, when we open it in a tool like Ghidra or IDA, it will look like below.</p><p><img data-src="/assets/img/calling_conventions/Untitled%201.png" alt="Untitled" data-proofer-ignore></p><ul><li>As seen in the first box, the 5 parameters requested by the InternetOpenA API were <code class="language-plaintext highlighter-rouge">passed to the stack in reverse order</code>. <code class="language-plaintext highlighter-rouge">(1)</code><li>In the second box, after the InternetOpenA <code class="language-plaintext highlighter-rouge">result is returned in EAX,</code> it is moved to the [ebp+hInternet] address and checked if it is equal to 0 or not. <code class="language-plaintext highlighter-rouge">(3)</code><li>As a result, the caller did not take any action to clear the stack. Because the <code class="language-plaintext highlighter-rouge">callee (the InternetOpenA function itself) is responsible for stack cleaning</code>. <code class="language-plaintext highlighter-rouge">(2)</code></ul><p>As we showed on Ghidra in the previous example, we can see the calling convention of this function on IDA as well. (Hover mouse over the function name.)</p><p><img data-src="/assets/img/calling_conventions/Untitled%202.png" alt="Untitled" data-proofer-ignore></p><h3 id="__fastcall"><span class="mr-2">__fastcall</span><a href="#__fastcall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The main difference of __fastcall is that the initial arguments are passed to the registers instead of pushing to the stack. It’s faster to keep data in registers than in memory, so it’s called <code class="language-plaintext highlighter-rouge">FAST</code> call.</p><p>Characteristics of <code class="language-plaintext highlighter-rouge">__fastcall</code>:</p><ul><li>First two or three parameters will be passed in the registers EDX, ECX or EAX, and additional parameters are passed on to the stack.<li>The return value is stored in <code class="language-plaintext highlighter-rouge">EAX</code>.<li><code class="language-plaintext highlighter-rouge">Callee</code> cleans the stack.</ul><p><em>The first two DWORD or smaller arguments that are found in the argument list from left to right are passed in ECX and EDX registers; all other arguments are passed on the stack from right to left.</em> <code class="language-plaintext highlighter-rouge">(Microsoft)</code></p><p>Let’s compile the code below and analyze it in IDA.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">TestFunction</span><span class="p">(</span><span class="kt">int</span> <span class="n">num1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num4</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num5</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">nSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">nSum</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span> <span class="o">+</span> <span class="n">num3</span> <span class="o">+</span> <span class="n">num4</span> <span class="o">+</span> <span class="n">num5</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">nSum</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">nSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">nSum</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Result: %d"</span><span class="p">,</span> <span class="n">nSum</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><img data-src="/assets/img/calling_conventions/Untitled%203.png" alt="Untitled" data-proofer-ignore></p><ul><li>By looking at the first box, you can see that the <code class="language-plaintext highlighter-rouge">first 2 parameters are passed in the ECX and EDX</code> and the <code class="language-plaintext highlighter-rouge">other parameters are passed on to the stack</code>. <code class="language-plaintext highlighter-rouge">(1)</code><li>In the second box, <code class="language-plaintext highlighter-rouge">return value stored in EAX</code> and passed to the printf function. <code class="language-plaintext highlighter-rouge">(2)</code><li>We told that the <code class="language-plaintext highlighter-rouge">callee is responsible for stack cleaning (not registers)</code>, so in the last box you can see <code class="language-plaintext highlighter-rouge">caller</code> cleaning 8 bytes. 8/4=2 parameters. Which they are <code class="language-plaintext highlighter-rouge">ECX</code> and <code class="language-plaintext highlighter-rouge">EDX</code>.</ul><p>To see how callee handles stack cleaning, let’s jump into that function;</p><p><img data-src="/assets/img/calling_conventions/Untitled%204.png" alt="Untitled" data-proofer-ignore></p><ul><li>Since the first 2 arguments cleaned from ECX and EDX by caller, there is only 3 arguments left to be cleaned from stack. You can see in the box, <code class="language-plaintext highlighter-rouge">callee cleans up the stack</code> by using an operand to the <code class="language-plaintext highlighter-rouge">retn</code> instruction of <code class="language-plaintext highlighter-rouge">0Ch</code> (12). So the extra <code class="language-plaintext highlighter-rouge">12-bytes</code> (12/4 = 3 arguments) to be cleaned up <code class="language-plaintext highlighter-rouge">from stack</code> during the return operation.<li>You can also see that IDA recognizes that this function uses the __fastcall calling convention.</ul><blockquote><p>__fastcall is the default calling convention for Windows x64 Application Binary Interface (ABI). Unlike x32, it sends the first four parameters to the registers <code class="language-plaintext highlighter-rouge">rcx</code>, <code class="language-plaintext highlighter-rouge">rdx</code>, <code class="language-plaintext highlighter-rouge">r8</code> and <code class="language-plaintext highlighter-rouge">r9</code>, and the remaining parameters to the <code class="language-plaintext highlighter-rouge">stack</code>.</p></blockquote><p><em>Integer arguments are passed in registers RCX, RDX, R8, and R9. Floating point arguments are passed in XMM0L, XMM1L, XMM2L, and XMM3L. 16-byte arguments are passed by reference. Parameter passing is described in detail in Parameter passing. These registers, and RAX, R10, R11, XMM4, and XMM5, are considered volatile, or potentially changed by a callee on return.</em> <code class="language-plaintext highlighter-rouge">(Microsoft)</code></p><h3 id="__thiscall"><span class="mr-2">__thiscall</span><a href="#__thiscall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The Microsoft-specific <code class="language-plaintext highlighter-rouge">__thiscall</code> calling convention is used on C++ class member functions on the x86 architecture. (passing the <code class="language-plaintext highlighter-rouge">“this”</code> object)</p><p>Characteristics of <code class="language-plaintext highlighter-rouge">__thiscall</code>:</p><ul><li>Arguments are passed <code class="language-plaintext highlighter-rouge">on the stack in reverse order</code> (pushed right-to-left).<li>The <code class="language-plaintext highlighter-rouge">“this”</code> object pointer is passed via <code class="language-plaintext highlighter-rouge">ECX</code> register<code class="language-plaintext highlighter-rouge">.</code><li><code class="language-plaintext highlighter-rouge">Callee</code> is responsible for stack cleanup.</ul><p>Let’s compile a simple code to analyze __thiscall.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Numbers</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">sumNumbers</span><span class="p">(</span><span class="kt">int</span> <span class="n">num1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num2</span><span class="p">);</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">Numbers</span><span class="o">::</span><span class="n">sumNumbers</span><span class="p">(</span><span class="kt">int</span> <span class="n">num1</span><span class="p">,</span><span class="kt">int</span> <span class="n">num2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">nSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">nSum</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">nSum</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Numbers</span> <span class="n">myObj</span><span class="p">;</span> <span class="c1">// Create an object of Numbers</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">myObj</span><span class="p">.</span><span class="n">sumNumbers</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// Call the method with an argument</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><img data-src="/assets/img/calling_conventions/Untitled%205.png" alt="Untitled" data-proofer-ignore></p><ul><li>Parameters (100,200) are <code class="language-plaintext highlighter-rouge">passed to the stack in reverse order.</code> Actually, we called as (200,100)<li>The <code class="language-plaintext highlighter-rouge">“this”</code> object pointer stored in <code class="language-plaintext highlighter-rouge">ECX.</code></ul><p>To see where the stack cleaning job is done, let’s jump into the function.</p><p><img data-src="/assets/img/calling_conventions/Untitled%206.png" alt="Untitled" data-proofer-ignore></p><ul><li>You can see in the box, <code class="language-plaintext highlighter-rouge">callee cleans up the stack</code> by using an operand to the <code class="language-plaintext highlighter-rouge">retn</code> instruction of <code class="language-plaintext highlighter-rouge">8</code>. So the extra <code class="language-plaintext highlighter-rouge">8-bytes</code> (8/4 = 2 arguments) to be cleaned up <code class="language-plaintext highlighter-rouge">from stack</code> during the return operation.<li>You can also see that IDA recognizes <code class="language-plaintext highlighter-rouge">__thiscall.</code></ul><h2 id="calling-conventions-in-golang"><span class="mr-2">Calling Conventions in Golang</span><a href="#calling-conventions-in-golang" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Since Go is the most popular programming language lately, let’s also examine how the calling conventions look in the Golang.</p><p>Let’s compile a simple code to analyze calling conventions in Golang.</p><p>Since it is the fastest way for me, I compiled the code on a linux system using the following command.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">env </span><span class="nv">GOOS</span><span class="o">=</span>windows <span class="nv">GOARCH</span><span class="o">=</span>386 go build <span class="nt">-gcflags</span> <span class="s1">'-N -l'</span> main.go
</pre></table></code></div></div><blockquote><p>We used <code class="language-plaintext highlighter-rouge">-gcflags '-N -l'</code> parameter to disable compiler optimization.</p></blockquote><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">sumNumbers</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">,</span> <span class="n">num3</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span> <span class="o">+</span> <span class="n">num3</span>
        <span class="p">}</span>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">var</span> <span class="n">result</span> <span class="kt">int</span>
        <span class="n">num1</span> <span class="o">:=</span> <span class="m">3</span>
        <span class="n">num2</span> <span class="o">:=</span> <span class="m">5</span>
        <span class="n">num3</span> <span class="o">:=</span> <span class="m">8</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sumNumbers</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">,</span> <span class="n">num3</span><span class="p">)</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>In this example, the <code class="language-plaintext highlighter-rouge">sumNumbers</code> function will add the numbers 3,5 and 8 sent by the <code class="language-plaintext highlighter-rouge">main</code> function and return the result, and the <code class="language-plaintext highlighter-rouge">main</code> function will print this result to the screen.</p><p><img data-src="/assets/img/calling_conventions/Untitled%208.png" alt="Untitled" data-proofer-ignore></p><ul><li>In the first step, we see that <code class="language-plaintext highlighter-rouge">68 bytes (44h)</code> are allocated in the stack before the operation is performed.<li>In the second step, the parameters are passed to the <code class="language-plaintext highlighter-rouge">stack</code> in <code class="language-plaintext highlighter-rouge">straight order</code>.<li>In the third step, the sumNumbers function is called and the result returned from the memory address [esp+0Ch] is moved to eax. This is important to us because unlike most other languages, <code class="language-plaintext highlighter-rouge">the result is returned in the stack, not the register</code>.<li>Finally, in the fourth step, we see that the <code class="language-plaintext highlighter-rouge">fmtPrintln</code> function is called to print the result on the screen, and then the space allocated in the stack for the parameters is cleared. This means that the stack is cleared by the <code class="language-plaintext highlighter-rouge">callee</code>.</ul><blockquote><p>When we compile the code we use in this example for <code class="language-plaintext highlighter-rouge">x64</code>, we get the same results.</p></blockquote><h2 id="why-are-calling-conventions-important-for-reverse-engineering-"><span class="mr-2">Why are calling conventions important for reverse engineering ?</span><a href="#why-are-calling-conventions-important-for-reverse-engineering-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To understand why calling conventions are important, let’s take a step back and look again at our __fastcall example. We analyzed the code we compiled for our __fastcall example using IDA, and everything looked fine. This time, let’s examine the same sample file in the Ghidra tool.</p><p><img data-src="/assets/img/calling_conventions/Untitled%207.png" alt="Untitled" data-proofer-ignore></p><p>Let’s remember the parameter handling method of __fastcall.</p><ul><li><em>First two or three parameters will be passed in the registers EDX, ECX or EAX, and additional parameters are passed on to the stack.</em></ul><p>As you can see in the first box, the first two parameters are passed to ECX and EDX, and the remaining parameters are passed to the stack. But still the Ghidra tool says this function uses the __cdecl calling convention.</p><p>Therefore, instead of relying on such tools, it will be safer to recognize the calling convention when looking ahead in terms of following the parameters.</p><h2 id="test-it-yourself-"><span class="mr-2">Test It Yourself !!!</span><a href="#test-it-yourself-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>If you want to repeat the steps in this article, you can use 3 easy methods;</p><h3 id="1-use-online-compiler-explorer"><span class="mr-2">1. Use Online Compiler Explorer</span><a href="#1-use-online-compiler-explorer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><em>Compiler Explorer is an interactive <code class="language-plaintext highlighter-rouge">online</code> compiler which shows the <code class="language-plaintext highlighter-rouge">assembly</code> output of compiled C++, Rust, Go (and many more) code.</em></p><p>You can see the assembly output by copying the C++ codes used in this article and pasting them into <a href="https://godbolt.org/">Compiler Explorer</a>.</p><p>Don’t forget the choose;</p><p>Language: <code class="language-plaintext highlighter-rouge">C++</code></p><p>Compiler: <code class="language-plaintext highlighter-rouge">x86 msvc v19.latest</code></p><blockquote class="prompt-warning"><div><p>In this method, you will not see the calling convention. You can interpret it yourself by reading assembly.</p></div></blockquote><h3 id="2-compile-it-in-your-local-environment"><span class="mr-2">2. Compile It In Your Local Environment</span><a href="#2-compile-it-in-your-local-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The codes used in this article were compiled using Visual Studio 2022. You can compile the codes yourself using Visual Studio.</p><blockquote class="prompt-warning"><div><p>Since the functions used in this article are simple and static, if you do not turn off the ‘Compiler Optimization’ feature, you may not see the function call when examining the assembly. ‘Compiler Optimization’ will calculate and compile the result directly instead of compiling the function because the function is static.</p></div></blockquote><p>To disable ‘Compiler Optimization’ in Visual Studio follow the steps;</p><ul><li>Project - ProjectName Properties - C/C++ - Optimization - Change Optimization to <code class="language-plaintext highlighter-rouge">Disabled</code>.</ul><h3 id="3-download-the-files-used-in-this-article"><span class="mr-2">3. Download the Files Used in This Article</span><a href="#3-download-the-files-used-in-this-article" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>You can download the compiled version of all the codes used in this article from my Github repository.</p><p><a href="https://github.com/tufan-gungor/x86-Calling-Conventions-Sample-Files">Calling Convention Examples</a></p><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><a href="https://www.youtube.com/watch?v=9lzW0I9_cpY">OALabs Youtube</a> <code class="language-plaintext highlighter-rouge">(Patreon subscription is highly recommended!)</code><li><a href="https://docs.microsoft.com/en-us/cpp/cpp/calling-conventions?view=msvc-170">Microsoft Calling Conventions</a><li><a href="https://godbolt.org/">Compiler Explorer</a><li><a href="https://dr-knz.net/go-calling-convention-x86-64.html">The Go low-level calling convention on x86-64</a></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse engineering</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Calling Conventions for Reverse Engineering - tufan.&amp;url=https://tufan-gungor.github.io/posts/x86-calling-conventions/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Calling Conventions for Reverse Engineering - tufan.&amp;u=https://tufan-gungor.github.io/posts/x86-calling-conventions/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tufan-gungor.github.io/posts/x86-calling-conventions/&amp;text=Calling Conventions for Reverse Engineering - tufan." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spynote-android-malware/">Spynote Android Malware Masquerades as VPN Amid Turkey's Instagram Ban</a><li><a href="/posts/nightingale-stealer-analysis/">Hunt and Analysis - Nightingale Stealer</a><li><a href="/posts/hornet-stealer-analysis/">Hunt and Analysis - Hornet Stealer</a><li><a href="/posts/sentinel-stealer-analysis/">Hunt and Analysis - Sentinel Stealer</a><li><a href="/posts/neptune-loader-analysis/">Hunt and Analysis - Neptune Loader</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/serpent-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1704556800" > 2024-01-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Serpent Stealer</h3><div class="text-muted small"><p> Part 1 - Dissecting the First Serpent Stealer Sample On October 15, 2023, a new malware named Serpent Stealer was showcased on Breach Forums by a user named stealth. This malware, categorized as a...</p></div></div></a></div><div class="card"> <a href="/posts/neptune-loader-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705161600" > 2024-01-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Neptune Loader</h3><div class="text-muted small"><p> Part 1 - Neptune || A Native HTTP Loader A user named m0hx shared a post on hackforums.net on November 22, 2023, promoting a loader called Neptune. In the threat actor’s exact words; “Neptune is ...</p></div></div></a></div><div class="card"> <a href="/posts/sentinel-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705766400" > 2024-01-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Sentinel Stealer</h3><div class="text-muted small"><p> Part 1 - Sentinel Stealer || Stealer as a Service On January 19th, the Twitter account @FalconFeedsio reported the discovery of a new stealer, known as Sentinel Stealer. Although there were earlie...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/serpent-stealer-analysis/" class="btn btn-outline-primary" prompt="Newer"><p>Hunt and Analysis - Serpent Stealer</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QEK7ERP9FL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QEK7ERP9FL'); }); </script>
