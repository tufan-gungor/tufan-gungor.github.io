<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hunt and Analysis - Neptune Loader" /><meta name="author" content="Tufan Gungor" /><meta property="og:locale" content="en" /><meta name="description" content="Part 1 - Neptune || A Native HTTP Loader" /><meta property="og:description" content="Part 1 - Neptune || A Native HTTP Loader" /><link rel="canonical" href="https://tufan-gungor.github.io/posts/neptune-loader-analysis/" /><meta property="og:url" content="https://tufan-gungor.github.io/posts/neptune-loader-analysis/" /><meta property="og:site_name" content="tufan." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-13T19:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hunt and Analysis - Neptune Loader" /><meta name="twitter:site" content="@tufan_gngr" /><meta name="twitter:creator" content="@Tufan Gungor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Tufan Gungor"},"dateModified":"2024-01-18T22:58:36+03:00","datePublished":"2024-01-13T19:00:00+03:00","description":"Part 1 - Neptune || A Native HTTP Loader","headline":"Hunt and Analysis - Neptune Loader","mainEntityOfPage":{"@type":"WebPage","@id":"https://tufan-gungor.github.io/posts/neptune-loader-analysis/"},"url":"https://tufan-gungor.github.io/posts/neptune-loader-analysis/"}</script><title>Hunt and Analysis - Neptune Loader | tufan.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="tufan."><meta name="application-name" content="tufan."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/favicons/tufan_logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">tufan.</a></div><div class="site-subtitle font-italic">Malware Analysis & Threat Intelligence</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tufan-gungor" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/tufan_gngr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tufan.gngr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hunt and Analysis - Neptune Loader</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hunt and Analysis - Neptune Loader</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1705161600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-13 </em> </span> <span> Updated <em class="timeago" data-ts="1705607916" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-18 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2421 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><h1 id="part-1---neptune--a-native-http-loader">Part 1 - Neptune || <strong>A Native HTTP Loader</strong></h1><p>A user named <code class="language-plaintext highlighter-rouge">m0hx</code> shared a post on <a href="https://hackforums.net/showthread.php?tid=6256979">hackforums.net</a> on November 22, 2023, promoting a loader called <code class="language-plaintext highlighter-rouge">Neptune</code>. In the threat actor’s exact words;</p><p><em>“Neptune is an innovative HTTP loader project that provides robust and efficient control over computer systems through commands administered via user-friendly web panel.”</em></p><p><img data-src="/assets/img/neptune/0.png" alt="Untitled" data-proofer-ignore></p><p>On January 9th, nearly two months subsequent to the initial post, <a href="https://twitter.com/ViriBack">@ViriBack</a>, a user on X (formerly Twitter), disclosed the IP addresses of three detected Neptune Loader command and control centers.</p><p><img data-src="/assets/img/neptune/1.png" alt="Untitled" data-proofer-ignore></p><p>After <a href="https://twitter.com/ViriBack">@Viriback</a>’s post, Twitter users <a href="https://twitter.com/banthisguy9349">@banthisguy9349</a> and <a href="https://twitter.com/ShanHolo">@ShanHolo</a> also shared the Neptune Loader C2 addresses they had identified.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>tdboat.online
mfuk.app
</pre></table></code></div></div><h1 id="part-2---dissecting-the-first-neptune-sample">Part 2 - Dissecting the First Neptune Sample</h1><p>By conducting a search for the domain <code class="language-plaintext highlighter-rouge">tdboat.online</code> on VirusTotal and examining its associated relations, an intriguing discovery emerges: a URL containing <code class="language-plaintext highlighter-rouge">task.php</code> in its path.</p><p><img data-src="/assets/img/neptune/2.png" alt="Untitled" data-proofer-ignore></p><p>Upon examining the relationships of this URL, we uncover an associated malware named “Valorant_Cheat.exe”.</p><p><img data-src="/assets/img/neptune/3.png" alt="Untitled" data-proofer-ignore></p><p>Our analysis will initially focus on this particular file.</p><p><img data-src="/assets/img/neptune/4.png" alt="Untitled" data-proofer-ignore></p><p><strong>SHA256: <em>2a3549512f5f9cf1b11a26897a79532adc548c3000fb7b07fcae6b49cd5222ad</em></strong></p><p><em>Exeinfo output for Valorant_Cheat.exe</em></p><p><code class="language-plaintext highlighter-rouge">[ (GNU) 9.3-win32 20200320 ] - GCC MINGW-64w compiler for 32/64 bit ( exe )</code></p><p>Upon loading this sample into IDA, we observe a sizable data blob in the section named <code class="language-plaintext highlighter-rouge">.UH2oS6N</code>. Additionally, the IDA Navigator reveals a notably small code area, which typically implies two potential scenarios: the file is either packed or encrypted.</p><p><img data-src="/assets/img/neptune/5.png" alt="Untitled" data-proofer-ignore></p><p>The function <code class="language-plaintext highlighter-rouge">sub_401530</code>, identified during our examination of calls made by the <code class="language-plaintext highlighter-rouge">start</code> function, exhibits compelling behavior. It dynamically loads <code class="language-plaintext highlighter-rouge">USER32.dll</code> and retrieves the <code class="language-plaintext highlighter-rouge">VirtualAlloc</code> function. The function then allocates new memory with <strong><code class="language-plaintext highlighter-rouge">PAGE_EXECUTE_READWRITE</code></strong> permissions (0x40) and uses <strong><code class="language-plaintext highlighter-rouge">memcpy</code></strong> to transfer data from the <code class="language-plaintext highlighter-rouge">.UH2oS6N</code> section into this allocated space. Finally, it shifts execution to the beginning of this newly written section, a technique commonly seen in unpacking or decrypting executable code.</p><p><img data-src="/assets/img/neptune/6.png" alt="Untitled" data-proofer-ignore></p><p>The unmodified transfer of data from the <code class="language-plaintext highlighter-rouge">.UH2oS6N</code> section to the allocated memory, followed by a change in the execution flow to this area, suggests that the <code class="language-plaintext highlighter-rouge">.UH2oS6N</code> section could contain executable code instead of data. We can confirm this in IDA by transforming this section’s data into code, enabling a deeper examination of its contents.</p><p><img data-src="/assets/img/neptune/7.png" alt="Untitled" data-proofer-ignore></p><p>Transforming the initial part of the ‘.UH2oS6N’ section into code within IDA, we quickly notice a call to ‘sub_4AF27C’. Intriguingly, this function employs rotational (ror/rol) and XOR techniques for decryption, suggesting complex encryption mechanisms at play.</p><p><img data-src="/assets/img/neptune/8.png" alt="Untitled" data-proofer-ignore></p><p>Rather than dedicating time to statically dissecting this routine in IDA, a more efficient approach would be to open the file in a debugger. This allows the decryption process to unfold naturally, enabling us to observe the decrypted code directly.</p><h2 id="unpacking--decryption"><span class="mr-2">Unpacking / Decryption</span><a href="#unpacking--decryption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In x64dbg, to reach the same point of analysis as in IDA, these steps should be followed: Initially, place a breakpoint on <strong><code class="language-plaintext highlighter-rouge">VirtualAlloc</code></strong>. Proceed to run the code until this breakpoint is hit. Continue running the code until it completes the return, then step over to revert to the user code. This process will bring us to the crucial moment where the <code class="language-plaintext highlighter-rouge">.UH2oS6N</code> section is written into the allocated memory, and the execution is redirected there.</p><p><img data-src="/assets/img/neptune/9.png" alt="Untitled" data-proofer-ignore></p><p>For deeper analysis, the next step in x64dbg involves running the code up to the <code class="language-plaintext highlighter-rouge">call eax</code> instruction at the address <code class="language-plaintext highlighter-rouge">0040165F</code>. Once there, use ‘Step into’ (F7) to delve into the function being called. There are few more xor decryptions.</p><p><img data-src="/assets/img/neptune/10.png" alt="Untitled" data-proofer-ignore></p><p>Continuing to run the code step by step in x64dbg, while keeping a close eye on the allocated memory, reveals the unfolding decryption. Intriguingly, this process gradually uncovers the ‘MZ’ and ‘PE’ headers, hallmarks of executable files, signifying that the decrypted data forms a valid executable structure.</p><p><img data-src="/assets/img/neptune/11.png" alt="Untitled" data-proofer-ignore></p><p>At this point, we have a few options:</p><ul><li>Continue analysis in the debugger, which is quicker but lacks decompiling features and might face anti-debugger methods.<li>Extract and examine a memory dump of the executable, which may involve fixing the Import Address Table (IAT).<li>Use <a href="https://www.unpac.me/">Unpacme</a> to automatically extract the unpacked child process.</ul><p><strong><em>Later in this article, we will uncover that this is the Amber Reflective PE Packer.</em></strong></p><h2 id="analysis-of-unpacked-sample"><span class="mr-2">Analysis of Unpacked Sample</span><a href="#analysis-of-unpacked-sample" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>After successfully unpacking the file using one of the recommended methods, we can proceed to analyze the unpacked sample in IDA.</p><p>The function ‘sub_7FF16612’, called immediately in the WinMain function, primarily checks for the presence of a debugger. It begins by calling <strong><code class="language-plaintext highlighter-rouge">IsDebuggerPresent</code></strong> and <strong><code class="language-plaintext highlighter-rouge">CheckRemoteDebuggerPresent</code></strong> to detect debugging environments. Additionally, it employs a timing check using <strong><code class="language-plaintext highlighter-rouge">QueryPerformanceCounter</code></strong> and <strong><code class="language-plaintext highlighter-rouge">Sleep</code></strong> to identify unusually fast execution, which could indicate a debugger’s presence. If any of these checks suggest debugging, the function triggers a breakpoint with <strong><code class="language-plaintext highlighter-rouge">__debugbreak</code></strong>. The use of multiple debugger detection techniques indicates a deliberate effort to hinder reverse engineering or analysis in a debugging environment.</p><p><img data-src="/assets/img/neptune/12.png" alt="Untitled" data-proofer-ignore></p><p>In the scenario where no debugger is detected and the code executes successfully, the <code class="language-plaintext highlighter-rouge">WinMain</code> function proceeds to create a mutex with the name <code class="language-plaintext highlighter-rouge">d6d8c8d7-eacb-dc01-35aa-e872082a1ca1</code>. It then checks for creation failure, specifically for the error code <code class="language-plaintext highlighter-rouge">183</code>, which corresponds to <code class="language-plaintext highlighter-rouge">ERROR_ALREADY_EXISTS</code>. This check is a safeguard to prevent the program from running multiple instances on the same computer. If this specific error is encountered, indicating that the mutex already exists, the program halts, effectively preventing duplicate executions.</p><p><img data-src="/assets/img/neptune/13.png" alt="Untitled" data-proofer-ignore></p><p>If the program bypasses the mutex check, indicating that error <code class="language-plaintext highlighter-rouge">183 ('ERROR_ALREADY_EXISTS')</code> is not present, it initiates multiple threads. First, a thread is created with <strong><code class="language-plaintext highlighter-rouge">CreateThread</code></strong>, invoking the function <code class="language-plaintext highlighter-rouge">sub_7FF116B2</code> with the argument <code class="language-plaintext highlighter-rouge">REGISTER</code>. Following this, two additional threads are created, both calling <code class="language-plaintext highlighter-rouge">sub_7FF116B2</code> and <code class="language-plaintext highlighter-rouge">sub_7FF11932</code>, respectively, each with the argument <code class="language-plaintext highlighter-rouge">GETCMD</code>. The program then waits for the first thread to complete using <strong><code class="language-plaintext highlighter-rouge">WaitForSingleObject</code></strong> with an infinite timeout (<code class="language-plaintext highlighter-rouge">0xFFFFFFFF</code>). Finally, it returns 0, concluding this sequence of operations.</p><ol><li>REGISTER (sub_7FF116B2)</ol><p>In the <code class="language-plaintext highlighter-rouge">REGISTER</code> routine of the Neptune malware, a pivotal network communication is established. It sends a request to <code class="language-plaintext highlighter-rouge">gate.php</code>, accompanied by a <code class="language-plaintext highlighter-rouge">password</code> parameter.</p><p><em>The routine’s extensive scope and complexity make it too large to fit within the confines of a single screenshot in IDA Graph, prompting the use of a decompiler for more effective visualization and detailed analysis</em></p><p><img data-src="/assets/img/neptune/14.png" alt="Untitled" data-proofer-ignore></p><p>This step acts as a verification process with the command and control (C2) server. A correct password elicits a response of <code class="language-plaintext highlighter-rouge">Gate is open</code> from the C2, indicating successful entry. On the other hand, an incorrect password triggers a redirection to <code class="language-plaintext highlighter-rouge">index.php</code>, serving as a gatekeeping mechanism.</p><p><img data-src="/assets/img/neptune/15.png" alt="Untitled" data-proofer-ignore></p><p>“Once the ‘Gate is open’ response is received from the C2 server, indicating successful password verification, Neptune proceeds to the next stage. It sends a request to ‘addbot.php’, this time with a set of specific parameters:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="o">&amp;</span><span class="n">lan</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">macAddress</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">port</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">computerName</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">userName</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">osName</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">country</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">language</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">latitude</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">longitude</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">timezone</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">isAdmin</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">isLaptop</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">idle</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">version</span><span class="o">=</span><span class="n">v</span>
<span class="o">&amp;</span><span class="n">tag</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">note</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">antivirus</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">antivirus</span><span class="o">=</span><span class="n">None</span>
<span class="o">&amp;</span><span class="n">dotNETFramework</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">dotNET</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">java</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">sandboxie</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">vmware</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">virtualbox</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">sandbox</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">osType</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">osBit</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">exeBit</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">exePath</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">ram</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">cpuno</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">cpuName</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">gpuName</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">ramUsg</span><span class="o">=</span>
<span class="o">&amp;</span><span class="n">cpuUsg</span><span class="o">=</span>
</pre></table></code></div></div><p><img data-src="/assets/img/neptune/16.png" alt="Untitled" data-proofer-ignore></p><p>As part of its device information gathering process, the malware conducts a thorough check for the presence of antivirus software on the computer. It methodically scans through a predefined list of antivirus programs,</p><p><img data-src="/assets/img/neptune/17.png" alt="Untitled" data-proofer-ignore></p><p>The list of antivirus software was retrieved from this <a href="https://github.com/Karanxa/Bug-Bounty-Wordlists/blob/0cab044246b3f5d11949ce2dc935245f4d5af147/antivirus_names.txt">GitHub repository</a>.</p><p>The malware’s detection capabilities extend to identifying sandbox environments. It scrutinizes the process list for the presence of <code class="language-plaintext highlighter-rouge">SandMan.exe</code> and <code class="language-plaintext highlighter-rouge">SbieCtrl.exe</code>, both indicative of sandboxing. Additionally, it probes the system’s registry for the key <code class="language-plaintext highlighter-rouge">HKLM_SOFTWARE\Sophos\Sandboxie</code>, a telltale sign of a sandbox setup.</p><p><img data-src="/assets/img/neptune/18.png" alt="Untitled" data-proofer-ignore></p><p>Neptune initiates its virtualization detection by checking the <code class="language-plaintext highlighter-rouge">cpuid</code> instruction, a common method for identifying virtual machine environments. Following this, it employs a comprehensive strategy that includes process enumeration, registry key examination, and targeted file and library probes. Specifically, it seeks out the <code class="language-plaintext highlighter-rouge">VBoxService.exe</code> process, scrutinizes registry entries for VirtualBox-related information, and tests access to files and libraries unique to VirtualBox. This layered approach, starting from CPU instruction analysis to specific system checks, ensures a thorough and effective verification to determine if the malware is running in a virtualized setting.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>cpuid
SOFTWARE\\Sophos\\Sandboxie
SOFTWARE\\VMware, Inc.
SOFTWARE\\Oracle\\VirtualBox Guest Additions
SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Virtualization
VBoxService.exe
HARDWARE\\ACPI\\DSDT\\
VBOX__
\\\\.\\VBoxMiniRdrDN
VBoxHook.dll
</pre></table></code></div></div><p><img data-src="/assets/img/neptune/19.png" alt="Untitled" data-proofer-ignore></p><ol><li>GET_CMD (sub_7FF116B2, sub_7FF11932)</ol><p>In the next phase of operation, the <code class="language-plaintext highlighter-rouge">GETCMD</code> routine engages in regular communication with the C2 server. It does so by periodically dispatching requests to <code class="language-plaintext highlighter-rouge">tasks.php</code>, each tagged with a <code class="language-plaintext highlighter-rouge">bid</code> parameter that serves as the bot’s identification. This process is essential for the malware to receive and execute commands or tasks that the C2 server may have pending, maintaining its operational alignment with the server’s objectives.</p><p><img data-src="/assets/img/neptune/20.png" alt="Untitled" data-proofer-ignore></p><p>Below is a screenshot showcasing the full range of commands supported by the malware.</p><p><img data-src="/assets/img/neptune/21.png" alt="Untitled" data-proofer-ignore></p><p>Securing its communication channels, the Neptune malware implements AES (Rijndael) encryption, a step that comes into play after thorough parameter preparation.</p><h1 id="part-3---c2-panel">Part 3 - C2 Panel</h1><p>As we move into Part 3 of our analysis, focusing on the C2 Panel, we encounter key contributions from the cybersecurity community. On January 9, following <a href="https://twitter.com/ViriBack">@ViriBack</a>’s initial tweet on the topic, <a href="https://twitter.com/0xperator">@0xperator</a> further expanded our understanding by posting several screenshots on January 10 that reveal the inner workings of the Neptune C2 Panel.</p><p><img data-src="/assets/img/neptune/22.png" alt="Untitled" data-proofer-ignore></p><p>You can find the <a href="https://twitter.com/0xperator/status/1745176382915695096">original post here</a>.</p><p>To uncover C2 panels linked to Neptune, we utilize various online services like Shodan, FOFA, and Censys. In this context, we concentrate on <a href="https://search.censys.io/">Censys</a>. By examining known C2 addresses we can select few specific point to use in our query. Here is 3 example queries;</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">services</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">favicons</span><span class="p">.</span><span class="n">md5_hash</span><span class="o">=</span><span class="s">"39705673fd05bd34b425d495ed8471c9"</span>
<span class="n">services</span><span class="p">.</span><span class="n">software</span><span class="p">.</span><span class="n">uniform_resource_identifier</span><span class="p">:</span> <span class="s">"cpe:2.3:a:neptune-loader:neptune-loader:*:*:*:*:*:*:*:*"</span>
<span class="n">services</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">body_hash</span><span class="o">=</span><span class="s">"sha1:85cc188de3d85d423ef3f5f1cd1f6955c1d575d2"</span>
</pre></table></code></div></div><p>As of the time when this article was written, our Censys search queries have unveiled four IP addresses connected to the Neptune C2 Panel.</p><p><img data-src="/assets/img/neptune/23.png" alt="Untitled" data-proofer-ignore></p><h1 id="part-4---hunting-with-yara">Part 4 - Hunting with Yara</h1><p>As we embark on the journey to uncover more Neptune samples, we will develop two YARA rules. The first rule is aimed at detecting the packed sample, while the second rule is optimized for identifying the unpacked variant.</p><ol><li><strong>Yara Rule for Packed Sample</strong></ol><p>While examining the distinctive traits of the packed sample, several noteworthy characteristics emerge. Typically, the packed sample exhibits <code class="language-plaintext highlighter-rouge">more than seven sections</code>, one of which bears a <code class="language-plaintext highlighter-rouge">randomly generated seven-character name</code> and often possesses an <code class="language-plaintext highlighter-rouge">entropy value exceeding seven</code>. Additionally, this section tends to have a <code class="language-plaintext highlighter-rouge">substantial size</code>. The packer employs <code class="language-plaintext highlighter-rouge">VirtualAlloc</code> to allocate memory, utilizes <code class="language-plaintext highlighter-rouge">memcpy</code> for copying data from this section to the allocated memory, and concludes with a call to <code class="language-plaintext highlighter-rouge">eax</code> signifying the start of the newly allocated memory.</p><p><em>Our YARA rule adopts a somewhat aggressive approach by verifying if the entropy of the specific section exceeds 7 and if its size surpasses 240,000. While it is possible to lower these thresholds in certain scenarios, doing so may increase the likelihood of encountering false positives.</em></p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="n">import</span> <span class="s2">"pe"</span>
<span class="n">import</span> <span class="s2">"math"</span>
<span class="n">rule</span> <span class="n">NeptuneLoader_Packed_Amber</span> <span class="p">{</span>
	<span class="n">meta</span><span class="o">:</span>
		<span class="n">author</span> <span class="o">=</span> <span class="s2">"tufan - @tufan_gngr"</span>
		<span class="n">description</span> <span class="o">=</span> <span class="s2">"Detects Amber PE Reflective Packer used on Neptune Loader"</span>
		<span class="n">date</span> <span class="o">=</span> <span class="s2">"2024-01-14"</span>
		<span class="n">references</span> <span class="o">=</span> <span class="s2">"https://tufan-gungor.github.io/"</span>
	<span class="n">strings</span><span class="o">:</span>
		<span class="nv">$s1</span> <span class="o">=</span> <span class="s2">"VirtualAlloc"</span>
		<span class="nv">$s2</span> <span class="o">=</span> <span class="s2">"memcpy"</span>
		<span class="nv">$s3</span> <span class="o">=</span> <span class="p">{</span><span class="no">E8</span> <span class="mi">70</span> <span class="mi">10</span> <span class="mo">00</span> <span class="mo">00</span> <span class="mi">8</span><span class="nc">B</span> <span class="mi">45</span> <span class="no">D4</span> <span class="no">FF</span> <span class="no">D0</span><span class="p">}</span> <span class="c1">// call eax, following by memcpy</span>
		<span class="nv">$s4</span> <span class="o">=</span> <span class="p">{</span><span class="no">E8</span> <span class="mi">7</span><span class="o">?</span> <span class="mi">52</span> <span class="mi">0</span><span class="nc">A</span> <span class="mo">00</span><span class="p">}</span> <span class="c1">// immediate call in encrypted section</span>
	<span class="n">condition</span><span class="o">:</span>
		<span class="nf">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5A4D</span> <span class="k">and</span>
		<span class="nf">uint32</span><span class="p">(</span><span class="nf">uint32</span><span class="p">(</span><span class="mh">0x3C</span><span class="p">))</span> <span class="o">==</span> <span class="mh">0x00004550</span> <span class="k">and</span>
		<span class="n">pe</span><span class="mf">.</span><span class="n">number_of_sections</span> <span class="o">&gt;</span> <span class="mi">7</span> <span class="k">and</span>
		<span class="k">for</span> <span class="n">any</span> <span class="n">j</span> <span class="nf">in</span> <span class="p">(</span><span class="mf">0..</span><span class="n">pe</span><span class="mf">.</span><span class="n">number_of_sections</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">:</span> <span class="p">(</span>
			<span class="n">math</span><span class="mf">.</span><span class="nf">entropy</span><span class="p">(</span><span class="n">pe</span><span class="mf">.</span><span class="n">sections</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="mf">.</span><span class="n">raw_data_offset</span><span class="p">,</span> <span class="n">pe</span><span class="mf">.</span><span class="n">sections</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="mf">.</span><span class="n">raw_data_size</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span> <span class="k">and</span>
			<span class="n">pe</span><span class="mf">.</span><span class="n">sections</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="mf">.</span><span class="n">raw_data_size</span> <span class="o">&gt;=</span> <span class="mh">0x0003A980</span> <span class="k">and</span>
			<span class="n">pe</span><span class="mf">.</span><span class="n">sections</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="mf">.</span><span class="n">name</span> <span class="n">matches</span> <span class="o">/</span><span class="err">\</span><span class="mf">.</span><span class="p">[</span><span class="nc">A</span><span class="o">-</span><span class="nc">Za</span><span class="o">-</span><span class="n">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">7</span><span class="p">}</span><span class="o">/</span>
		<span class="p">)</span> <span class="k">and</span>
		<span class="mi">3</span> <span class="n">of</span> <span class="n">them</span>

<span class="p">}</span>
</pre></table></code></div></div><p>After running RetroHunt in VirusTotal with this Yara rule to find related samples, it yields numerous matches. Upon examining the characteristics of these files, there are suggestive similarities that might point to a potential association with an edited version reminiscent of the <a href="https://github.com/EgeBalci/amber">Amber Reflective PE packer</a>.</p><p><img data-src="/assets/img/neptune/24.png" alt="Untitled" data-proofer-ignore></p><p>While we refer to it as an ‘edited’ version, it’s important to note that YARA rules crafted by other researchers for detecting Amber do not align with the packed Neptune samples. However, the YARA rule designed specifically for packed Neptune samples has shown matches with files that have been packed using Amber.</p><p>All the packed samples share similar technical characteristics, including a seven-character-long section with encrypted data, among others. However, it’s worth noting that there are no strings or indicators explicitly related to Amber in these samples.</p><p>Given these circumstances, hunting Neptune samples by concentrating on its packer proves challenging. If the packer is identified as Amber, it can lead to numerous false positives. Therefore, our focus will shift towards the unpacked sample.</p><ol><li><strong>Yara Rule for Unpacked Sample</strong></ol><p>As you may recall, the unpacked sample reveals numerous distinct characteristics, including AV checks, VM checks, anti-debugging measures, C2 communication, and more. With this wealth of specific functions and behaviors, we can pinpoint and utilize particular strings associated with these functions to construct our YARA rule.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">rule</span> <span class="n">NeptuneLoader_Unpacked</span> <span class="p">{</span>
	<span class="n">meta</span><span class="o">:</span>
		<span class="n">author</span> <span class="o">=</span> <span class="s2">"tufan - @tufan_gngr"</span>
		<span class="n">description</span> <span class="o">=</span> <span class="s2">"Detects unpacked sample of Neptune Loader"</span>
		<span class="n">date</span> <span class="o">=</span> <span class="s2">"2024-01-14"</span>
		<span class="n">references</span> <span class="o">=</span> <span class="s2">"https://tufan-gungor.github.io/"</span>
	<span class="n">strings</span><span class="o">:</span>
		<span class="nv">$s1</span> <span class="o">=</span> <span class="s2">"REGISTER"</span>
		<span class="nv">$s2</span> <span class="o">=</span> <span class="s2">"GETCMD"</span>
		<span class="nv">$s3</span> <span class="o">=</span> <span class="s2">"httpflood"</span>
		<span class="nv">$s4</span> <span class="o">=</span> <span class="s2">"visitpagehidden"</span>
		<span class="nv">$s5</span> <span class="o">=</span> <span class="s2">"&amp;sandboxie="</span>
		<span class="nv">$s6</span> <span class="o">=</span> <span class="s2">"&amp;isLaptop="</span>
		<span class="nv">$s7</span> <span class="o">=</span> <span class="s2">"addbot.php"</span>
		<span class="nv">$s8</span> <span class="o">=</span> <span class="s2">"tasks.php"</span>
		<span class="nv">$s9</span> <span class="o">=</span> <span class="s2">"SOFTWARE</span><span class="se">\\</span><span class="s2">VMware"</span>
		<span class="nv">$s10</span> <span class="o">=</span> <span class="s2">"SOFTWARE</span><span class="se">\\</span><span class="s2">Oracle</span><span class="se">\\</span><span class="s2">VirtualBox"</span>
		<span class="nv">$s11</span> <span class="o">=</span> <span class="s2">"Gate is open"</span>
	<span class="n">condition</span><span class="o">:</span>
		<span class="nf">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5A4D</span> <span class="k">and</span>
		<span class="nf">uint32</span><span class="p">(</span><span class="nf">uint32</span><span class="p">(</span><span class="mh">0x3C</span><span class="p">))</span> <span class="o">==</span> <span class="mh">0x00004550</span> <span class="k">and</span>
		<span class="mi">7</span> <span class="n">of</span> <span class="n">them</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As our hunt primarily revolves around locating unpacked Neptune samples, we will deviate from the conventional approach of utilizing VirusTotal and initiate our search on <a href="https://www.unpac.me/">Unpacme</a>.</p><p>Upon running the Yara Hunt on Unpacme using our Yara rule, it flags three matches. Notably, the first two matches were as expected, representing samples employed within the ongoing campaign we are investigating. These files closely resemble the ones we’ve previously examined.</p><p><img data-src="/assets/img/neptune/25.png" alt="Untitled" data-proofer-ignore></p><p>However, the third file stands out as significantly distinct from the files we’ve previously analyzed. This particular file is a .NET executable named ‘ablast.exe,’ and it unfolds the Neptune sample after processing several others.</p><p><strong>SHA256: <em>f98cf9ee6e3f42fe35ec570b4728ecd65929ba24ba4c090c3b438c8de4677cc8 (packed parent)</em></strong></p><p><strong>SHA256: <em>cf70fa1d010f0077ccb4ff039f3764c47756113a7bcc28acbd5f96d6df56e9a7 (unpacked child)</em></strong></p><p>Upon examining the packed parent of this file on Tria.ge and VirusTotal, it becomes apparent that this particular sample is a variant of <code class="language-plaintext highlighter-rouge">zgRAT</code>. Intriguingly, following the unpacking process, it proceeds to execute Neptune.</p><p><img data-src="/assets/img/neptune/26.png" alt="Untitled" data-proofer-ignore></p><p>In examining its relations on VirusTotal, we notice a familiar network traffic.</p><p><img data-src="/assets/img/neptune/27.png" alt="Untitled" data-proofer-ignore></p><h1 id="part-5---iocs">Part 5 - IOCs</h1><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>2a3549512f5f9cf1b11a26897a79532adc548c3000fb7b07fcae6b49cd5222ad
f98cf9ee6e3f42fe35ec570b4728ecd65929ba24ba4c090c3b438c8de4677cc8
cf70fa1d010f0077ccb4ff039f3764c47756113a7bcc28acbd5f96d6df56e9a7
f98cf9ee6e3f42fe35ec570b4728ecd65929ba24ba4c090c3b438c8de4677cc8
91.92.240.153
91.92.240.152
194.33.191.106
91.92.252.7
94.156.65.54
mfuk.app
tdboat.online
ruspyc.top
</pre></table></code></div></div><h1 id="references">References</h1><ul><li><a href="https://hackforums.net/showthread.php?tid=6256979">https://hackforums.net/showthread.php?tid=6256979</a><li><a href="https://twitter.com/ViriBack/status/1744726264618119591">https://twitter.com/ViriBack/status/1744726264618119591</a><li><a href="https://twitter.com/ShanHolo/status/1744740555203203074">https://twitter.com/ShanHolo/status/1744740555203203074</a><li><a href="https://twitter.com/banthisguy9349/status/1744772559730593998">https://twitter.com/banthisguy9349/status/1744772559730593998</a><li><a href="https://twitter.com/0xperator/status/1745176382915695096">https://twitter.com/0xperator/status/1745176382915695096</a></ul><p><strong>I utilized AI assistance to fine-tune certain sentences in this post, enhancing clarity and precision.</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/malware-hunting/'>Malware Hunting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse engineering</a> <a href="/tags/malware-hunting/" class="post-tag no-text-decoration" >malware hunting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hunt and Analysis - Neptune Loader - tufan.&amp;url=https://tufan-gungor.github.io/posts/neptune-loader-analysis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hunt and Analysis - Neptune Loader - tufan.&amp;u=https://tufan-gungor.github.io/posts/neptune-loader-analysis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tufan-gungor.github.io/posts/neptune-loader-analysis/&amp;text=Hunt and Analysis - Neptune Loader - tufan." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spynote-android-malware/">Spynote Android Malware Masquerades as VPN Amid Turkey's Instagram Ban</a><li><a href="/posts/nightingale-stealer-analysis/">Hunt and Analysis - Nightingale Stealer</a><li><a href="/posts/hornet-stealer-analysis/">Hunt and Analysis - Hornet Stealer</a><li><a href="/posts/sentinel-stealer-analysis/">Hunt and Analysis - Sentinel Stealer</a><li><a href="/posts/neptune-loader-analysis/">Hunt and Analysis - Neptune Loader</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/serpent-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1704556800" > 2024-01-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Serpent Stealer</h3><div class="text-muted small"><p> Part 1 - Dissecting the First Serpent Stealer Sample On October 15, 2023, a new malware named Serpent Stealer was showcased on Breach Forums by a user named stealth. This malware, categorized as a...</p></div></div></a></div><div class="card"> <a href="/posts/sentinel-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705766400" > 2024-01-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Sentinel Stealer</h3><div class="text-muted small"><p> Part 1 - Sentinel Stealer || Stealer as a Service On January 19th, the Twitter account @FalconFeedsio reported the discovery of a new stealer, known as Sentinel Stealer. Although there were earlie...</p></div></div></a></div><div class="card"> <a href="/posts/hornet-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1706544000" > 2024-01-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Hornet Stealer</h3><div class="text-muted small"><p> Part 1 - Hornet Stealer On January 24th, the Twitter account @spamhaus posted a tweet regarding a newly discovered C2 panel. Based on the panel’s logo and name, they have identified this malwar...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/serpent-stealer-analysis/" class="btn btn-outline-primary" prompt="Older"><p>Hunt and Analysis - Serpent Stealer</p></a> <a href="/posts/sentinel-stealer-analysis/" class="btn btn-outline-primary" prompt="Newer"><p>Hunt and Analysis - Sentinel Stealer</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QEK7ERP9FL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QEK7ERP9FL'); }); </script>
