<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hunt and Analysis - Nightingale Stealer" /><meta name="author" content="Tufan Gungor" /><meta property="og:locale" content="en" /><meta name="description" content="Part 1 - Nightingale Stealer" /><meta property="og:description" content="Part 1 - Nightingale Stealer" /><link rel="canonical" href="https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/" /><meta property="og:url" content="https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/" /><meta property="og:site_name" content="tufan." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-05T19:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hunt and Analysis - Nightingale Stealer" /><meta name="twitter:site" content="@tufan_gngr" /><meta name="twitter:creator" content="@Tufan Gungor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Tufan Gungor"},"dateModified":"2024-02-06T13:19:32+03:00","datePublished":"2024-02-05T19:00:00+03:00","description":"Part 1 - Nightingale Stealer","headline":"Hunt and Analysis - Nightingale Stealer","mainEntityOfPage":{"@type":"WebPage","@id":"https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/"},"url":"https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/"}</script><title>Hunt and Analysis - Nightingale Stealer | tufan.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="tufan."><meta name="application-name" content="tufan."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/favicons/tufan_logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">tufan.</a></div><div class="site-subtitle font-italic">Malware Analysis & Threat Intelligence</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tufan-gungor" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/tufan_gngr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tufan.gngr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hunt and Analysis - Nightingale Stealer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hunt and Analysis - Nightingale Stealer</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1707148800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-02-05 </em> </span> <span> Updated <em class="timeago" data-ts="1707214772" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-02-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5948 words"> <em>33 min</em> read</span></div></div></div><div class="post-content"><h1 id="part-1---nightingale-stealer">Part 1 - Nightingale Stealer</h1><p><em>Spoiler Alert: If you are familiar with Phemedrone Stealer, be prepared for a revelation. Nightingale Stealer, as it turns out, is essentially an edited version of Phemedrone Stealer. Knowing this beforehand can help manage expectations as you read through this article.</em></p><p><img data-src="/assets/img/nightingale/0.png" alt="Untitled" data-proofer-ignore></p><p>On <code class="language-plaintext highlighter-rouge">December 15, 2023</code>, a user operating under the alias <code class="language-plaintext highlighter-rouge">-Nightingale-</code> posted an advertisement on <a href="https://hackforums.net/showthread.php?tid=6258265">HackForums</a> for a stealer malware dubbed <code class="language-plaintext highlighter-rouge">Nightingale's Stealer</code>. This threat is designed to exfiltrate credentials from 75 different wallets, alongside passwords, cookies, browser data, and application data from platforms such as <code class="language-plaintext highlighter-rouge">Steam</code>, <code class="language-plaintext highlighter-rouge">Telegram</code>, and <code class="language-plaintext highlighter-rouge">Discord</code>.</p><p><img data-src="/assets/img/nightingale/1.png" alt="Untitled" data-proofer-ignore></p><p>On January 29, 2024, nearly a month and a half after its initial appearance, Twitter user <a href="https://twitter.com/suyog41/status/1751930165230469619">@suyog41</a> posted about <code class="language-plaintext highlighter-rouge">Nightingale's Stealer</code>, sharing the hash of the malware sample.</p><p><img data-src="/assets/img/nightingale/2.png" alt="Untitled" data-proofer-ignore></p><p>In this article, we will concentrate on examining this particular malware sample. We’ll download it from <code class="language-plaintext highlighter-rouge">VirusTotal</code>, analyze its components, and decode its operational framework to gain a deeper understanding of its functionalities.</p><h1 id="part-2---dissecting-the-first-nightingales-stealer-sample">Part 2 - Dissecting The First Nightingale’s Stealer Sample</h1><p>Upon searching the hash on VirusTotal, it was found to be flagged as malicious by 52 out of 71 antivirus engines. Intriguingly, Yara Rules indicate that this sample is associated with <code class="language-plaintext highlighter-rouge">Phemedrone Stealer</code>, while various collections and comments suggest it might be <code class="language-plaintext highlighter-rouge">Formbook</code>. Let’s proceed to download the sample to ascertain its true nature.</p><p><img data-src="/assets/img/nightingale/3.png" alt="Untitled" data-proofer-ignore></p><p><strong>SHA256: <em>0cc6d724ac017163b40866c820fd67df6ac89924a623490ec1de2ecacf1d0219</em></strong></p><p>Upon opening the file in IDA, an intriguing aspect becomes apparent in the IDA navigator: the code area is noticeably small compared to a significantly larger data area. This characteristic typically indicates one of two possibilities: the file is either <code class="language-plaintext highlighter-rouge">encrypted</code> or <code class="language-plaintext highlighter-rouge">packed</code>.</p><p><img data-src="/assets/img/nightingale/4.png" alt="Untitled" data-proofer-ignore></p><h2 id="unpacking--decryption"><span class="mr-2">Unpacking / Decryption</span><a href="#unpacking--decryption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>IDA proficiently renamed all functions, streamlining the analysis of the <code class="language-plaintext highlighter-rouge">main</code> function. Initially, the main function duplicates <code class="language-plaintext highlighter-rouge">two data blobs</code> into <code class="language-plaintext highlighter-rouge">memory via memcpy</code>. It then utilizes the <code class="language-plaintext highlighter-rouge">first blob as data</code> and the <code class="language-plaintext highlighter-rouge">second as an XOR key</code> for decrypting the first blob. Subsequently, the decrypted data is written to a file named <code class="language-plaintext highlighter-rouge">sms2A85.tmp</code> (in this instance) located under the <code class="language-plaintext highlighter-rouge">\AppData\Local\Temp\</code> folder. Following this, the malware initiates a new process with this file.</p><p><img data-src="/assets/img/nightingale/5.png" alt="Untitled" data-proofer-ignore></p><p>Instead of dedicating time to decrypt the blob through static analysis, we’ll employ the debugger, placing a breakpoint on <code class="language-plaintext highlighter-rouge">CreateProcessA</code>. This method facilitates the retrieval of the decrypted file from the <code class="language-plaintext highlighter-rouge">\AppData\Local\Temp</code> folder, streamlining our analysis.</p><p>This approach resulted in the discovery of a new <code class="language-plaintext highlighter-rouge">.NET executable file</code> named <code class="language-plaintext highlighter-rouge">sms2A85.tmp</code>, advancing our investigation further.</p><p><strong>SHA256: <em>1fdd63b4b1db9637871a4f574c746980977accf2a0f6c3ceaef82b6641a3e9e7</em></strong></p><p><img data-src="/assets/img/nightingale/6.png" alt="Untitled" data-proofer-ignore></p><p>The file is identified as <code class="language-plaintext highlighter-rouge">Phemedrone Stealer</code> by crowdsourced Yara rules and comments in VirusTotal. Keeping this in mind, we will continue with our analysis and circle back to this classification at the end of our investigation.</p><h2 id="detailed-analysis-of-the-extracted-net-file"><span class="mr-2">Detailed Analysis of the Extracted .NET File</span><a href="#detailed-analysis-of-the-extracted-net-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Moving forward with our analysis, we’ll leverage <code class="language-plaintext highlighter-rouge">DNSpy</code> based on the identification of the second file as a <code class="language-plaintext highlighter-rouge">.NET executable</code>, as determined by <code class="language-plaintext highlighter-rouge">ExeInfo</code> .</p><p><strong>SHA256: <em>1fdd63b4b1db9637871a4f574c746980977accf2a0f6c3ceaef82b6641a3e9e7</em></strong></p><p><img data-src="/assets/img/nightingale/7.png" alt="Untitled" data-proofer-ignore></p><p>In our examination using <code class="language-plaintext highlighter-rouge">dnSpy</code>, we encountered <code class="language-plaintext highlighter-rouge">obfuscated function names</code> and observed that nearly all strings utilized within the malware are <code class="language-plaintext highlighter-rouge">encrypted</code>. To navigate these hurdles, our initial step will involve dissecting the string decryption routine. This process will enable us to decrypt and appropriately label these strings as we progress through the analysis of the functions. Furthermore, we will assign meaningful names to the functions, enhancing the clarity of our investigation.</p><p><img data-src="/assets/img/nightingale/8.png" alt="Untitled" data-proofer-ignore></p><p>Upon further scrutiny of the main function, we noticed numerous instances where encrypted strings are passed to a method named <code class="language-plaintext highlighter-rouge">Odebelivagy.Bacaruzehakik</code>. This pattern strongly suggests that we have identified the decryption function</p><p><img data-src="/assets/img/nightingale/9.png" alt="Untitled" data-proofer-ignore></p><p>The decryption routine initiates by base64 decoding the encoded data, followed by an XOR decryption process using a hardcoded key.</p><h3 id="string-decryption"><span class="mr-2">String Decryption</span><a href="#string-decryption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>In order to facilitate a quicker analysis, we intend to rewrite the string decryptor using <code class="language-plaintext highlighter-rouge">Python</code>. This adaptation will enhance our ability to navigate through the malware’s obfuscations more swiftly. Additionally, at the end of this article, <code class="language-plaintext highlighter-rouge">we will share a Python-based string extractor/decryptor</code>, designed to automate the decryption of the malware’s strings.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">base64</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">xor_key</span> <span class="o">=</span> <span class="s">"83o8vqawvcq7uy8f"</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">enc_string</span> <span class="o">=</span> <span class="s">"a1wJTAEQExIq"</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dec_string</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">enc_string</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dec_string</span><span class="p">)):</span>
<span class="p">...</span>     <span class="n">value</span> <span class="o">=</span> <span class="n">dec_string</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">xor_key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">xor_key</span><span class="p">)])</span>
<span class="p">...</span>     <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="n">Software</span>\
</pre></table></code></div></div><p>In certain instances, the output from the initial <code class="language-plaintext highlighter-rouge">base64 decoding</code> and <code class="language-plaintext highlighter-rouge">XOR decryption</code> steps contains <code class="language-plaintext highlighter-rouge">special characters</code>, rather than the expected decrypted strings. This anomaly indicates the presence of an additional layer of decryption or decoding. The process involves splitting the resultant string at spaces to isolate the special character set, which is then mapped to corresponding values using a predefined dictionary. This secondary step is crucial for fully deciphering the encrypted data.</p><p><img data-src="/assets/img/nightingale/10.png" alt="Untitled" data-proofer-ignore></p><p>Given the complexity of the additional decryption/decoding step, we can again turn to Python to reimplement this function.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">base64</span>

<span class="k">def</span> <span class="nf">decrypt_base64</span><span class="p">(</span><span class="n">encoded_str</span><span class="p">):</span>
        <span class="n">xor_key</span> <span class="o">=</span> <span class="s">"83o8vqawvcq7uy8f"</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">dec_string</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encoded_str</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dec_string</span><span class="p">)):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">dec_string</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">xor_key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">xor_key</span><span class="p">)])</span>
            <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">char_to_word_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'A'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh4="</span><span class="p">),</span>
    <span class="s">'B'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1BFg=="</span><span class="p">),</span>
    <span class="s">'C'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1CFg=="</span><span class="p">),</span>
    <span class="s">'D'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1B"</span><span class="p">),</span>
    <span class="s">'E'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fg=="</span><span class="p">),</span>
    <span class="s">'F'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1CFg=="</span><span class="p">),</span>
    <span class="s">'G'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5B"</span><span class="p">),</span>
    <span class="s">'H'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1BFg=="</span><span class="p">),</span>
    <span class="s">'I'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh0="</span><span class="p">),</span>
    <span class="s">'J'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh5CFQ=="</span><span class="p">),</span>
    <span class="s">'K'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1C"</span><span class="p">),</span>
    <span class="s">'L'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh5BFg=="</span><span class="p">),</span>
    <span class="s">'M'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR4="</span><span class="p">),</span>
    <span class="s">'N'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR0="</span><span class="p">),</span>
    <span class="s">'O'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5C"</span><span class="p">),</span>
    <span class="s">'P'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh5CFg=="</span><span class="p">),</span>
    <span class="s">'Q'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5BFQ=="</span><span class="p">),</span>
    <span class="s">'R'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh5B"</span><span class="p">),</span>
    <span class="s">'S'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1B"</span><span class="p">),</span>
    <span class="s">'T'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FQ=="</span><span class="p">),</span>
    <span class="s">'U'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1C"</span><span class="p">),</span>
    <span class="s">'V'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1BFQ=="</span><span class="p">),</span>
    <span class="s">'W'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh5C"</span><span class="p">),</span>
    <span class="s">'X'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1BFQ=="</span><span class="p">),</span>
    <span class="s">'Y'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1CFQ=="</span><span class="p">),</span>
    <span class="s">'Z'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5BFg=="</span><span class="p">),</span>
    <span class="s">'1'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh5CFVs="</span><span class="p">),</span>
    <span class="s">'2'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1CFVs="</span><span class="p">),</span>
    <span class="s">'3'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1BFVs="</span><span class="p">),</span>
    <span class="s">'4'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1BFls="</span><span class="p">),</span>
    <span class="s">'5'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Fh1BFlg="</span><span class="p">),</span>
    <span class="s">'6'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR1BFlg="</span><span class="p">),</span>
    <span class="s">'7'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5BFlg="</span><span class="p">),</span>
    <span class="s">'8'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5CFlg="</span><span class="p">),</span>
    <span class="s">'9'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5CFVg="</span><span class="p">),</span>
    <span class="s">'0'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5CFVs="</span><span class="p">),</span>
    <span class="s">'a'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Em0="</span><span class="p">),</span>
    <span class="s">'b'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhlFEg=="</span><span class="p">),</span>
    <span class="s">'c'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhkxEg=="</span><span class="p">),</span>
    <span class="s">'d'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhlF"</span><span class="p">),</span>
    <span class="s">'e'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Eg=="</span><span class="p">),</span>
    <span class="s">'f'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhkxEg=="</span><span class="p">),</span>
    <span class="s">'g'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm1F"</span><span class="p">),</span>
    <span class="s">'h'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhlFEg=="</span><span class="p">),</span>
    <span class="s">'i'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Ehk="</span><span class="p">),</span>
    <span class="s">'j'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Em0xZg=="</span><span class="p">),</span>
    <span class="s">'k'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zhkx"</span><span class="p">),</span>
    <span class="s">'l'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Em1FEg=="</span><span class="p">),</span>
    <span class="s">'m'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm0="</span><span class="p">),</span>
    <span class="s">'n'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zhk="</span><span class="p">),</span>
    <span class="s">'o'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm0x"</span><span class="p">),</span>
    <span class="s">'p'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Em0xEg=="</span><span class="p">),</span>
    <span class="s">'q'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm1FZg=="</span><span class="p">),</span>
    <span class="s">'r'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Em1F"</span><span class="p">),</span>
    <span class="s">'s'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhlF"</span><span class="p">),</span>
    <span class="s">'t'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zg=="</span><span class="p">),</span>
    <span class="s">'u'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Ehkx"</span><span class="p">),</span>
    <span class="s">'v'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhlFZg=="</span><span class="p">),</span>
    <span class="s">'w'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Em0x"</span><span class="p">),</span>
    <span class="s">'x'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhlFZg=="</span><span class="p">),</span>
    <span class="s">'y'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhkxZg=="</span><span class="p">),</span>
    <span class="s">'z'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm1FEg=="</span><span class="p">),</span>
    <span class="s">'.'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Eh5FFVxc"</span><span class="p">),</span>
    <span class="s">','</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"FR5FEltc"</span><span class="p">),</span>
    <span class="s">'?'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhlCFVxb"</span><span class="p">),</span>
    <span class="s">'_'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhlCFTYx"</span><span class="p">),</span>
    <span class="s">':'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EhkwZ1BX"</span><span class="p">),</span>
    <span class="s">';'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Rk0xZg=="</span><span class="p">),</span>
    <span class="s">'-'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"eE0wEg=="</span><span class="p">),</span>
    <span class="s">'/'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"HBkwEw=="</span><span class="p">),</span>
    <span class="s">'</span><span class="se">\\</span><span class="s">'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EmxEZihS"</span><span class="p">),</span>
    <span class="s">'&amp;'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Rk0RZg=="</span><span class="p">),</span>
    <span class="s">'='</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhVFElxb"</span><span class="p">),</span>
    <span class="s">')'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"HW1K"</span><span class="p">),</span>
    <span class="s">'('</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"ZhYx"</span><span class="p">),</span>
    <span class="s">'+'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"HRYxZg=="</span><span class="p">),</span>
    <span class="s">'$'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm1KHSgv"</span><span class="p">),</span>
    <span class="s">'@'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"Zm1KZlMvPw=="</span><span class="p">),</span>
    <span class="s">'#'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"HhlJElA="</span><span class="p">),</span>
    <span class="s">'!'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"RhUREg=="</span><span class="p">),</span>
    <span class="s">'"'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EGwwRCkuSA=="</span><span class="p">),</span>
    <span class="s">' '</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EGwwEF8uPl4="</span><span class="p">),</span>
    <span class="s">'&gt;'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EHJG"</span><span class="p">),</span>
    <span class="s">'&lt;'</span><span class="p">:</span> <span class="n">decrypt_base64</span><span class="p">(</span><span class="s">"EHFG"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">decode_text</span><span class="p">(</span><span class="n">input_text</span><span class="p">):</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">input_text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="n">decoded_chars</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">encrypted_word</span> <span class="ow">in</span> <span class="n">char_to_word_mapping</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">encrypted_word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">decoded_chars</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">decoded_chars</span><span class="p">)</span>

<span class="n">decoded_text</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enc Data: "</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">decoded_text</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>└─[$]&gt; python3 dec.py

Enc Data: -.-. *^** *^ *** *** * *** *_+^^# *_+^^# ^^ *** @~_* *** * ^ ^ ** ^* ^^* *** *_+^^# *_+^^# *** **** * *^** *^** *_+^^# *_+^^# ^^^ *^^* * ^* *_+^^# *_+^^# ^*^* ^^^ ^^ ^^ *^ ^* ^**

Classes\\ms-settings\\shell\\open\\command
</pre></table></code></div></div><p>Now that we have successfully implemented the essential string decoding and decryption mechanisms in Python, we are fully equipped to commence the detailed analysis of the malware’s functionalities.</p><h3 id="persistency"><span class="mr-2">Persistency</span><a href="#persistency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Initially, the malware conducts a preliminary check of the current user and the name of the file it is executing from. To ensure its persistence on the host system, it proceeds to create a new registry key at <code class="language-plaintext highlighter-rouge">Classes\ms-settings\shell\open\command</code> with <code class="language-plaintext highlighter-rouge">DelegateExecute</code> set to <code class="language-plaintext highlighter-rouge">0</code>. Following this setup, it executes the command <code class="language-plaintext highlighter-rouge">cmd.exe /c start computerdefaults.exe</code>, embedding itself further into the system.</p><p><img data-src="/assets/img/nightingale/11.png" alt="Untitled" data-proofer-ignore></p><p>With Nightingale Stealer’s configurable options accessible via their panel, users can select from various methods of achieving persistency. If the chosen configuration dictates this path, the malware employs an alternative approach. This begins with the creation of a new registry subkey under <code class="language-plaintext highlighter-rouge">SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code>, followed by the setup of a scheduled task using the command <code class="language-plaintext highlighter-rouge">schtasks.exe /create /tn {0} /tr "{1}" /sc MINUTE /mo {2} /ru "System" /F</code>. This adaptable strategy ensures the malware remains operational within the system.</p><p><img data-src="/assets/img/nightingale/12.png" alt="Untitled" data-proofer-ignore></p><p><img data-src="/assets/img/nightingale/13.png" alt="Untitled" data-proofer-ignore></p><h3 id="anti-cis-and-target-countries"><span class="mr-2">Anti CIS and Target Countries</span><a href="#anti-cis-and-target-countries" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Nightingale Stealer determines if there are specific target countries identified for its operation. It conducts a check to ascertain if the compromised device is located within these predefined countries. In the event the location does not match any of the target countries, the malware will cease its activity and exit.</p><p><img data-src="/assets/img/nightingale/14.png" alt="Untitled" data-proofer-ignore></p><p>The malware then conducts a check on the installed Keyboard Input Layouts to see if they match a predefined list associated with CIS countries.</p><p><img data-src="/assets/img/nightingale/15.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>ru-RU
uk-UA
kk-KZ
ro-MD
uz-UZ
be-BY
az-Latn-AZ
hy-AM
ky-KG
tg-Cyrl-Tj
</pre></table></code></div></div><h3 id="vm-detection"><span class="mr-2">VM Detection</span><a href="#vm-detection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>After confirming the current country of the device, the malware methodically checks for an internet connection, continually monitoring until the device secures a connection to the internet. Following this, it embarks on detecting virtual machines by examining information related to the graphics card, aiming to discern whether the system is a real or virtualized environment.</p><p><img data-src="/assets/img/nightingale/16.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>VirtualBox
VBox
VMWare Virtual
VMware
Hyper-V Video
SELECT * FROM Win32_VideoController
</pre></table></code></div></div><h3 id="other-checks-and-configs"><span class="mr-2">Other Checks and Configs</span><a href="#other-checks-and-configs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>To maintain stealth and efficiency, Nightingale Stealer incorporates multiple checks within its operations. It begins by examining the existence of a Mutex named <code class="language-plaintext highlighter-rouge">Usabiribejagamocazo</code> ensuring that only a single instance runs at any given time. Additionally, the malware surveys the running processes, terminating itself if it identifies <code class="language-plaintext highlighter-rouge">wireshark</code> or <code class="language-plaintext highlighter-rouge">httpdebbugerui</code> to avoid unwanted attention. Lastly, it executes two strategic commands designed to exclude itself from <code class="language-plaintext highlighter-rouge">Windows Defender's</code> scrutiny, further enhancing its covert operation.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">cmd</span><span class="w"> </span><span class="nx">/k</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">/b</span><span class="w"> </span><span class="nx">powershell</span><span class="w"> </span><span class="nt">-inputformat</span><span class="w"> </span><span class="nx">none</span><span class="w"> </span><span class="nt">-outputformat</span><span class="w"> </span><span class="nx">none</span><span class="w"> </span><span class="nt">-NonInteractive</span><span class="w"> </span><span class="nt">-Command</span><span class="w"> </span><span class="nx">Add-MpPreference</span><span class="w"> </span><span class="nt">-ExclusionPath</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nx">exit</span><span class="w">
</span><span class="n">cmd</span><span class="w"> </span><span class="nx">/k</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">/b</span><span class="w"> </span><span class="nx">powershell</span><span class="w"> </span><span class="nt">-inputformat</span><span class="w"> </span><span class="nx">none</span><span class="w"> </span><span class="nt">-outputformat</span><span class="w"> </span><span class="nx">none</span><span class="w"> </span><span class="nt">-NonInteractive</span><span class="w"> </span><span class="nt">-Command</span><span class="w"> </span><span class="nx">Add-MpPreference</span><span class="w"> </span><span class="nt">-ExclusionExtension</span><span class="w"> </span><span class="o">.</span><span class="nf">exe</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nx">exit</span><span class="w">
</span></pre></table></code></div></div><p><img data-src="/assets/img/nightingale/17.png" alt="Untitled" data-proofer-ignore></p><h3 id="data-collection-functions"><span class="mr-2">Data Collection Functions</span><a href="#data-collection-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li>File Grabber</ol><p>Our exploration of <code class="language-plaintext highlighter-rouge">Nightingale Stealer</code>’s Data Collection Functions brings us to the <code class="language-plaintext highlighter-rouge">File Grabber</code>. This particular function is responsible for harvesting files from the user’s personal and desktop directories.</p><p><img data-src="/assets/img/nightingale/18.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>*.txt
*.dat
*seed*
*.mafile
</pre></table></code></div></div><ol><li>Wallet Grabber</ol><p>Next up is the <code class="language-plaintext highlighter-rouge">Wallet Grabber</code> function in Nightingale Stealer’s Data Collection Functions. It simply looks for wallet data in the user’s <code class="language-plaintext highlighter-rouge">ApplicationData</code> and <code class="language-plaintext highlighter-rouge">LocalApplicationData</code> folders. It checks both <code class="language-plaintext highlighter-rouge">desktop</code> wallet app data and <code class="language-plaintext highlighter-rouge">browser wallet extensions</code>.</p><p><img data-src="/assets/img/nightingale/19.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>wallet.dat
Wallets/
atomic\Local Storage\leveldb
Google\Chrome\User Data\Default\Local Extension Settings\kpfopkelmapcoipemfendmdcghnegimn
.
.
.
</pre></table></code></div></div><ol><li>FTP Grabber</ol><p>The <code class="language-plaintext highlighter-rouge">FTP Grabber</code> function in Nightingale Stealer collects data from folders such as <code class="language-plaintext highlighter-rouge">FTP/</code> and <code class="language-plaintext highlighter-rouge">FileZilla/</code> located within the <code class="language-plaintext highlighter-rouge">AppData</code> directory.</p><p><img data-src="/assets/img/nightingale/20.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>\FileZilla\sitemanager.xml
\FileZilla\recentservers.xml
\FileZilla
FTP/
</pre></table></code></div></div><ol><li>Discord &amp; Steam &amp; Telegram Grabber</ol><p>There are three functions dedicated to data collection from <code class="language-plaintext highlighter-rouge">Discord</code>, <code class="language-plaintext highlighter-rouge">Steam</code>, and <code class="language-plaintext highlighter-rouge">Telegram</code>. These functions gather data from application data folders, registries, and other relevant sources.</p><p><img data-src="/assets/img/nightingale/21.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>*cord*
HKEY_CURRENT_USER\Software\Valve\Steam
SteamPath
*ssfn*
*.vdf
\config
Steam/
HKEY_CLASSES_ROOT\tg\DefaultIcon
usertag
settings
key_data
prefix
Messengers/TGgoods/
</pre></table></code></div></div><ol><li>Browser Data Grabber</ol><p><code class="language-plaintext highlighter-rouge">Nightingale Stealer</code> includes two Browser Data Grabber functions. The first one collects a wide range of browser data, including <code class="language-plaintext highlighter-rouge">extensions</code>, <code class="language-plaintext highlighter-rouge">autofills</code>, <code class="language-plaintext highlighter-rouge">cookies</code>, <code class="language-plaintext highlighter-rouge">sessions</code>, and more. The second function specializes in gathering key databases. Additionally, the malware places a specific emphasis on targeting certain extensions, particularly password managers.</p><p><img data-src="/assets/img/nightingale/22.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>User Data
Local State
Module Info Cache
Last Version
1.0.0.0
Cookies
autofill
credit_cards
Web Data
Browser Data/Cookies_
Authenticator
EOS Authenticator
.
.
.

</pre></table></code></div></div><ol><li>Device Info Grabber</ol><p><code class="language-plaintext highlighter-rouge">Nightingale Stealer</code> features two Device Info Grabber functions, responsible for collecting detailed information about the device. This data includes <code class="language-plaintext highlighter-rouge">IP addresses</code>, <code class="language-plaintext highlighter-rouge">country information</code>, <code class="language-plaintext highlighter-rouge">hardware details</code>, and more. The collected information is then prepared for transmission to the command and control (C2) server.</p><p><img data-src="/assets/img/nightingale/23.png" alt="Untitled" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre><td class="rouge-code"><pre>IP:
query
Country:
country
countryCode
City:
city
Postal:
zip
MAC:
Username:
Windows name:
x64
Hardware ID:
GPU:

{0,-25}
CPU:
RAM:
Passwords:
Cookies:
Credit Cards:
AutoFills:
Extensions
Wallets:
Files:

Passwrods Tags:
,
Cookies Tags:
,
Antivirus products:
,
File Location:
unknown
Information.txt
query
country
countryCode
*Nightingale Stealer Report* \| by Nightingale

``` - IP: {0} \({1}\)
 - Tag: {2} {3}
 - Passwords: {4}
 - Cookies: {5}
 - Wallets: {6}```

Unknown
Unknown
(
query
country
countryCode
Unknown
Unknown
Unknown
,
,
query
countryCode
(
Unknown
)
-
Unknown
-Nightingale-Report.zip
http://ip-api.com/json/?fields=11827
Unknown
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion
Unknown
root\SecurityCenter2
displayName
X2
:
Unknown
Memory
SELECT * FROM Win32_VideoController
Name
Unknown
Unknown
SELECT * FROM Win32_Processor
Name
Unknown
Unknown
SELECT * FROM Win32_ComputerSystem
TotalPhysicalMemory
0
Win32_Processor
ProcessorId
Win32_DiskDrive
SerialNumber
SELECT * FROM
X2
Unknown
</pre></table></code></div></div><ol><li>Screenshot</ol><p>Finally, Nightingale Stealer includes the capability to capture a screenshot of the current view on the device.</p><p><img data-src="/assets/img/nightingale/24.png" alt="Untitled" data-proofer-ignore></p><h3 id="data-exfiltration"><span class="mr-2">Data Exfiltration</span><a href="#data-exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Nightingale Stealer offers three distinct data exfiltration methods: Telegram, Panel, and Server (Gate). In the current instance, stolen data is sent to the threat actor via the Panel method, with the data being exfiltrated to <code class="language-plaintext highlighter-rouge">kinggru.duckdns.org</code> through port <code class="language-plaintext highlighter-rouge">3999</code>.</p><p><img data-src="/assets/img/nightingale/25.png" alt="Untitled" data-proofer-ignore></p><h1 id="part-3---string-extractor--decryptor">Part 3 - String Extractor / Decryptor</h1><p>As previously mentioned, Nightingale Stealer employs two distinct encoding and encryption routines to conceal strings. To gain a comprehensive view of all the concealed strings within the malware, we will develop a Python-based string extractor/decryptor.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">encoded_string</span><span class="p">):</span>
    <span class="n">decryption_key</span> <span class="o">=</span> <span class="s">"83o8vqawvcq7uy8f"</span>
    <span class="n">decoded_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encoded_string</span><span class="p">)</span>
    <span class="n">decrypted_chars</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">chr</span><span class="p">(</span><span class="n">byte</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">decryption_key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">decryption_key</span><span class="p">)]))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">decoded_bytes</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">decrypted_chars</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">extract_and_decrypt_strings</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">check_output</span><span class="p">([</span><span class="s">'strings'</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="s">'l'</span><span class="p">,</span> <span class="n">file_name</span><span class="p">])</span>
    <span class="n">strings</span> <span class="o">=</span> <span class="n">output</span><span class="p">.</span><span class="n">decode</span><span class="p">().</span><span class="n">splitlines</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">decrypted_string</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">decrypted_string</span><span class="p">.</span><span class="n">isascii</span><span class="p">():</span>
                <span class="n">clear_str</span> <span class="o">=</span> <span class="n">decode_text</span><span class="p">(</span><span class="n">decrypted_string</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">clear_str</span> <span class="o">==</span> <span class="s">""</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">decrypted_string</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">clear_str</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">continue</span>

<span class="n">char_to_word_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'A'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh4="</span><span class="p">),</span>
    <span class="s">'B'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1BFg=="</span><span class="p">),</span>
    <span class="s">'C'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1CFg=="</span><span class="p">),</span>
    <span class="s">'D'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1B"</span><span class="p">),</span>
    <span class="s">'E'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fg=="</span><span class="p">),</span>
    <span class="s">'F'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1CFg=="</span><span class="p">),</span>
    <span class="s">'G'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5B"</span><span class="p">),</span>
    <span class="s">'H'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1BFg=="</span><span class="p">),</span>
    <span class="s">'I'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh0="</span><span class="p">),</span>
    <span class="s">'J'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh5CFQ=="</span><span class="p">),</span>
    <span class="s">'K'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1C"</span><span class="p">),</span>
    <span class="s">'L'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh5BFg=="</span><span class="p">),</span>
    <span class="s">'M'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR4="</span><span class="p">),</span>
    <span class="s">'N'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR0="</span><span class="p">),</span>
    <span class="s">'O'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5C"</span><span class="p">),</span>
    <span class="s">'P'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh5CFg=="</span><span class="p">),</span>
    <span class="s">'Q'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5BFQ=="</span><span class="p">),</span>
    <span class="s">'R'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh5B"</span><span class="p">),</span>
    <span class="s">'S'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1B"</span><span class="p">),</span>
    <span class="s">'T'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FQ=="</span><span class="p">),</span>
    <span class="s">'U'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1C"</span><span class="p">),</span>
    <span class="s">'V'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1BFQ=="</span><span class="p">),</span>
    <span class="s">'W'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh5C"</span><span class="p">),</span>
    <span class="s">'X'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1BFQ=="</span><span class="p">),</span>
    <span class="s">'Y'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1CFQ=="</span><span class="p">),</span>
    <span class="s">'Z'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5BFg=="</span><span class="p">),</span>
    <span class="s">'1'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh5CFVs="</span><span class="p">),</span>
    <span class="s">'2'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1CFVs="</span><span class="p">),</span>
    <span class="s">'3'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1BFVs="</span><span class="p">),</span>
    <span class="s">'4'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1BFls="</span><span class="p">),</span>
    <span class="s">'5'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Fh1BFlg="</span><span class="p">),</span>
    <span class="s">'6'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR1BFlg="</span><span class="p">),</span>
    <span class="s">'7'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5BFlg="</span><span class="p">),</span>
    <span class="s">'8'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5CFlg="</span><span class="p">),</span>
    <span class="s">'9'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5CFVg="</span><span class="p">),</span>
    <span class="s">'0'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5CFVs="</span><span class="p">),</span>
    <span class="s">'a'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Em0="</span><span class="p">),</span>
    <span class="s">'b'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhlFEg=="</span><span class="p">),</span>
    <span class="s">'c'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhkxEg=="</span><span class="p">),</span>
    <span class="s">'d'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhlF"</span><span class="p">),</span>
    <span class="s">'e'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Eg=="</span><span class="p">),</span>
    <span class="s">'f'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhkxEg=="</span><span class="p">),</span>
    <span class="s">'g'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm1F"</span><span class="p">),</span>
    <span class="s">'h'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhlFEg=="</span><span class="p">),</span>
    <span class="s">'i'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Ehk="</span><span class="p">),</span>
    <span class="s">'j'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Em0xZg=="</span><span class="p">),</span>
    <span class="s">'k'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zhkx"</span><span class="p">),</span>
    <span class="s">'l'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Em1FEg=="</span><span class="p">),</span>
    <span class="s">'m'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm0="</span><span class="p">),</span>
    <span class="s">'n'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zhk="</span><span class="p">),</span>
    <span class="s">'o'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm0x"</span><span class="p">),</span>
    <span class="s">'p'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Em0xEg=="</span><span class="p">),</span>
    <span class="s">'q'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm1FZg=="</span><span class="p">),</span>
    <span class="s">'r'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Em1F"</span><span class="p">),</span>
    <span class="s">'s'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhlF"</span><span class="p">),</span>
    <span class="s">'t'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zg=="</span><span class="p">),</span>
    <span class="s">'u'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Ehkx"</span><span class="p">),</span>
    <span class="s">'v'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhlFZg=="</span><span class="p">),</span>
    <span class="s">'w'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Em0x"</span><span class="p">),</span>
    <span class="s">'x'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhlFZg=="</span><span class="p">),</span>
    <span class="s">'y'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhkxZg=="</span><span class="p">),</span>
    <span class="s">'z'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm1FEg=="</span><span class="p">),</span>
    <span class="s">'.'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Eh5FFVxc"</span><span class="p">),</span>
    <span class="s">','</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"FR5FEltc"</span><span class="p">),</span>
    <span class="s">'?'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhlCFVxb"</span><span class="p">),</span>
    <span class="s">'_'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhlCFTYx"</span><span class="p">),</span>
    <span class="s">':'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EhkwZ1BX"</span><span class="p">),</span>
    <span class="s">';'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Rk0xZg=="</span><span class="p">),</span>
    <span class="s">'-'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"eE0wEg=="</span><span class="p">),</span>
    <span class="s">'/'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"HBkwEw=="</span><span class="p">),</span>
    <span class="s">'</span><span class="se">\\</span><span class="s">'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EmxEZihS"</span><span class="p">),</span>
    <span class="s">'&amp;'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Rk0RZg=="</span><span class="p">),</span>
    <span class="s">'='</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhVFElxb"</span><span class="p">),</span>
    <span class="s">')'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"HW1K"</span><span class="p">),</span>
    <span class="s">'('</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"ZhYx"</span><span class="p">),</span>
    <span class="s">'+'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"HRYxZg=="</span><span class="p">),</span>
    <span class="s">'$'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm1KHSgv"</span><span class="p">),</span>
    <span class="s">'@'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"Zm1KZlMvPw=="</span><span class="p">),</span>
    <span class="s">'#'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"HhlJElA="</span><span class="p">),</span>
    <span class="s">'!'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"RhUREg=="</span><span class="p">),</span>
    <span class="s">'"'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EGwwRCkuSA=="</span><span class="p">),</span>
    <span class="s">' '</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EGwwEF8uPl4="</span><span class="p">),</span>
    <span class="s">'&gt;'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EHJG"</span><span class="p">),</span>
    <span class="s">'&lt;'</span><span class="p">:</span> <span class="n">decrypt</span><span class="p">(</span><span class="s">"EHFG"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">decode_text</span><span class="p">(</span><span class="n">input_text</span><span class="p">):</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">input_text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="n">decoded_chars</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">encrypted_word</span> <span class="ow">in</span> <span class="n">char_to_word_mapping</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">encrypted_word</span> <span class="o">==</span> <span class="n">word</span><span class="p">:</span>
                <span class="n">decoded_chars</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">decoded_chars</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s">"dropped_file.exe"</span>
<span class="n">extract_and_decrypt_strings</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</pre></table></code></div></div><p>For the sake of simplicity and code brevity, we utilized the <code class="language-plaintext highlighter-rouge">strings -e l</code> command to extract encrypted strings from the malware. However, it’s worth noting that this extraction process can also be implemented in Python.</p><p>Decrypted Strings:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
</pre><td class="rouge-code"><pre>Panel
NightingalePanel
Gate
Telegram
kinggru.duckdns.org
3999
%GATE%
Token
Chat ID
Invalid input
%TARGET%
@anontsugumi
Asimuxu
50
*.txt
*seed*
*.dat
*.mafile
false
true
Usabiribejagamocazo
A
B
C
D
E
F
G
H
I
J
K
L
M
N
O
P
Q
R
S
T
U
V
W
X
Y
Z
1
2
3
4
5
6
7
8
9
0
a
b
c
d
e
f
g
h
i
j
k
l
m
n
o
p
q
r
s
t
u
v
w
x
y
z
.
,
?
_
:
;
-
/
\
&amp;
=
)
(
+
$
@
#
!
"
 
&gt;
&lt;
Classes\\ms-settings\\shell\\open\\command
DelegateExecute
Software\
Waiting for network connection...
Network connection established.
8.8.8.8
Canada
France
USA
England
Germany
Not connected to network. Waiting for network connection...
Password.txt
Messengers/Discord Tokens.txt
cmd.exe
/c start computerdefaults.exe
wallet.dat
Wallets/
\
Armory
Atomic
atomic\Local Storage\leveldb
Bytecoin
bytecoin
Coninomi
Coinomi\Coinomi\wallets
Jaxx
com.liberty.jaxx\IndexedDB\file_0.indexeddb.leveldb
Electrum
Electrum\wallets
Exodus
Exodus\exodus.wallet
Guarda
Guarda\Local Storage\leveldb
Zcash
Ethereum
Ethereum\keystore
Liquality
Google\Chrome\User Data\Default\Local Extension Settings\kpfopkelmapcoipemfendmdcghnegimn
Nifty
Google\Chrome\User Data\Default\Local Extension Settings\jbdaocneiiinmjbjlgalhcelgbejmnid
Oxygen
Google\Chrome\User Data\Default\Local Extension Settings\fhilaheimglignddkjgofkcbgekhenbh
Crocobit
Google\Chrome\User Data\Default\Local Extension Settings\pnlfjmlcjdjgkddecgincndfgegkecke
Keplr
Google\Chrome\User Data\Default\Local Extension Settings\dmkamcknogkgcdfhhbddcghachkejeap
Finnie
Google\Chrome\User Data\Default\Local Extension Settings\cjmkndjhnagcfbpiemnkdpomccnjblmj
Swash
Google\Chrome\User Data\Default\Local Extension Settings\cmndjbecilbocjfkibfbifhngkdmjgog
Starcoin
Google\Chrome\User Data\Default\Local Extension Settings\mfhbebgoclkghebffdldpobeajmbecfk
Slope
Google\Chrome\User Data\Default\Local Extension Settings\pocmplpaccanhmnllbbkpgfliimjljgo
Phantom
Google\Chrome\User Data\Default\Local Extension Settings\bfnaelmomeimhlpmgjnjophhpkkoljpa
Carat
Google\Chrome\User Data\Default\Local Extension Settings\gjdpfnfmelhakanjicgoeepdoninjjod
Bitfi
Google\Chrome\User Data\Default\Local Extension Settings\kffganmbldfgkgineogpgclfkkngcool
Gemini
Google\Chrome\User Data\Default\Local Extension Settings\llmlhlddaeediifoladephjpgejknmal
Rainbow
Google\Chrome\User Data\Default\Local Extension Settings\fgmanlmbjbclcnkficdodlognkeheejb
Raven
Google\Chrome\User Data\Default\Local Extension Settings\gchanpaeodapopimpablnkmenhkndddi
Tomo
Google\Chrome\User Data\Default\Local Extension Settings\kcbnmnnkigeelbhlfllahgejbhdnlhan
Monarch
Google\Chrome\User Data\Default\Local Extension Settingspgnemdcbsnenjgpajdflhjnelnhkdcb
Catalyst
Google\Chrome\User Data\Default\Local Extension Settings
ojhmikaojhghfplekghaghaeogmdhnl
Ruby
Google\Chrome\User Data\Default\Local Extension Settings\gbanjdaphdabiocllfbjolmdjckocjnj
Crypton
Google\Chrome\User Data\Default\Local Extension Settings\edffijlgmobnajlneenopceappncihfj
Rumble
Google\Chrome\User Data\Default\Local Extension Settings\mlnmjikdhcblohfpfdfmegjkjlnbbkna
Lido
Google\Chrome\User Data\Default\Local Extension Settings\fnlgpnbkflbpcpkkohbiojomgeokejjn
Jelly
Google\Chrome\User Data\Default\Local Extension Settings\okompkjedlhgdlkhbanmiboeploplgpc
OpenSea
Google\Chrome\User Data\Default\Local Extension Settings\aabeakehlapikpddikddcikneklnfbfl
SimpleSwap
Google\Chrome\User Data\Default\Local Extension Settings\lfmgcmgkbkphaaggnofnhoonmjfmjhah
TronLink
Google\Chrome\User Data\Default\Local Extension Settings\ibnejdfjmmkpcnlpebklmnkoeoihofec
UniSwap
Google\Chrome\User Data\Default\Local Extension Settings\ncljmiffkofogcgiepiflbfhjelkklkb
MetaVault
Google\Chrome\User Data\Default\Local Extension Settings\apakagogmckphjnojeblmiaahdnogkni
SafePal
Google\Chrome\User Data\Default\Local Extension Settings\jcjejccajkejpnadafclaophjfpjebhm
Chrome_Sollet
Google\Chrome\User Data\Default\Local Extension Settings\fhmfendgdocmcbmfikdcogofphimnkno
Chrome_Metamask
Google\Chrome\User Data\Default\Local Extension Settings\nkbihfbeogaeaoehlefnkodbefgpgknn
Chrome_Ton
Google\Chrome\User Data\Default\Local Extension Settings\nphplpgoakhhjchkkhmiggakijnkhfnd
Chrome_XinPay
Google\Chrome\User Data\Default\Local Extension Settings\bocpokimicclpaiekenaeelehdjllofo
Chrome_Mobox
Google\Chrome\User Data\Default\Local Extension Settings\fcckkdbjnoikooededlapcalpionmalo
Chrome_Iconex
Google\Chrome\User Data\Default\Local Extension Settings\flpiciilemghbmfalicajoolhkkenfel
Chrome_Guild
Google\Chrome\User Data\Default\Local Extension Settings\nanjmdknhkinifnkgdcggcfnhdaammmj
Chrome_Equal
Google\Chrome\User Data\Default\Local Extension Settings\blnieiiffboillknjnepogjhkgnoapac
Chrome_Coin98
Google\Chrome\User Data\Default\Local Extension Settings\aeachknmefphepccionboohckonoeemg
Chrome_Bitapp
Google\Chrome\User Data\Default\Local Extension Settings\fihkakfobkmkjojpchpfgcmhfjnmnfpi
Chrome_Binance
Google\Chrome\User Data\Default\Local Extension Settings\fhbohimaelbohpjbbldcngcnapndodjp
Chrome_Google_Authicator
Google\Chrome\User Data\Default\Local Extension Settings\bhghoamapcdpbohphigoooaddinpkbai
Chrome_YOROI_WALLET
Google\Chrome\User Data\Default\Local Extension Settings\ffnbelfdoeiohenkjibnmadjiehjhajb
Chrome_NIFTY
Chrome_MATH
Google\Chrome\User Data\Default\Local Extension Settings\afbcbjpbpfadlkmhmclhkeeodmamcflc
Chrome_COINBASE
Google\Chrome\User Data\Default\Local Extension Settings\hnfanknocfeofbddgcijnmhnfnkdnaad
Chrome_EQUAL
Google\Chrome\User Data\Default\IndexedDB\chrome-extension_blnieiiffboillknjnepogjhkgnoapac_0.indexeddb.leveldb
Chrome_WOMBAT
Google\Chrome\User Data\Default\Local Extension Settings\amkmjjmmflddogmhpjloimipbofnfjih
Chrome_IWALLET
Google\Chrome\User Data\Default\Sync Extension Settings\nlbmnnijcnlegkjjpcfjclmcfggfefdm
Chrome_GUILD1
Google\Chrome\User Data\Default\Sync Extension Settings\nanjmdknhkinifnkgdcggcfnhdaammmj
Chrome_SATURN
Google\Chrome\User Data\Default\Local Extension Settings\nkddgncdjgjfcddamfgcmfnlhccnimig
Chrome_RONIN
Google\Chrome\User Data\Default\Local Extension Settings\fnjhmkhhmkbjkkabndcnnogagogbneec
Chrome_NEOLINE
Google\Chrome\User Data\Default\Local Extension Settings\cphhlgmgameodnhkjdmkpanlelnlohao
Chrome_CLOVER
Google\Chrome\User Data\Default\Local Extension Settings\nhnkbkgjikgcigadomkphalanndcapjk
Chrome_LIQUALITY
Edge_Auvitas
Microsoft\Edge\User Data\Default\Local Extension Settings\klfhbdnlcfcaccoakhceodhldjojboga
Edge_Math
Microsoft\Edge\User Data\Default\Local Extension Settings\dfeccadlilpndjjohbjdblepmjeahlmm
Edge_Metamask
Microsoft\Edge\User Data\Default\Local Extension Settings\ejbalbakoplchlghecdalmeeeajnimhm
Edge_MTV
Microsoft\Edge\User Data\Default\Local Extension Settings\oooiblbdpdlecigodndinbpfopomaegl
Edge_Rabet
Microsoft\Edge\User Data\Default\Local Extension Settings\aanjhgiamnacdfnlfnmgehjikagdbafd
Edge_Ronin
Microsoft\Edge\User Data\Default\Local Extension Settings\bblmcdckkhkhfhhpfcchlpalebmonecp
Edge_Yoroi
Microsoft\Edge\User Data\Default\Local Extension Settings\akoiaibnepcedcplijmiamnaigbepmcb
Edge_Zilpay
Microsoft\Edge\User Data\Default\Local Extension Settings\fbekallmnjoeggkefjkbebpineneilec
Edge_Exodus
Microsoft\Edge\User Data\Default\Local Extension Settings\jdiccldimpdaibmpdkjnbmckianbfold
/
\FileZilla\recentservers.xml
\FileZilla\sitemanager.xml
\FileZilla
FTP/
Profiles
key3.db
key4.db
cookies.sqlite
moz_cookies
formhistory.sqlite
moz_formhistory
Browser Data/Cookies_
[
].txt

Browser Data/AutoFills_

logins.json
encryptedUsername
encryptedPassword
hostname
[^ -]
1
metaData
password
2A864886F70D010C050103
ISO-8859-1
password-check
2A864886F70D01050D
nssPrivate
*.ini
global-salt
Version
User Data
1.0.0.0
Local State
Network
Cookies
cookies
Web Data
autofill
Login Data
logins
credit_cards
Local Storage
leveldb
CreditCards.txt
Profile*
Default
Authenticator
bhghoamapcdpbohphigoooaddinpkbai
EOS Authenticator
oeljdldpnmdbchonielidgobddffflal
BrowserPass
naepdomgkenhinolocfifgehidddafch
MYKI
bmikpgodpkclnkgmnpphehdgcimmided
Splikity
jhfjfclepacoldmjmkmdlmganfaalklb
CommonKey
chgfefjpcobfbnpmiokfjjaglahmnded
Zoho Vault
igkpcodhieompeloncfnbekccinhapdb
Norton Password Manager
admmjipmmciaobhojoghlmleefbicajg
Avira Password Manager
caljgklbbfbcjjanaijlacgncafpegll
Trezor Password Manager
imloifkgjagghnncjkhggdhalmcnfklk
MetaMask
nkbihfbeogaeaoehlefnkodbefgpgknn
ibnejdfjmmkpcnlpebklmnkoeoihofec
BinanceChain
fhbohimaelbohpjbbldcngcnapndodjp
Coin98
aeachknmefphepccionboohckonoeemg
iWallet
kncchdigobghenbbaddojjnnaogfppfj
Wombat
amkmjjmmflddogmhpjloimipbofnfjih
MEW CX
nlbmnnijcnlegkjjpcfjclmcfggfefdm
NeoLine
cphhlgmgameodnhkjdmkpanlelnlohao
Terra Station
aiifbnbfobpmeekipheeijimdpnlpgpp
dmkamcknogkgcdfhhbddcghachkejeap
Sollet
fhmfendgdocmcbmfikdcogofphimnkno
ICONex
flpiciilemghbmfalicajoolhkkenfel
KHC
hcflpincpppdclinealmandijcmnkbgn
TezBox
mnfifefkajgofkcjkemidiaecocnkjeh
Byone
nlgbhdfgdhgbiamfdfmbikcdghidoadd
OneKey
ilbbpajmiplgpehdikmejfemfklpkmke
Trust Wallet
pknlccmneadmjbkollckpblgaaabameg
MetaWallet
pfknkoocfefiocadajpngdknmkjgakdg
Guarda Wallet
fcglfhcjfpkgdppjbglknafgfffkelnm
idkppnahnmmggbmfkjhiakkbkdpnmnon
Jaxx Liberty
mhonjhhcgphdphdjcdoeodfdliikapmj
Atomic Wallet
bhmlbgebokamljgnceonbncdofmmkedg
hieplnfojfccegoloniefimmbfjdgcgp
Mycelium
pidhddgciaponoajdngciiemcflpnnbg
Coinomi
blbpgcogcoohhngdjafgpoagcilicpjh
GreenAddress
gflpckpfdgcagnbdfafmibcmkadnlhpj
Edge
doljkehcfhidippihgakcihcmnknlphh
BRD
nbokbjkelpmlgflobbohapifnnenbjlh
Samourai Wallet
apjdnokplgcjkejimjdfjnhmjlbpgkdi
Copay
ieedgmmkpkbiblijbbldefkomatsuahh
Bread
jifanbgejlbcmhbbdbnfbfnlmbomjedj
Airbitz
KeepKey
dojmlmceifkfgkgeejemfciibjehhdcl
Trezor
jpxupxjxheguvfyhfhahqvxvyqthiryh
Ledger Live
pfkcfdjnlfjcmkjnhcbfhfkkoflnhjln
Ledger Wallet
hbpfjlflhnmkddbjdchbbifhllgmmhnm
Bitbox
ocmfilhakdbncmojmlbagpkjfbmeinbd
Digital Bitbox
dbhklojmlkgmpihhdooibnmidfpeaing
YubiKey
mammpjaaoinfelloncbbpomjcihbkmmc
Google Authenticator
khcodhlfkpmhibicdjjblnkgimdepgnd
Microsoft Authenticator
bfbdnbpibgndpjfhonkflpkijfapmomn
Authy
gjffdbjndmcafeoehgdldobgjmlepcal
Duo Mobile
eidlicjlkaiefdbgmdepmmicpbggmhoj
OTP Auth
bobfejfdlhnabgglompioclndjejolch
FreeOTP
elokfmmmjbadpgdjmgglocapdckdcpkn
Aegis Authenticator
ppdjlkfkedmidmclhakfncpfdmdgmjpm
LastPass Authenticator
cfoajccjibkjhbdjnpkbananbejpkkjb
Dashlane
flikjlpgnpcjdienoojmgliechmmheek
Keeper
gofhklgdnbnpcdigdgkgfobhhghjmmkj
RoboForm
hppmchachflomkejbhofobganapojjol
KeePass
lbfeahdfdkibininjgejjgpdafeopflb
KeePassXC
kgeohlebpjgcfiidfhhdlnnkhefajmca
Bitwarden
inljaljiffkdgmlndjkdiepghpolcpki
NordPass
njgnlkhcjgmjfnfahdmfkalpjcneebpl
LastPass
gabedfkgnbglfbnplfpjddgfnbibkmbb
Local Extension Settings
Browser Data/Extensions/
_
Module Info Cache
Last Version
*cord*
FileGrabber
IP:
query
Country:
country
countryCode
City:
city
Postal:
zip
MAC:
Username:
Windows name:
x32
x64
Hardware ID:
GPU:

{0,-25}
CPU:
RAM:
Passwords:
Cookies:
Credit Cards:
AutoFills:
Extensions
Wallets:
Files:

Passwrods Tags:
, 
Cookies Tags:
Antivirus products:
File Location:
unknown
Information.txt
TTTTT
\.
Unknown
(
)
-Nightingale-Report.zip
http://ip-api.com/json/?fields=11827
root\SecurityCenter2
e
displayName
X2
:
Memory
Available Bytes
e
Name
e
e
TotalPhysicalMemory
0
Win32_Processor
ProcessorId
Win32_DiskDrive
SerialNumber
e
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion
ProductName
user32.dll
GetDC
gdi32.dll
GetDeviceCaps
Screenshot.png
*ssfn*
\config
*.vdf
Steam/
HKEY_CURRENT_USER\Software\Valve\Steam
SteamPath
root\CIMV2
yyyy-MM-dd h:mm:ss tt
HKEY_CLASSES_ROOT\tg\DefaultIcon
tdata
s
usertag
settings
key_data
prefix
Messengers/TGgoods/
file
filename
filedescription
POST
----------------------------
x
multipart/form-data; boundary=
Content-Disposition: form-data; name="
"; filename="
"
Content-Type: application/octet-stream
Invalid IP address or port number. Unable to send the data.
Invalid argument format. Unable to send the data.
.zip
https://api.telegram.org/bot{0}/sendDocument
document
chat_id
parse_mode
MarkdownV2
caption
wireshark
httpdebbugerui
VirtualBox
VBox
VMware Virtual
VMware
Hyper-V Video
ru-RU
uk-UA
kk-KZ
ro-MD
uz-UZ
be-BY
az-Latn-AZ
hy-AM
ky-KG
tg-Cyrl-TJ
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
System
cmd
/k start /b powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath 
 &amp; exit
/k start /b powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionExtension .exe &amp; exit
schtasks.exe
/create /tn {0} /tr "{1}" /sc MINUTE /mo {2} /ru "System" /F
/create /tn 
 /tr "
" /sc ONLOGON /ru "System" /F
TGgoods
{0}	{1}	{2}	{3}	{4}	{5}	{6}
Name: 

Value: 
Hostname: 

Username: 

Password: 

Browser: 
 v
 (
Number: {0}
Placeholder: {1}
Expiration: {2}/{3}
Browser: {4} v{5} ({6})
*.ldb
encrypted_key
DPAPI
roblox.com
steampowered.com
genshin
epicgames.com
fortnite.com
GAMES
qiwi
tinkoff
yoomoney
sberbank
BANK
facebook
FACEBOOK
funpay
paypal
americanexpress
amazon
MONEY
spotify
music.apple
MUSIC
deadcode
celka
nursultan
akrien
expenisve
wexside
x.synapse
synapse
neverlose
gamesense
nixware
primordial
interium
xone
CHEATS
dQw4w9WgXcQ:[^"]*
dQw4w9WgXcQ:
e
ParentProcessId
UNIQUE
Writing is not allowed
v1
bcrypt.dll
BCryptDecrypt
BCryptDestroyKey
BCryptCloseAlgorithmProvider
AES
Microsoft Primitive Provider
ChainingModeGCM
BCryptOpenAlgorithmProvider
BCryptSetProperty
ChainingMode
AuthTagLength
BCryptImportKey
ObjectLength
KeyDataBlob
BCryptGetProperty
crypt32.dll
CryptUnprotectData
algorithm
Algorithm cannot be null.
Password cannot be null.
salt
Salt cannot be null.
Derived key too long.
SEQUENCE {
{0:X2}
	INTEGER 
	OCTETSTRING 
	OBJECTIDENTIFIER 
}
00061561
</pre></table></code></div></div><h1 id="part-4---nightingale-stealer-vs-phemedrone-stealer">Part 4 - Nightingale Stealer vs Phemedrone Stealer</h1><p>At the beginning of this article, we noticed that the <code class="language-plaintext highlighter-rouge">Nightingale Stealer</code> sample was labeled as <code class="language-plaintext highlighter-rouge">Phemedrone Stealer</code> by crowdsourced YARA rules. In this section, we’ll explore why this identification occurred.</p><p>To achieve this, we will obtain the source code of Phemedrone Stealer. Subsequently, we will systematically <code class="language-plaintext highlighter-rouge">compare each extracted string from Nightingale Stealer with the source code of Phemedrone Stealer</code>. This comparative analysis will provide insights into the extent of similarity between the two.</p><p>To minimize the chances of false positive matches, we initiated the process by compiling a list of strings with <code class="language-plaintext highlighter-rouge">three or more characters</code>. Following this, we implemented a Bash script designed for the comparative analysis.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="nb">declare</span> <span class="nt">-A</span> matchedStrings

<span class="k">while </span><span class="nv">IFS</span><span class="o">=</span> <span class="nb">read</span> <span class="nt">-r</span> line<span class="p">;</span> <span class="k">do
    if </span><span class="nb">grep</span> <span class="nt">-qr</span> <span class="nt">--include</span><span class="o">=</span><span class="s2">"*"</span> <span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span> Phemedrone-Stealer-master/<span class="p">;</span> <span class="k">then
        if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="k">${</span><span class="nv">matchedStrings</span><span class="p">[</span><span class="nv">$line</span><span class="p">]</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">echo</span> <span class="s2">"Matched: '</span><span class="k">${</span><span class="nv">line</span><span class="k">}</span><span class="s2">'"</span>
            matchedStrings[<span class="nv">$line</span><span class="o">]=</span>1
        <span class="k">fi
    fi
done</span> &lt; strings.txt
</pre></table></code></div></div><p>Upon executing the script, we identified a total of <code class="language-plaintext highlighter-rouge">328</code> matching strings present in both Nightingale Stealer and Phemedrone Stealer.</p><p>Matched strings;</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
</pre><td class="rouge-code"><pre>Matched: <span class="s1">'*.dat'</span>
Matched: <span class="s1">'*.ini'</span>
Matched: <span class="s1">'*.ldb'</span>
Matched: <span class="s1">'*.mafile'</span>
Matched: <span class="s1">'*.txt'</span>
Matched: <span class="s1">'*.vdf'</span>
Matched: <span class="s1">'*cord*'</span>
Matched: <span class="s1">'*seed*'</span>
Matched: <span class="s1">'*ssfn*'</span>
Matched: <span class="s1">'00061561'</span>
Matched: <span class="s1">'1.0.0.0'</span>
Matched: <span class="s1">'2A864886F70D01050D'</span>
Matched: <span class="s1">'2A864886F70D010C050103'</span>
Matched: <span class="s1">'8.8.8.8'</span>
Matched: <span class="s1">'Aegis Authenticator'</span>
Matched: <span class="s1">'Airbitz'</span>
Matched: <span class="s1">'Algorithm cannot be null.'</span>
Matched: <span class="s1">'Antivirus products:'</span>
Matched: <span class="s1">'Armory'</span>
Matched: <span class="s1">'Atomic'</span>
Matched: <span class="s1">'Atomic Wallet'</span>
Matched: <span class="s1">'AuthTagLength'</span>
Matched: <span class="s1">'Authenticator'</span>
Matched: <span class="s1">'Authy'</span>
Matched: <span class="s1">'AutoFills:'</span>
Matched: <span class="s1">'Available Bytes'</span>
Matched: <span class="s1">'Avira Password Manager'</span>
Matched: <span class="s1">'BCryptCloseAlgorithmProvider'</span>
Matched: <span class="s1">'BCryptDecrypt'</span>
Matched: <span class="s1">'BCryptDestroyKey'</span>
Matched: <span class="s1">'BCryptGetProperty'</span>
Matched: <span class="s1">'BCryptImportKey'</span>
Matched: <span class="s1">'BCryptOpenAlgorithmProvider'</span>
Matched: <span class="s1">'BCryptSetProperty'</span>
Matched: <span class="s1">'BinanceChain'</span>
Matched: <span class="s1">'Bitbox'</span>
Matched: <span class="s1">'Bitwarden'</span>
Matched: <span class="s1">'Bread'</span>
Matched: <span class="s1">'Browser Data/AutoFills_'</span>
Matched: <span class="s1">'Browser Data/Cookies_'</span>
Matched: <span class="s1">'Browser Data/Extensions/'</span>
Matched: <span class="s1">'Browser: '</span>
Matched: <span class="s1">'BrowserPass'</span>
Matched: <span class="s1">'Byone'</span>
Matched: <span class="s1">'Bytecoin'</span>
Matched: <span class="s1">'CHEATS'</span>
Matched: <span class="s1">'Catalyst'</span>
Matched: <span class="s1">'ChainingMode'</span>
Matched: <span class="s1">'ChainingModeGCM'</span>
Matched: <span class="s1">'Chat ID'</span>
Matched: <span class="s1">'City:'</span>
Matched: <span class="s1">'Coin98'</span>
Matched: <span class="s1">'Coinomi'</span>
Matched: <span class="s1">'CommonKey'</span>
Matched: <span class="s1">'Coninomi'</span>
Matched: <span class="s1">'Content-Type: application/octet-stream'</span>
Matched: <span class="s1">'Cookies'</span>
Matched: <span class="s1">'Cookies Tags:'</span>
Matched: <span class="s1">'Cookies:'</span>
Matched: <span class="s1">'Copay'</span>
Matched: <span class="s1">'Country:'</span>
Matched: <span class="s1">'Credit Cards:'</span>
Matched: <span class="s1">'CreditCards.txt'</span>
Matched: <span class="s1">'CryptUnprotectData'</span>
Matched: <span class="s1">'DPAPI'</span>
Matched: <span class="s1">'Dashlane'</span>
Matched: <span class="s1">'Default'</span>
Matched: <span class="s1">'Derived key too long.'</span>
Matched: <span class="s1">'Digital Bitbox'</span>
Matched: <span class="s1">'Duo Mobile'</span>
Matched: <span class="s1">'EOS Authenticator'</span>
Matched: <span class="s1">'Electrum'</span>
Matched: <span class="s1">'Exodus'</span>
Matched: <span class="s1">'Extensions'</span>
Matched: <span class="s1">'File Location:'</span>
Matched: <span class="s1">'FileGrabber'</span>
Matched: <span class="s1">'Files:'</span>
Matched: <span class="s1">'FreeOTP'</span>
Matched: <span class="s1">'GAMES'</span>
Matched: <span class="s1">'GetDC'</span>
Matched: <span class="s1">'GetDeviceCaps'</span>
Matched: <span class="s1">'Google Authenticator'</span>
Matched: <span class="s1">'GreenAddress'</span>
Matched: <span class="s1">'Guarda'</span>
Matched: <span class="s1">'Guarda Wallet'</span>
Matched: <span class="s1">'Hardware ID:'</span>
Matched: <span class="s1">'Hostname: '</span>
Matched: <span class="s1">'Hyper-V Video'</span>
Matched: <span class="s1">'ICONex'</span>
Matched: <span class="s1">'ISO-8859-1'</span>
Matched: <span class="s1">'Information.txt'</span>
Matched: <span class="s1">'Jaxx Liberty'</span>
Matched: <span class="s1">'KeePass'</span>
Matched: <span class="s1">'KeePassXC'</span>
Matched: <span class="s1">'KeepKey'</span>
Matched: <span class="s1">'Keeper'</span>
Matched: <span class="s1">'Keplr'</span>
Matched: <span class="s1">'KeyDataBlob'</span>
Matched: <span class="s1">'Last Version'</span>
Matched: <span class="s1">'LastPass'</span>
Matched: <span class="s1">'LastPass Authenticator'</span>
Matched: <span class="s1">'Ledger Live'</span>
Matched: <span class="s1">'Ledger Wallet'</span>
Matched: <span class="s1">'Local Extension Settings'</span>
Matched: <span class="s1">'Local State'</span>
Matched: <span class="s1">'Local Storage'</span>
Matched: <span class="s1">'Login Data'</span>
Matched: <span class="s1">'MEW CX'</span>
Matched: <span class="s1">'MONEY'</span>
Matched: <span class="s1">'MUSIC'</span>
Matched: <span class="s1">'MarkdownV2'</span>
Matched: <span class="s1">'Memory'</span>
Matched: <span class="s1">'MetaMask'</span>
Matched: <span class="s1">'MetaWallet'</span>
Matched: <span class="s1">'Microsoft Authenticator'</span>
Matched: <span class="s1">'Microsoft Primitive Provider'</span>
Matched: <span class="s1">'Module Info Cache'</span>
Matched: <span class="s1">'Mycelium'</span>
Matched: <span class="s1">'Name: '</span>
Matched: <span class="s1">'NeoLine'</span>
Matched: <span class="s1">'Network'</span>
Matched: <span class="s1">'NordPass'</span>
Matched: <span class="s1">'Norton Password Manager'</span>
Matched: <span class="s1">'OTP Auth'</span>
Matched: <span class="s1">'ObjectLength'</span>
Matched: <span class="s1">'OneKey'</span>
Matched: <span class="s1">'Panel'</span>
Matched: <span class="s1">'ParentProcessId'</span>
Matched: <span class="s1">'Password cannot be null.'</span>
Matched: <span class="s1">'Password.txt'</span>
Matched: <span class="s1">'Password: '</span>
Matched: <span class="s1">'Passwords:'</span>
Matched: <span class="s1">'Postal:'</span>
Matched: <span class="s1">'ProcessorId'</span>
Matched: <span class="s1">'ProductName'</span>
Matched: <span class="s1">'Profile*'</span>
Matched: <span class="s1">'Profiles'</span>
Matched: <span class="s1">'RoboForm'</span>
Matched: <span class="s1">'SEQUENCE {'</span>
Matched: <span class="s1">'Salt cannot be null.'</span>
Matched: <span class="s1">'Samourai Wallet'</span>
Matched: <span class="s1">'Screenshot.png'</span>
Matched: <span class="s1">'SerialNumber'</span>
Matched: <span class="s1">'Sollet'</span>
Matched: <span class="s1">'Splikity'</span>
Matched: <span class="s1">'Steam/'</span>
Matched: <span class="s1">'SteamPath'</span>
Matched: <span class="s1">'System'</span>
Matched: <span class="s1">'Telegram'</span>
Matched: <span class="s1">'Terra Station'</span>
Matched: <span class="s1">'TezBox'</span>
Matched: <span class="s1">'Token'</span>
Matched: <span class="s1">'TotalPhysicalMemory'</span>
Matched: <span class="s1">'Trezor'</span>
Matched: <span class="s1">'Trezor Password Manager'</span>
Matched: <span class="s1">'TronLink'</span>
Matched: <span class="s1">'Trust Wallet'</span>
Matched: <span class="s1">'UNIQUE'</span>
Matched: <span class="s1">'Unknown'</span>
Matched: <span class="s1">'User Data'</span>
Matched: <span class="s1">'Username:'</span>
Matched: <span class="s1">'Username: '</span>
Matched: <span class="s1">'VMware'</span>
Matched: <span class="s1">'VMware Virtual'</span>
Matched: <span class="s1">'Value: '</span>
Matched: <span class="s1">'Version'</span>
Matched: <span class="s1">'VirtualBox'</span>
Matched: <span class="s1">'Wallets/'</span>
Matched: <span class="s1">'Wallets:'</span>
Matched: <span class="s1">'Web Data'</span>
Matched: <span class="s1">'Win32_DiskDrive'</span>
Matched: <span class="s1">'Win32_Processor'</span>
Matched: <span class="s1">'Windows name:'</span>
Matched: <span class="s1">'Wombat'</span>
Matched: <span class="s1">'Writing is not allowed'</span>
Matched: <span class="s1">'YubiKey'</span>
Matched: <span class="s1">'Zoho Vault'</span>
Matched: <span class="s1">'[^ -]'</span>
Matched: <span class="s1">'\FileZilla'</span>
Matched: <span class="s1">'\config'</span>
Matched: <span class="s1">'].txt'</span>
Matched: <span class="s1">'admmjipmmciaobhojoghlmleefbicajg'</span>
Matched: <span class="s1">'aeachknmefphepccionboohckonoeemg'</span>
Matched: <span class="s1">'aiifbnbfobpmeekipheeijimdpnlpgpp'</span>
Matched: <span class="s1">'akrien'</span>
Matched: <span class="s1">'algorithm'</span>
Matched: <span class="s1">'amazon'</span>
Matched: <span class="s1">'americanexpress'</span>
Matched: <span class="s1">'amkmjjmmflddogmhpjloimipbofnfjih'</span>
Matched: <span class="s1">'apjdnokplgcjkejimjdfjnhmjlbpgkdi'</span>
Matched: <span class="s1">'autofill'</span>
Matched: <span class="s1">'az-Latn-AZ'</span>
Matched: <span class="s1">'bcrypt.dll'</span>
Matched: <span class="s1">'be-BY'</span>
Matched: <span class="s1">'bfbdnbpibgndpjfhonkflpkijfapmomn'</span>
Matched: <span class="s1">'bhghoamapcdpbohphigoooaddinpkbai'</span>
Matched: <span class="s1">'bhmlbgebokamljgnceonbncdofmmkedg'</span>
Matched: <span class="s1">'blbpgcogcoohhngdjafgpoagcilicpjh'</span>
Matched: <span class="s1">'bmikpgodpkclnkgmnpphehdgcimmided'</span>
Matched: <span class="s1">'bobfejfdlhnabgglompioclndjejolch'</span>
Matched: <span class="s1">'bytecoin'</span>
Matched: <span class="s1">'caljgklbbfbcjjanaijlacgncafpegll'</span>
Matched: <span class="s1">'caption'</span>
Matched: <span class="s1">'celka'</span>
Matched: <span class="s1">'cfoajccjibkjhbdjnpkbananbejpkkjb'</span>
Matched: <span class="s1">'chat_id'</span>
Matched: <span class="s1">'chgfefjpcobfbnpmiokfjjaglahmnded'</span>
Matched: <span class="s1">'cmd.exe'</span>
Matched: <span class="s1">'cookies'</span>
Matched: <span class="s1">'cookies.sqlite'</span>
Matched: <span class="s1">'country'</span>
Matched: <span class="s1">'countryCode'</span>
Matched: <span class="s1">'cphhlgmgameodnhkjdmkpanlelnlohao'</span>
Matched: <span class="s1">'credit_cards'</span>
Matched: <span class="s1">'crypt32.dll'</span>
Matched: <span class="s1">'dQw4w9WgXcQ:'</span>
Matched: <span class="s1">'dQw4w9WgXcQ:[^"]*'</span>
Matched: <span class="s1">'dbhklojmlkgmpihhdooibnmidfpeaing'</span>
Matched: <span class="s1">'displayName'</span>
Matched: <span class="s1">'dmkamcknogkgcdfhhbddcghachkejeap'</span>
Matched: <span class="s1">'document'</span>
Matched: <span class="s1">'dojmlmceifkfgkgeejemfciibjehhdcl'</span>
Matched: <span class="s1">'doljkehcfhidippihgakcihcmnknlphh'</span>
Matched: <span class="s1">'eidlicjlkaiefdbgmdepmmicpbggmhoj'</span>
Matched: <span class="s1">'elokfmmmjbadpgdjmgglocapdckdcpkn'</span>
Matched: <span class="s1">'encryptedPassword'</span>
Matched: <span class="s1">'encryptedUsername'</span>
Matched: <span class="s1">'encrypted_key'</span>
Matched: <span class="s1">'epicgames.com'</span>
Matched: <span class="s1">'false'</span>
Matched: <span class="s1">'fcglfhcjfpkgdppjbglknafgfffkelnm'</span>
Matched: <span class="s1">'fhbohimaelbohpjbbldcngcnapndodjp'</span>
Matched: <span class="s1">'fhmfendgdocmcbmfikdcogofphimnkno'</span>
Matched: <span class="s1">'filedescription'</span>
Matched: <span class="s1">'filename'</span>
Matched: <span class="s1">'flikjlpgnpcjdienoojmgliechmmheek'</span>
Matched: <span class="s1">'flpiciilemghbmfalicajoolhkkenfel'</span>
Matched: <span class="s1">'formhistory.sqlite'</span>
Matched: <span class="s1">'funpay'</span>
Matched: <span class="s1">'gabedfkgnbglfbnplfpjddgfnbibkmbb'</span>
Matched: <span class="s1">'gamesense'</span>
Matched: <span class="s1">'gdi32.dll'</span>
Matched: <span class="s1">'genshin'</span>
Matched: <span class="s1">'gflpckpfdgcagnbdfafmibcmkadnlhpj'</span>
Matched: <span class="s1">'gjffdbjndmcafeoehgdldobgjmlepcal'</span>
Matched: <span class="s1">'global-salt'</span>
Matched: <span class="s1">'gofhklgdnbnpcdigdgkgfobhhghjmmkj'</span>
Matched: <span class="s1">'hbpfjlflhnmkddbjdchbbifhllgmmhnm'</span>
Matched: <span class="s1">'hcflpincpppdclinealmandijcmnkbgn'</span>
Matched: <span class="s1">'hieplnfojfccegoloniefimmbfjdgcgp'</span>
Matched: <span class="s1">'hostname'</span>
Matched: <span class="s1">'hppmchachflomkejbhofobganapojjol'</span>
Matched: <span class="s1">'http://ip-api.com/json/?fields=11827'</span>
Matched: <span class="s1">'httpdebbugerui'</span>
Matched: <span class="s1">'hy-AM'</span>
Matched: <span class="s1">'iWallet'</span>
Matched: <span class="s1">'ibnejdfjmmkpcnlpebklmnkoeoihofec'</span>
Matched: <span class="s1">'idkppnahnmmggbmfkjhiakkbkdpnmnon'</span>
Matched: <span class="s1">'ieedgmmkpkbiblijbbldefkomatsuahh'</span>
Matched: <span class="s1">'igkpcodhieompeloncfnbekccinhapdb'</span>
Matched: <span class="s1">'ilbbpajmiplgpehdikmejfemfklpkmke'</span>
Matched: <span class="s1">'imloifkgjagghnncjkhggdhalmcnfklk'</span>
Matched: <span class="s1">'inljaljiffkdgmlndjkdiepghpolcpki'</span>
Matched: <span class="s1">'interium'</span>
Matched: <span class="s1">'jhfjfclepacoldmjmkmdlmganfaalklb'</span>
Matched: <span class="s1">'jifanbgejlbcmhbbdbnfbfnlmbomjedj'</span>
Matched: <span class="s1">'jpxupxjxheguvfyhfhahqvxvyqthiryh'</span>
Matched: <span class="s1">'key3.db'</span>
Matched: <span class="s1">'key4.db'</span>
Matched: <span class="s1">'key_data'</span>
Matched: <span class="s1">'kgeohlebpjgcfiidfhhdlnnkhefajmca'</span>
Matched: <span class="s1">'khcodhlfkpmhibicdjjblnkgimdepgnd'</span>
Matched: <span class="s1">'kk-KZ'</span>
Matched: <span class="s1">'kncchdigobghenbbaddojjnnaogfppfj'</span>
Matched: <span class="s1">'ky-KG'</span>
Matched: <span class="s1">'lbfeahdfdkibininjgejjgpdafeopflb'</span>
Matched: <span class="s1">'leveldb'</span>
Matched: <span class="s1">'logins'</span>
Matched: <span class="s1">'logins.json'</span>
Matched: <span class="s1">'mammpjaaoinfelloncbbpomjcihbkmmc'</span>
Matched: <span class="s1">'metaData'</span>
Matched: <span class="s1">'mhonjhhcgphdphdjcdoeodfdliikapmj'</span>
Matched: <span class="s1">'mnfifefkajgofkcjkemidiaecocnkjeh'</span>
Matched: <span class="s1">'moz_cookies'</span>
Matched: <span class="s1">'moz_formhistory'</span>
Matched: <span class="s1">'multipart/form-data; boundary='</span>
Matched: <span class="s1">'music.apple'</span>
Matched: <span class="s1">'naepdomgkenhinolocfifgehidddafch'</span>
Matched: <span class="s1">'nbokbjkelpmlgflobbohapifnnenbjlh'</span>
Matched: <span class="s1">'neverlose'</span>
Matched: <span class="s1">'nixware'</span>
Matched: <span class="s1">'njgnlkhcjgmjfnfahdmfkalpjcneebpl'</span>
Matched: <span class="s1">'nkbihfbeogaeaoehlefnkodbefgpgknn'</span>
Matched: <span class="s1">'nlbmnnijcnlegkjjpcfjclmcfggfefdm'</span>
Matched: <span class="s1">'nlgbhdfgdhgbiamfdfmbikcdghidoadd'</span>
Matched: <span class="s1">'nssPrivate'</span>
Matched: <span class="s1">'nursultan'</span>
Matched: <span class="s1">'ocmfilhakdbncmojmlbagpkjfbmeinbd'</span>
Matched: <span class="s1">'oeljdldpnmdbchonielidgobddffflal'</span>
Matched: <span class="s1">'parse_mode'</span>
Matched: <span class="s1">'password'</span>
Matched: <span class="s1">'password-check'</span>
Matched: <span class="s1">'paypal'</span>
Matched: <span class="s1">'pfkcfdjnlfjcmkjnhcbfhfkkoflnhjln'</span>
Matched: <span class="s1">'pfknkoocfefiocadajpngdknmkjgakdg'</span>
Matched: <span class="s1">'pidhddgciaponoajdngciiemcflpnnbg'</span>
Matched: <span class="s1">'pknlccmneadmjbkollckpblgaaabameg'</span>
Matched: <span class="s1">'ppdjlkfkedmidmclhakfncpfdmdgmjpm'</span>
Matched: <span class="s1">'prefix'</span>
Matched: <span class="s1">'query'</span>
Matched: <span class="s1">'ro-MD'</span>
Matched: <span class="s1">'ru-RU'</span>
Matched: <span class="s1">'sberbank'</span>
Matched: <span class="s1">'settings'</span>
Matched: <span class="s1">'spotify'</span>
Matched: <span class="s1">'steampowered.com'</span>
Matched: <span class="s1">'tdata'</span>
Matched: <span class="s1">'tg-Cyrl-TJ'</span>
Matched: <span class="s1">'tinkoff'</span>
Matched: <span class="s1">'uk-UA'</span>
Matched: <span class="s1">'unknown'</span>
Matched: <span class="s1">'user32.dll'</span>
Matched: <span class="s1">'usertag'</span>
Matched: <span class="s1">'uz-UZ'</span>
Matched: <span class="s1">'wallet.dat'</span>
Matched: <span class="s1">'wireshark'</span>
Matched: <span class="s1">'yoomoney'</span>
Matched: <span class="s1">'{0:X2}'</span>
</pre></table></code></div></div><p><strong>Our analysis strongly suggests that Nightingale Stealer is, in essence, an edited version of Phemedrone Stealer. It appears that the threat actor behind Nightingale Stealer made minimal alterations, primarily changing a few strings to ‘Nightingale’ and customizing certain features.</strong></p><p><strong>This discovery helps clarify why crowdsourced YARA rules initially identified this sample as Phemedrone Stealer, despite the presence of ‘Nightingale’ strings within it.</strong></p><h1 id="part-5---yara-rule">Part 5 - Yara Rule</h1><p>After an extensive analysis, it has become evident that <code class="language-plaintext highlighter-rouge">Nightingale Stealer</code> is, in fact, a variant of <code class="language-plaintext highlighter-rouge">Phemedrone Stealer</code>. Given this discovery, rather than creating new YARA rules for essentially the same malware source code, we can leverage the crowdsourced YARA rules originally designed for Phemedrone Stealer.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="n">import</span> <span class="s2">"pe"</span>

<span class="n">rule</span> <span class="n">MALWARE_Win_PhemedroneStealer</span>
<span class="p">{</span>
	<span class="n">meta</span><span class="o">:</span>
		<span class="n">author</span> <span class="o">=</span> <span class="s2">"ditekSHen"</span>
		<span class="n">description</span> <span class="o">=</span> <span class="s2">"Detects Phemedrone Stealer infostealer"</span>
		<span class="n">os</span> <span class="o">=</span> <span class="s2">"windows"</span>
		<span class="n">filetype</span> <span class="o">=</span> <span class="s2">"executable"</span>

	<span class="n">strings</span><span class="o">:</span>
		<span class="nv">$p1</span> <span class="o">=</span> <span class="o">/</span><span class="err">\</span><span class="p">{</span> <span class="n">file</span> <span class="o">=</span> <span class="err">\</span><span class="p">{(</span><span class="mi">0</span><span class="o">|</span><span class="n">file</span><span class="p">)</span><span class="err">\</span><span class="p">},</span> <span class="n">data</span> <span class="o">=</span> <span class="err">\</span><span class="p">{(</span><span class="mi">1</span><span class="o">|</span><span class="n">data</span><span class="p">)</span><span class="err">\</span><span class="p">}</span> <span class="err">\</span><span class="p">}</span><span class="o">/</span> <span class="n">ascii</span> <span class="n">wide</span>
		<span class="nv">$p2</span> <span class="o">=</span> <span class="s2">"{ &lt;&gt;h__TransparentIdentifier0 = </span><span class="si">{</span><span class="nv">0</span><span class="si">}</span><span class="s2">, match = </span><span class="si">{</span><span class="nv">1</span><span class="si">}</span><span class="s2"> }"</span> <span class="n">wide</span>
		<span class="nv">$p3</span> <span class="o">=</span> <span class="s2">"{ &lt;&gt;h__TransparentIdentifier1 = </span><span class="si">{</span><span class="nv">0</span><span class="si">}</span><span class="s2">, encrypted = </span><span class="si">{</span><span class="nv">1</span><span class="si">}</span><span class="s2"> }"</span> <span class="n">wide</span>
		<span class="nv">$p4</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">&lt;&gt;h__TransparentIdentifier0</span><span class="si">}</span><span class="s2">, match = </span><span class="si">{</span><span class="nv">match</span><span class="si">}</span><span class="s2"> }"</span> <span class="n">ascii</span>
		<span class="nv">$p5</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">&lt;&gt;h__TransparentIdentifier1</span><span class="si">}</span><span class="s2">, encrypted = </span><span class="si">{</span><span class="nv">encrypted</span><span class="si">}</span><span class="s2"> }"</span> <span class="n">ascii</span>
		<span class="nv">$s1</span> <span class="o">=</span> <span class="s2">"&lt;KillDebuggers&gt;b__"</span> <span class="n">ascii</span>
		<span class="nv">$s2</span> <span class="o">=</span> <span class="s2">"&lt;ParseExtensions&gt;b__"</span> <span class="n">ascii</span>
		<span class="nv">$s3</span> <span class="o">=</span> <span class="s2">"&lt;ParseDiscordTokens&gt;b__"</span> <span class="n">ascii</span>
		<span class="nv">$s4</span> <span class="o">=</span> <span class="s2">"&lt;IsVM&gt;b__"</span> <span class="n">ascii</span>
		<span class="nv">$s5</span> <span class="o">=</span> <span class="s2">"&lt;Key3Database&gt;b__"</span> <span class="n">ascii</span>
		<span class="nv">$s6</span> <span class="o">=</span> <span class="s2">"masterPass"</span> <span class="n">ascii</span>
		<span class="nv">$s7</span> <span class="o">=</span> <span class="s2">"rootLocation"</span> <span class="n">ascii</span>
		<span class="nv">$s8</span> <span class="o">=</span> <span class="s2">"rgsServiceNames"</span> <span class="n">ascii</span>
		<span class="nv">$s9</span> <span class="o">=</span> <span class="s2">"rgsFilenames"</span> <span class="n">ascii</span>

	<span class="n">condition</span><span class="o">:</span>
		<span class="nf">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mh">0x5a4d</span> <span class="k">and</span> <span class="p">((</span> <span class="n">all</span> <span class="nf">of</span> <span class="p">(</span><span class="nv">$p</span><span class="o">*</span><span class="p">)</span> <span class="k">and</span> <span class="mi">3</span> <span class="nf">of</span> <span class="p">(</span><span class="nv">$s</span><span class="o">*</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="mi">3</span> <span class="nf">of</span> <span class="p">(</span><span class="nv">$p</span><span class="o">*</span><span class="p">)</span> <span class="k">and</span> <span class="mi">4</span> <span class="nf">of</span> <span class="p">(</span><span class="nv">$s</span><span class="o">*</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="mi">7</span> <span class="nf">of</span> <span class="p">(</span><span class="nv">$s</span><span class="o">*</span><span class="p">)))</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="part-6---iocs">Part 6 - IOCs</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>0cc6d724ac017163b40866c820fd67df6ac89924a623490ec1de2ecacf1d0219
1fdd63b4b1db9637871a4f574c746980977accf2a0f6c3ceaef82b6641a3e9e7
kinggru.duckdns.org
</pre></table></code></div></div><h1 id="references">References</h1><ul><li><a href="https://twitter.com/suyog41/status/1751930165230469619">https://twitter.com/suyog41/status/1751930165230469619</a><li><a href="https://hackforums.net/showthread.php?tid=6258265">https://hackforums.net/showthread.php?tid=6258265</a><li><a href="https://github.com/kid0604/yara-rules/blob/e6adc1c81e0698b6c349e78148bffa78c5ed7c5b/executable_windows/4334482e8e93d3407716ad54a0a3988e60a02eb6.yar">https://github.com/kid0604/yara-rules/blob/e6adc1c81e0698b6c349e78148bffa78c5ed7c5b/executable_windows/4334482e8e93d3407716ad54a0a3988e60a02eb6.yar</a></ul><p><strong>I utilized AI assistance to fine-tune certain sentences in this post, enhancing clarity and precision.</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/malware-hunting/'>Malware Hunting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse engineering</a> <a href="/tags/malware-hunting/" class="post-tag no-text-decoration" >malware hunting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hunt and Analysis - Nightingale Stealer - tufan.&amp;url=https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hunt and Analysis - Nightingale Stealer - tufan.&amp;u=https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tufan-gungor.github.io/posts/nightingale-stealer-analysis/&amp;text=Hunt and Analysis - Nightingale Stealer - tufan." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spynote-android-malware/">Spynote Android Malware Masquerades as VPN Amid Turkey's Instagram Ban</a><li><a href="/posts/nightingale-stealer-analysis/">Hunt and Analysis - Nightingale Stealer</a><li><a href="/posts/hornet-stealer-analysis/">Hunt and Analysis - Hornet Stealer</a><li><a href="/posts/sentinel-stealer-analysis/">Hunt and Analysis - Sentinel Stealer</a><li><a href="/posts/neptune-loader-analysis/">Hunt and Analysis - Neptune Loader</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/serpent-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1704556800" > 2024-01-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Serpent Stealer</h3><div class="text-muted small"><p> Part 1 - Dissecting the First Serpent Stealer Sample On October 15, 2023, a new malware named Serpent Stealer was showcased on Breach Forums by a user named stealth. This malware, categorized as a...</p></div></div></a></div><div class="card"> <a href="/posts/neptune-loader-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705161600" > 2024-01-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Neptune Loader</h3><div class="text-muted small"><p> Part 1 - Neptune || A Native HTTP Loader A user named m0hx shared a post on hackforums.net on November 22, 2023, promoting a loader called Neptune. In the threat actor’s exact words; “Neptune is ...</p></div></div></a></div><div class="card"> <a href="/posts/sentinel-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705766400" > 2024-01-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Sentinel Stealer</h3><div class="text-muted small"><p> Part 1 - Sentinel Stealer || Stealer as a Service On January 19th, the Twitter account @FalconFeedsio reported the discovery of a new stealer, known as Sentinel Stealer. Although there were earlie...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hornet-stealer-analysis/" class="btn btn-outline-primary" prompt="Older"><p>Hunt and Analysis - Hornet Stealer</p></a> <a href="/posts/spynote-android-malware/" class="btn btn-outline-primary" prompt="Newer"><p>Spynote Android Malware Masquerades as VPN Amid Turkey's Instagram Ban</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QEK7ERP9FL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QEK7ERP9FL'); }); </script>
