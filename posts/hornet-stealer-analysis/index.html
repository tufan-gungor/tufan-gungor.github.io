<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hunt and Analysis - Hornet Stealer" /><meta name="author" content="Tufan Gungor" /><meta property="og:locale" content="en" /><meta name="description" content="Part 1 - Hornet Stealer" /><meta property="og:description" content="Part 1 - Hornet Stealer" /><link rel="canonical" href="https://tufan-gungor.github.io/posts/hornet-stealer-analysis/" /><meta property="og:url" content="https://tufan-gungor.github.io/posts/hornet-stealer-analysis/" /><meta property="og:site_name" content="tufan." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-29T19:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hunt and Analysis - Hornet Stealer" /><meta name="twitter:site" content="@tufan_gngr" /><meta name="twitter:creator" content="@Tufan Gungor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Tufan Gungor"},"dateModified":"2024-01-30T14:53:44+03:00","datePublished":"2024-01-29T19:00:00+03:00","description":"Part 1 - Hornet Stealer","headline":"Hunt and Analysis - Hornet Stealer","mainEntityOfPage":{"@type":"WebPage","@id":"https://tufan-gungor.github.io/posts/hornet-stealer-analysis/"},"url":"https://tufan-gungor.github.io/posts/hornet-stealer-analysis/"}</script><title>Hunt and Analysis - Hornet Stealer | tufan.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="tufan."><meta name="application-name" content="tufan."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/favicons/tufan_logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">tufan.</a></div><div class="site-subtitle font-italic">Malware Analysis & Threat Intelligence</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tufan-gungor" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/tufan_gngr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tufan.gngr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hunt and Analysis - Hornet Stealer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hunt and Analysis - Hornet Stealer</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1706544000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-29 </em> </span> <span> Updated <em class="timeago" data-ts="1706615624" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-30 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3601 words"> <em>20 min</em> read</span></div></div></div><div class="post-content"><h1 id="part-1---hornet-stealer">Part 1 - Hornet Stealer</h1><p><img data-src="/assets/img/hornet/0.png" alt="Untitled" data-proofer-ignore></p><p>On January 24th, the Twitter account <a href="https://twitter.com/spamhaus/status/1750170178493526350/photo/1">@spamhaus</a> posted a tweet regarding a newly discovered C2 panel. Based on the panel’s logo and name, they have identified this malware as <code class="language-plaintext highlighter-rouge">Hornet Stealer</code>.</p><p><img data-src="/assets/img/hornet/1.png" alt="Untitled" data-proofer-ignore></p><p>According to <a href="https://twitter.com/spamhaus/status/1750170181710602474">@spamhaus</a>’s tweets, <code class="language-plaintext highlighter-rouge">Hornet Stealer</code>, which is downloaded via <code class="language-plaintext highlighter-rouge">Smokeloader</code>, is written in <code class="language-plaintext highlighter-rouge">Golang</code>. It targets several applications, such as <code class="language-plaintext highlighter-rouge">browsers</code>, <code class="language-plaintext highlighter-rouge">wallets</code>, <code class="language-plaintext highlighter-rouge">Steam</code>, <code class="language-plaintext highlighter-rouge">Telegram</code>, among others. The malware decrypts strings using <code class="language-plaintext highlighter-rouge">Fernet</code> with a hardcoded key, then encrypts the acquired data using <code class="language-plaintext highlighter-rouge">AES GCM</code>, and finally transmits this encrypted data to a server via <code class="language-plaintext highlighter-rouge">TCP connection</code>.</p><p>In this article, we aim to discover and analyze the earliest known sample of the <code class="language-plaintext highlighter-rouge">Hornet Stealer</code> malware.</p><h1 id="part-2---dissecting-the-first-hornet-stealer-sample">Part 2 - <strong>Dissecting the First Hornet Stealer Sample</strong></h1><h2 id="1-tracing-the-origins-of-the-hornet-stealer"><span class="mr-2">1. Tracing the Origins of the Hornet Stealer</span><a href="#1-tracing-the-origins-of-the-hornet-stealer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To locate the initial sample of the <code class="language-plaintext highlighter-rouge">Hornet Stealer</code>, we can examine the IP address relationships mentioned in <a href="https://twitter.com/spamhaus/status/1750170181710602474">@spamhaus</a>’s tweet on VirusTotal.</p><p>Upon searching for the IP address <code class="language-plaintext highlighter-rouge">185.221.198.118</code> and navigating to the Relations tab on VirusTotal, one can observe a file under the ‘Communicating Files’ section. This file appears to be malicious, indicated by its high <code class="language-plaintext highlighter-rouge">detection score of 42 out of 71</code>.</p><p><img data-src="/assets/img/hornet/2.png" alt="Untitled" data-proofer-ignore></p><p>Navigating to the Details tab of this file reveals that it is programmed in Golang, and its initial submission date of <code class="language-plaintext highlighter-rouge">January 23, 2024</code>, suggests that it’s a recent addition. These details strongly point to it being the <code class="language-plaintext highlighter-rouge">Hornet Stealer</code> sample we’re investigating.</p><p><img data-src="/assets/img/hornet/3.png" alt="Untitled" data-proofer-ignore></p><p><strong>SHA256: <em>bc3ee10c21cb07bc0dd6b84a6eaf8efbd0af889467ab7ef647acf60f8c188e83</em></strong></p><p>Prior to analyzing this file, it’s worthwhile to investigate its potential connection with <code class="language-plaintext highlighter-rouge">Smokeloader</code>. However, the <code class="language-plaintext highlighter-rouge">Relations</code> tab in <code class="language-plaintext highlighter-rouge">VirusTotal</code> doesn’t display any links to <code class="language-plaintext highlighter-rouge">Smokeloader</code>. A quick Google search using the file’s hash led to a result from <code class="language-plaintext highlighter-rouge">Unpacme</code>, revealing that this file is hosted on the transfer.sh website with a name <code class="language-plaintext highlighter-rouge">setup.exe</code>.</p><p><img data-src="/assets/img/hornet/4.png" alt="Untitled" data-proofer-ignore></p><p><strong>Link: <em>https://transfer.sh/get/q4ccSmjmTB/setup.exe</em></strong></p><p>A search on VirusTotal using this link reveals a <code class="language-plaintext highlighter-rouge">Crowdsourced Context</code> note stating <code class="language-plaintext highlighter-rouge">Activity related to SMOKELOADER</code>. However, it doesn’t provide an associated sample.</p><h2 id="2-deep-dive-into-the-hornet-stealers-first-sample"><span class="mr-2">2. Deep Dive into the Hornet Stealer’s First Sample</span><a href="#2-deep-dive-into-the-hornet-stealers-first-sample" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>SHA256: <em>bc3ee10c21cb07bc0dd6b84a6eaf8efbd0af889467ab7ef647acf60f8c188e83</em></strong></p><p>Aware that this sample contains encrypted strings and utilizes <code class="language-plaintext highlighter-rouge">Fernet</code> for runtime decryption, we can proceed by loading the sample into IDA. This will allow us to closely examine its string decryption routine.</p><p>Given that the sample’s symbolic information is not stripped, IDA has been able to rename all functions, thereby facilitating an easier analysis.</p><p><img data-src="/assets/img/hornet/5.png" alt="Untitled" data-proofer-ignore></p><p>The presence of meaningful function names simplifies our task to reading the code. Nonetheless, the challenge lies in the encryption of crucial strings. To uncover how they are decrypted, we concentrate on the first function call, following the path: <code class="language-plaintext highlighter-rouge">main.main</code> &gt; <code class="language-plaintext highlighter-rouge">setup_utils_AntiCIS</code> &gt; <code class="language-plaintext highlighter-rouge">setup_utils_GetkeyboardLayoutList</code> &gt; <code class="language-plaintext highlighter-rouge">setup_utils_DecryptString</code>. This path leads us to identify <code class="language-plaintext highlighter-rouge">setup_utils_DecryptString</code> as the key function for string decryption.</p><p><img data-src="/assets/img/hornet/6.png" alt="Untitled" data-proofer-ignore></p><p>The recurring use of a string at the offset <code class="language-plaintext highlighter-rouge">off_70CC10</code> before every call to <code class="language-plaintext highlighter-rouge">setup_utils_DecryptString</code> suggested to us that this might be the decryption key.</p><p>Although <a href="https://twitter.com/spamhaus/status/1750170178493526350">@spamhaus</a>’s tweet already indicated the use of Fernet, we can confirm this by examining <code class="language-plaintext highlighter-rouge">setup_utils_DecryptString</code> more closely.</p><p><img data-src="/assets/img/hornet/7.png" alt="Untitled" data-proofer-ignore></p><p>With the algorithm, decryption key, and encrypted data at hand, we have the opportunity to use <code class="language-plaintext highlighter-rouge">Python</code> for decrypting a string, which will validate the correctness of our approach.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>&gt;&gt;&gt; from cryptography.fernet import Fernet
&gt;&gt;&gt; key = 'MpQzH0ne3b-TkBgkJ0tbdALxiCiJuLBleGUlEoIGQoo='
&gt;&gt;&gt; encrypted_data = 'gAAAAABlsBIs-I3FZyAavfZo8FAeeSmwVqn5DHwjQGrATv5Mz3jzjEk9KD9LBJiTzKDvGmb-RFX1Z-jBO4x5JUIy-ZD6Zf103A=='
&gt;&gt;&gt; fernet = Fernet(key)
&gt;&gt;&gt; decrypted_data = fernet.decrypt(encrypted_data)
&gt;&gt;&gt; decrypted_data
**b'user32.dll'**
&gt;&gt;&gt; decrypted_data.decode()
**'user32.dll'**
</pre></table></code></div></div><p>The effectiveness of our method was proven when our Python code decrypted a string into <code class="language-plaintext highlighter-rouge">user32.dll</code>. Henceforth, I will decrypt and annotate every string in the functions with their decrypted counterparts as comments. Furthermore, at the end of this article, a <code class="language-plaintext highlighter-rouge">custom string extractor</code> for this malware sample will be introduced.</p><p>Armed with this knowledge, let’s delve into analyzing some key functionalities of the <code class="language-plaintext highlighter-rouge">Hornet Stealer</code>, starting with the <code class="language-plaintext highlighter-rouge">setup_utils_init</code> function.</p><h3 id="setup_utils_init-function"><span class="mr-2">setup_utils_init Function</span><a href="#setup_utils_init-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>We begin our analysis with the <code class="language-plaintext highlighter-rouge">setup_utils_init</code> function, which is executed even before the main function. It plays a crucial role in decrypting several important strings, one of which is the C2 address.</p><p><img data-src="/assets/img/hornet/8.png" alt="Untitled" data-proofer-ignore></p><h3 id="setup_grabber_init-function"><span class="mr-2">setup_Grabber_init Function</span><a href="#setup_grabber_init-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">setup_Grabber_init</code> function, executing prior to the main function, decrypts several crucial strings, including a list of wallet applications. The utilization of these decrypted strings will be explored in a later part of our analysis.</p><p><img data-src="/assets/img/hornet/9.png" alt="Untitled" data-proofer-ignore></p><p>First decrypted string;</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Exodus || exodus || Partitions || cache || dictionar
Atomic || atomic || cache || IndexedDB
JaxxLiberty || com.liberty.jaxx || cache
Coinomi || Coinomi\Coinomi\wallets || null-
Electrum || Electrum\wallets || null-
Electrum-LTC || Electrum-LTC\wallets || null-
ElectronCash || ElectronCash\wallets || null-
Guarda || Guarda || cache || IndexedDB
MyMonero || MyMonero || cache
Monero || Monero\\wallets || null-
Wasabi || WalletWasabi\\Client || tor || log
TokenPocket || TokenPocket || cache
Ledger Live || Ledger Live || cache || dictionar || sqlite
Binance || Binance || cache || null-
</pre></table></code></div></div><p>Second decrypted string;</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre>fhbohimaelbohpjbbldcngcnapndodjp || BinanceChain
fnjhmkhhmkbjkkabndcnnogagogbneec || Ronin
kjmoohlgokccodicjjfebfomlbljgfhk || Ronin
nkbihfbeogaeaoehlefnkodbefgpgknn || MetaMask
ejbalbakoplchlghecdalmeeeajnimhm || MetaMask
ibnejdfjmmkpcnlpebklmnkoeoihofec || TronLink
egjidjbpglichdcondbcbdnbeeppgdph || TrustWallet
bfnaelmomeimhlpmgjnjophhpkkoljpa || Phantom
hnfanknocfeofbddgcijnmhnfnkdnaad || Coinbase
odbfpeeihdkbihmopkbjmoonfanlbfcl || Brave
cgeeodpfagjceefieflmdfphplkenlfk || TON
aeachknmefphepccionboohckonoeemg || Coin98
mcohilncbfahbmgdjkbpemcciiolgcge || MetaX
hmeobnfnfcmdkdcmlblgagmfpfboieaf || XDEFI
lpilbniiabackdjcionkobglmddfbcjo || WavesKeeper
bhhhlbepdkbapadjdnnojkbgioiodbic || Solflare
acmacodkjbdgmoleebolmdjonilkdbch || Rabby
dkdedlpgdmmkkfjabffeganieamfklkm || CyanoWallet
cnmamaachppnkjgnildpdmkaakejnhae || AuroWallet
hcflpincpppdclinealmandijcmnkbgn || KHC
mnfifefkajgofkcjkemidiaecocnkjeh || TezBox
ookjlbkiijinhpmnjffcofjonbfbgaoc || Temple
flpiciilemghbmfalicajoolhkkenfel || ICONex
fhmfendgdocmcbmfikdcogofphimnkno || Sollet
nhnkbkgjikgcigadomkphalanndcapjk || CloverWallet
jojhfeoedkpkglbfimdfabpdfjaoolaf || PolymeshWallet
cphhlgmgameodnhkjdmkpanlelnlohao || NeoLine
dmkamcknogkgcdfhhbddcghachkejeap || Keplr
ajkhoeiiokighlmdnlakpjfoobnjinie || TerraStation
aiifbnbfobpmeekipheeijimdpnlpgpp || TerraStation
kpfopkelmapcoipemfendmdcghnegimn || Liquality
nkddgncdjgjfcddamfgcmfnlhccnimig || SaturnWallet
nanjmdknhkinifnkgdcggcfnhdaammmj || GuildWallet
jnkelfanjkeadonecabehalmbgpfodjm || Goby
nphplpgoakhhjchkkhmiggakijnkhfnd || TON
fpkhgmpbidmiogeglndfbkegfdlnajnf || Cosmostation
jiidiaalihmmhddjgbnbgdfflelocpak || BitKeep
pgiaagfkgcbnmiiolekcfmljdagdhlcm || Stargazer
cjelfplplebdjjenllpjcblmjkfcffne || JaxxLiberty
kkpllkodjeloidieedojogacfhpaihoh || Enkrypt
pkkjjapmlcncipeecdmlhaipahfdphkd || GameStopWallet
aholpfdialjgjfhomihkjbmgjidlcdno || ExodusWeb3Wallet
nngceckbapebfimnlniiiahkandclblb || Bitwarden
efbglgofoippbgcjepnhiblaibcnclgk || MartianAptos
jnlgamecbpmbajjfhmmmlhejkemejdma || Braavos
mcohilncbfahbmgdjkbpemcciiolgcge || OKX
phkbamefinggmakgklpkljjmgibohnba || PontemAptos
epapihdplajcdnnkdeiahlgigofloibg || SenderWallet
gjagmgiddbbciopjhllkdnddhcglnemk || Hashpack
cgeeodpfagjceefieflmdfphplkenlfk || EVER
cjmkndjhnagcfbpiemnkdpomccnjblmj || Finnie
aijcbedoijmgnlmjeegjaglmepbmpkpi || LeapTerra
ejjladinnckdgjemekebdpeokbikhfci || PetraAptos
kmhcihpebfmpgmihbkipmjlmmioameka || Eternl
bgpipimickeadkjlklgciifhnalhdjhe || GeroWallet
lpfcbjknijpeeillifnkikgncikgfhdo || NamiWallet
pocmplpaccanhmnllbbkpgfliimjljgo || SlopeWallet
ffnbelfdoeiohenkjibnmadjiehjhajb || Yoroi
afbcbjpbpfadlkmhmclhkeeodmamcflc || Math
hpglfhgfnhbgpjdenjgmdgoeiappafln || Guarda
kncchdigobghenbbaddojjnnaogfppfj || iWallet
amkmjjmmflddogmhpjloimipbofnfjih || Wombat
nlbmnnijcnlegkjjpcfjclmcfggfefdm || MEWCX
nknhiehlklippafakaeklbeglecifhad || NaboxWallet
jnmbobjmhlngoefaiojfljckilhhlhcj || OneKey
pdadjkfkgcafgbceimcpbkalnfnepbnk || KardiaChainWallet
</pre></table></code></div></div><h3 id="setup_utils_anticis-function"><span class="mr-2">setup_utils_AntiCIS Function</span><a href="#setup_utils_anticis-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>In the <code class="language-plaintext highlighter-rouge">main</code> function screenshot, we see that the first call made by the malware is to <code class="language-plaintext highlighter-rouge">setup_utils_AntiCIS</code>. This function begins by decrypting and utilizing <code class="language-plaintext highlighter-rouge">user32.dll</code> and <code class="language-plaintext highlighter-rouge">GetKeyboardLayoutList</code>. It then invokes <code class="language-plaintext highlighter-rouge">GetKeyboardLayoutList</code> and compares the obtained keyboard layouts with a preset list. From its name and behavior, it’s clear that this function is designed to check for keyboard layouts typical of the <code class="language-plaintext highlighter-rouge">CIS region countries</code>, and if a match is detected, the malware promptly exits without executing further.</p><p><img data-src="/assets/img/hornet/10.png" alt="Untitled" data-proofer-ignore></p><p>Interestingly, one of the hex values, <code class="language-plaintext highlighter-rouge">443h</code>, does not have a corresponding keyboard identifier in Microsoft’s official documentation on <a href="https://learn.microsoft.com/en-us/globalization/windows-keyboard-layouts">Windows keyboard layouts</a>.</p><p>The <code class="language-plaintext highlighter-rouge">AntiCIS</code> function uniquely targets devices based on their geographic location, specifically halting execution on those with CIS region keyboard layouts. This is a common tactic in malware, typically to avoid affecting systems in the developers’ own region, possibly due to legal or ethical considerations.</p><h3 id="setup_utils_connection-function"><span class="mr-2">setup_utils_Connection Function</span><a href="#setup_utils_connection-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">setup_utils_Connection</code> function straightforwardly initiates a <code class="language-plaintext highlighter-rouge">TCP</code> connection between the C2 server (<strong><em>185.221.198.118:8080</em></strong>) and the infected device. Should it fail to establish this connection to the C2 address, the function will terminate the process.</p><p><img data-src="/assets/img/hornet/11.png" alt="Untitled" data-proofer-ignore></p><p>Once this connection is successfully established, the malware initiates its data collection process.</p><h3 id="main_launchuserinfo-function"><span class="mr-2">main_launchUserInfo Function</span><a href="#main_launchuserinfo-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">main_launchUserInfo</code> function initially creates a folder named <code class="language-plaintext highlighter-rouge">\logs\MainFolderLog</code>, then proceeds to gather various system details like <code class="language-plaintext highlighter-rouge">CPU</code>, <code class="language-plaintext highlighter-rouge">GPU</code>, <code class="language-plaintext highlighter-rouge">RAM</code>, <code class="language-plaintext highlighter-rouge">OS</code>, <code class="language-plaintext highlighter-rouge">TimeZone</code>, <code class="language-plaintext highlighter-rouge">Language</code>, and <code class="language-plaintext highlighter-rouge">Architecture</code>, storing this information in <code class="language-plaintext highlighter-rouge">\logs\MainFolderLog\UserInformation.txt</code>. It also compiles a list of <code class="language-plaintext highlighter-rouge">installed applications</code>, saving it in <code class="language-plaintext highlighter-rouge">\logs\MainFolderLog\InstalledSoftware.txt</code>’ Finally, it encrypts this data with AES GCM and transmits it to the C2 server. The specifics of C2 traffic encryption will be addressed later in our analysis.</p><p><img data-src="/assets/img/hornet/12.png" alt="Untitled" data-proofer-ignore></p><p>Data format;</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Tags: %s
BuildId: %s
UserName: %s
CPU: %s
GPU: %s
RAM: %s
OS: %s
Current date: %s
TimeZone: %s
Language: %s
Architecture: %s
Screen: %s
HWID: %s
</pre></table></code></div></div><h3 id="main_launchdesktopwallet-function"><span class="mr-2">main_launchDesktopwallet Function</span><a href="#main_launchdesktopwallet-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">main_launchDesktopwallet</code> function scans for the decrypted wallet folder names within the <code class="language-plaintext highlighter-rouge">\AppData\Roaming</code> directory. Upon finding a match, it encrypts the relevant data and transmits it to the C2 server.</p><p><img data-src="/assets/img/hornet/13.png" alt="Untitled" data-proofer-ignore></p><p>Wallet list;</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Exodus || exodus || Partitions || cache || dictionar
Atomic || atomic || cache || IndexedDB
JaxxLiberty || com.liberty.jaxx || cache
Coinomi || Coinomi\Coinomi\wallets || null-
Electrum || Electrum\wallets || null-
Electrum-LTC || Electrum-LTC\wallets || null-
ElectronCash || ElectronCash\wallets || null-
Guarda || Guarda || cache || IndexedDB
MyMonero || MyMonero || cache
Monero || Monero\\wallets || null-
Wasabi || WalletWasabi\\Client || tor || log
TokenPocket || TokenPocket || cache
Ledger Live || Ledger Live || cache || dictionar || sqlite
Binance || Binance || cache || null-
</pre></table></code></div></div><h3 id="main_launchwallet-function"><span class="mr-2">main_launchwallet Function</span><a href="#main_launchwallet-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Functioning in a recursive manner, <code class="language-plaintext highlighter-rouge">main_launchwallet</code> explores both the <code class="language-plaintext highlighter-rouge">\AppData\Roaming</code> and <code class="language-plaintext highlighter-rouge">\AppData\Local</code> directories, targeting the previously decrypted names of wallet browser extensions located in the various browsers’ <code class="language-plaintext highlighter-rouge">Extensions</code> folders.</p><p><img data-src="/assets/img/hornet/14.png" alt="Untitled" data-proofer-ignore></p><p>Wallet Extension List;</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre>fhbohimaelbohpjbbldcngcnapndodjp || BinanceChain
fnjhmkhhmkbjkkabndcnnogagogbneec || Ronin
kjmoohlgokccodicjjfebfomlbljgfhk || Ronin
nkbihfbeogaeaoehlefnkodbefgpgknn || MetaMask
ejbalbakoplchlghecdalmeeeajnimhm || MetaMask
ibnejdfjmmkpcnlpebklmnkoeoihofec || TronLink
egjidjbpglichdcondbcbdnbeeppgdph || TrustWallet
bfnaelmomeimhlpmgjnjophhpkkoljpa || Phantom
hnfanknocfeofbddgcijnmhnfnkdnaad || Coinbase
odbfpeeihdkbihmopkbjmoonfanlbfcl || Brave
cgeeodpfagjceefieflmdfphplkenlfk || TON
aeachknmefphepccionboohckonoeemg || Coin98
mcohilncbfahbmgdjkbpemcciiolgcge || MetaX
hmeobnfnfcmdkdcmlblgagmfpfboieaf || XDEFI
lpilbniiabackdjcionkobglmddfbcjo || WavesKeeper
bhhhlbepdkbapadjdnnojkbgioiodbic || Solflare
acmacodkjbdgmoleebolmdjonilkdbch || Rabby
dkdedlpgdmmkkfjabffeganieamfklkm || CyanoWallet
cnmamaachppnkjgnildpdmkaakejnhae || AuroWallet
hcflpincpppdclinealmandijcmnkbgn || KHC
mnfifefkajgofkcjkemidiaecocnkjeh || TezBox
ookjlbkiijinhpmnjffcofjonbfbgaoc || Temple
flpiciilemghbmfalicajoolhkkenfel || ICONex
fhmfendgdocmcbmfikdcogofphimnkno || Sollet
nhnkbkgjikgcigadomkphalanndcapjk || CloverWallet
jojhfeoedkpkglbfimdfabpdfjaoolaf || PolymeshWallet
cphhlgmgameodnhkjdmkpanlelnlohao || NeoLine
dmkamcknogkgcdfhhbddcghachkejeap || Keplr
ajkhoeiiokighlmdnlakpjfoobnjinie || TerraStation
aiifbnbfobpmeekipheeijimdpnlpgpp || TerraStation
kpfopkelmapcoipemfendmdcghnegimn || Liquality
nkddgncdjgjfcddamfgcmfnlhccnimig || SaturnWallet
nanjmdknhkinifnkgdcggcfnhdaammmj || GuildWallet
jnkelfanjkeadonecabehalmbgpfodjm || Goby
nphplpgoakhhjchkkhmiggakijnkhfnd || TON
fpkhgmpbidmiogeglndfbkegfdlnajnf || Cosmostation
jiidiaalihmmhddjgbnbgdfflelocpak || BitKeep
pgiaagfkgcbnmiiolekcfmljdagdhlcm || Stargazer
cjelfplplebdjjenllpjcblmjkfcffne || JaxxLiberty
kkpllkodjeloidieedojogacfhpaihoh || Enkrypt
pkkjjapmlcncipeecdmlhaipahfdphkd || GameStopWallet
aholpfdialjgjfhomihkjbmgjidlcdno || ExodusWeb3Wallet
nngceckbapebfimnlniiiahkandclblb || Bitwarden
efbglgofoippbgcjepnhiblaibcnclgk || MartianAptos
jnlgamecbpmbajjfhmmmlhejkemejdma || Braavos
mcohilncbfahbmgdjkbpemcciiolgcge || OKX
phkbamefinggmakgklpkljjmgibohnba || PontemAptos
epapihdplajcdnnkdeiahlgigofloibg || SenderWallet
gjagmgiddbbciopjhllkdnddhcglnemk || Hashpack
cgeeodpfagjceefieflmdfphplkenlfk || EVER
cjmkndjhnagcfbpiemnkdpomccnjblmj || Finnie
aijcbedoijmgnlmjeegjaglmepbmpkpi || LeapTerra
ejjladinnckdgjemekebdpeokbikhfci || PetraAptos
kmhcihpebfmpgmihbkipmjlmmioameka || Eternl
bgpipimickeadkjlklgciifhnalhdjhe || GeroWallet
lpfcbjknijpeeillifnkikgncikgfhdo || NamiWallet
pocmplpaccanhmnllbbkpgfliimjljgo || SlopeWallet
ffnbelfdoeiohenkjibnmadjiehjhajb || Yoroi
afbcbjpbpfadlkmhmclhkeeodmamcflc || Math
hpglfhgfnhbgpjdenjgmdgoeiappafln || Guarda
kncchdigobghenbbaddojjnnaogfppfj || iWallet
amkmjjmmflddogmhpjloimipbofnfjih || Wombat
nlbmnnijcnlegkjjpcfjclmcfggfefdm || MEWCX
nknhiehlklippafakaeklbeglecifhad || NaboxWallet
jnmbobjmhlngoefaiojfljckilhhlhcj || OneKey
pdadjkfkgcafgbceimcpbkalnfnepbnk || KardiaChainWallet
</pre></table></code></div></div><h3 id="main_launchbrowser-function"><span class="mr-2">main_launchBrowser Function</span><a href="#main_launchbrowser-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Serving as a typical stealer function, <code class="language-plaintext highlighter-rouge">main_launchBrowser</code> is dedicated to harvesting browser data, including <code class="language-plaintext highlighter-rouge">login details</code> and <code class="language-plaintext highlighter-rouge">cookies</code>. After gathering this data, the function encrypts it and then sends it off to the C2.</p><p><img data-src="/assets/img/hornet/15.png" alt="Untitled" data-proofer-ignore></p><h3 id="main_launchtelegram-function"><span class="mr-2">main_launchTelegram Function</span><a href="#main_launchtelegram-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">main_launchTelegram</code> function targets the <code class="language-plaintext highlighter-rouge">\AppData\Roaming\Telegram Desktop\tdata</code> directory, extracting critical files such as <code class="language-plaintext highlighter-rouge">key_data</code> and <code class="language-plaintext highlighter-rouge">usertag</code>. Following the theft, it encrypts this data and dispatches it to the C2 server.</p><p><img data-src="/assets/img/hornet/16.png" alt="Untitled" data-proofer-ignore></p><h3 id="main_launchsteam-function"><span class="mr-2">main_launchSteam Function</span><a href="#main_launchsteam-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">main_launchSteam</code> function is designed to gather data from the <code class="language-plaintext highlighter-rouge">Steam</code> desktop application, including <code class="language-plaintext highlighter-rouge">auto-login</code> information, <code class="language-plaintext highlighter-rouge">game lists</code>, and <code class="language-plaintext highlighter-rouge">statuses</code>. This stolen data is compiled into <code class="language-plaintext highlighter-rouge">SteamInfo.txt</code>, encrypted, and then transmitted to the C2 server.</p><p><img data-src="/assets/img/hornet/17.png" alt="Untitled" data-proofer-ignore></p><h3 id="main_launchscreenshot-function"><span class="mr-2">main_launchScreenshot Function</span><a href="#main_launchscreenshot-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>As its name suggests, the <code class="language-plaintext highlighter-rouge">main_launchScreenshot</code> function captures screenshots of the current windows, saving them with the naming format <code class="language-plaintext highlighter-rouge">ScreenShot (%d_%dx%d).png</code>. After saving, it encrypts these screenshots and transmits them to the C2 server.</p><p><img data-src="/assets/img/hornet/18.png" alt="Untitled" data-proofer-ignore></p><h3 id="main_launchdiscord-function"><span class="mr-2">main_launchDiscord Function</span><a href="#main_launchdiscord-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">main_launchDiscord</code> function searches through the <code class="language-plaintext highlighter-rouge">\AppData\Local</code> and <code class="language-plaintext highlighter-rouge">\AppData\Roaming</code> directories to locate leveldb files associated with the Discord Desktop app. After collecting this data, it compiles it into ‘Tokens.txt’, encrypts the file, and sends it to the C2 server.</p><p><img data-src="/assets/img/hornet/19.png" alt="Untitled" data-proofer-ignore></p><h3 id="setup_utils_send-function"><span class="mr-2">setup_utils_Send Function</span><a href="#setup_utils_send-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The <code class="language-plaintext highlighter-rouge">setup_utils_Send</code> function initially stores the stolen data files in the <code class="language-plaintext highlighter-rouge">\logs</code> folder. It then decrypts a string for use in the traffic encryption routine, generates a nonce for <code class="language-plaintext highlighter-rouge">AES GCM</code> encryption, and calculates the <code class="language-plaintext highlighter-rouge">MD5</code> of previously decrypted string to serve as the <code class="language-plaintext highlighter-rouge">AES GCM</code> encryption key. Finally, it encrypts the data and transmits it to the C2 server.</p><p>Decrypted string;</p><p><img data-src="/assets/img/hornet/20.png" alt="Untitled" data-proofer-ignore></p><p>Calculating MD5 and starts AES GCM;</p><p><img data-src="/assets/img/hornet/21.png" alt="Untitled" data-proofer-ignore></p><p>The encrypted traffic can be decrypted using Python, as demonstrated by the following code snippet.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers</span> <span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">modes</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.backends</span> <span class="kn">import</span> <span class="n">default_backend</span>
<span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">unhexlify</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cipher_hex</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">cipher_bytes</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">cipher_hex</span><span class="p">)</span>

    <span class="n">nonce_size</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">tag_size</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">cipher_bytes</span><span class="p">[:</span><span class="n">nonce_size</span><span class="p">]</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">cipher_bytes</span><span class="p">[</span><span class="o">-</span><span class="n">tag_size</span><span class="p">:]</span>
    <span class="n">cipher_text</span> <span class="o">=</span> <span class="n">cipher_bytes</span><span class="p">[</span><span class="n">nonce_size</span><span class="p">:</span><span class="o">-</span><span class="n">tag_size</span><span class="p">]</span>

    <span class="n">decryptor</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">(</span>
        <span class="n">algorithms</span><span class="p">.</span><span class="n">AES</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
        <span class="n">modes</span><span class="p">.</span><span class="n">GCM</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">tag</span><span class="p">),</span>
        <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">()</span>
    <span class="p">).</span><span class="n">decryptor</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">decryptor</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">cipher_text</span><span class="p">)</span> <span class="o">+</span> <span class="n">decryptor</span><span class="p">.</span><span class="n">finalize</span><span class="p">()</span>

<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'7b1da832deb12b2dd4065c7c43aec101'</span>
<span class="n">encrypted_hex</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">decrypted_text</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_hex</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Decrypted text:"</span><span class="p">,</span> <span class="n">decrypted_text</span><span class="p">)</span>
</pre></table></code></div></div><p>To maintain the confidentiality of my VM’s specifics, I’ve truncated and randomized the decrypted data, but the representation below illustrates how it appears.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Decrypted text: b'G\xff\x81\x03\x01\x01\x07FileObj\x01\xff\x82\x00\x01\x04\x01\x08FileName\x01\x0c\x00\x01\x08IsFolder\x01\x02\x00\x01\x08FileByte\x01\n\x00\x01\x05Files\x01\xff\x84\x00\x00\x00\x1e\xff\x83\x02\x01\x01\x0f[]utils.FileObj\x01\xff\x84\x00\x01\xff\x82\x00\x00\xfe\x07\xdc\xff\x82\x01\rMainFolderLog\x01\x01\x02\x02\x01\x13UserInformation.txt\x02\xfe\x01NTags: Installs\nBuildId: Installs\nUserName: WIN10\\admin\nCPU: 14th Gen Intel(R) Core(TM) i15-15200 (1 cores)\nGPU: VMware SVGA 3D\nRAM: 8190 MB\nOS: Microsoft Windows 10 Enterprise\nCurrent date: 2099.08.29 00:05:04\nTimeZone: UTC +2 Hours\nLanguage: en-US\nArchitecture: x64-based PC\nScreen: 3238 x 1274\nHWID: 3782542AB18F411BC42897C0D3D0FB3E\n\n\x00\x01\x15InstalledSoftware.txt\x02\xfe\x06B%!(EXTRA string=\t7-Zip 18.01 (x64)\n\tExplorer Suite IV\n\tHxD Hex Editor 2.5\n\tIDA Freeware 8.3\n\t\n)\x00\x00'
</pre></table></code></div></div><p>The presence of non-ASCII characters in the decrypted data suggests the possibility of serialized object usage.</p><h1 id="part-3---c2-panel">Part 3 - C2 Panel</h1><p>While all traffic between the malware and the C2 server is encrypted and sent via <code class="language-plaintext highlighter-rouge">TCP</code> to the server’s port <code class="language-plaintext highlighter-rouge">8080</code>, <a href="https://twitter.com/spamhaus/status/1750170178493526350">@spamhaus</a>’s tweet also indicates the existence of an HTTP web application used for the C2 panel.</p><p><img data-src="/assets/img/hornet/22.png" alt="Untitled" data-proofer-ignore></p><p>As of the time of writing this article, the C2 server shared by <a href="https://twitter.com/spamhaus/status/1750170178493526350">@spamhaus</a> is currently inaccessible.</p><p>Guided by <a href="https://twitter.com/spamhaus/status/1750170178493526350">@spamhaus</a>’s tweet, which identifies the malware as <code class="language-plaintext highlighter-rouge">Hornet Stealer</code> based on the <code class="language-plaintext highlighter-rouge">panel logo</code> and <code class="language-plaintext highlighter-rouge">name</code>, we can conduct targeted Censys searches using queries like;</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>services.http.response.body:"Welcome back!" AND services.http.response.body:"Happy to see you again!" AND services.http.response.body:"Username" AND services.http.response.body:"Password" AND services.port:8080

services.http.response.body:"Hornet Stealer"

services.http.response.body:"Hornet" AND services.http.response.body:"Stealer"
</pre></table></code></div></div><p>However, none of these queries succeeded in finding a new C2 address.</p><h1 id="part-4---yara-rule-and-string-extractor">Part 4 - Yara Rule and String Extractor</h1><h2 id="yara-rule"><span class="mr-2">Yara Rule</span><a href="#yara-rule" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In the Yara Rule section of our article, considering the encryption of most strings, we will concentrate on certain key aspects and plaintext strings for crafting our Yara rule. This includes focusing on encryption methods utilized by the malware, such as <code class="language-plaintext highlighter-rouge">Fernet</code> and <code class="language-plaintext highlighter-rouge">AES-GCM</code>, as well as unique user code function names.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="n">rule</span> <span class="n">HornetStealer_Golang</span> <span class="p">{</span>
	<span class="n">meta</span><span class="o">:</span>
		<span class="n">author</span> <span class="o">=</span> <span class="s2">"tufan - @tufan_gngr"</span>
		<span class="n">description</span> <span class="o">=</span> <span class="s2">"Detects Hornet stealer non-stripped samples"</span>
		<span class="n">date</span> <span class="o">=</span> <span class="s2">"2024-01-30"</span>
		<span class="n">references</span> <span class="o">=</span> <span class="s2">"https://tufan-gungor.github.io/"</span>
		<span class="n">references</span> <span class="o">=</span> <span class="s2">"https://twitter.com/spamhaus/status/1750170178493526350"</span>
		<span class="n">hash</span> <span class="o">=</span> <span class="s2">"bc3ee10c21cb07bc0dd6b84a6eaf8efbd0af889467ab7ef647acf60f8c188e83"</span>
	<span class="n">strings</span><span class="o">:</span>
		<span class="nv">$s1</span> <span class="o">=</span> <span class="s2">"main"</span>
		<span class="nv">$s2</span> <span class="o">=</span> <span class="s2">"setup/utils"</span>
		<span class="nv">$s3</span> <span class="o">=</span> <span class="s2">"crypto/cipher.NewGCM"</span>
		<span class="nv">$s4</span> <span class="o">=</span> <span class="s2">"fernet"</span>

		<span class="nv">$a1</span> <span class="o">=</span> <span class="s2">"launchBrowser"</span>
		<span class="nv">$a2</span> <span class="o">=</span> <span class="s2">"launchDesktopWallet"</span>
		<span class="nv">$a3</span> <span class="o">=</span> <span class="s2">"launchDiscord"</span>
		<span class="nv">$a4</span> <span class="o">=</span> <span class="s2">"launchSteam"</span>
		<span class="nv">$a5</span> <span class="o">=</span> <span class="s2">"launchTelegram"</span>
		<span class="nv">$a6</span> <span class="o">=</span> <span class="s2">"launchWallet"</span>
		<span class="nv">$a7</span> <span class="o">=</span> <span class="s2">"launchUserInfo"</span>
	<span class="n">condition</span><span class="o">:</span>
		<span class="nf">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5a4d</span> <span class="k">and</span> 
		<span class="p">(</span><span class="mi">5</span> <span class="nf">of</span> <span class="p">(</span><span class="nv">$a</span><span class="o">*</span><span class="p">))</span> <span class="k">or</span>
		<span class="p">(</span><span class="c1">#s1 &gt; 10 and #s2 &gt; 20 and $s3 and $s4)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The Yara searches conducted on <code class="language-plaintext highlighter-rouge">Unpacme</code> and <code class="language-plaintext highlighter-rouge">VirusTotal</code> did not yield any new samples, only returning the one we already possess.</p><p>In addition to our Yara rule, other string searches, as listed below, also failed to yield any results.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nc">C</span><span class="o">:/</span><span class="nc">Users</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="nc">Desktop</span><span class="o">/</span><span class="nc">GOAdmin</span>
<span class="n">main</span><span class="mf">.</span><span class="n">launchDesktopwallet</span>
<span class="n">setup</span><span class="o">/</span><span class="n">utils</span><span class="mf">.</span><span class="nc">Send</span>
</pre></table></code></div></div><h2 id="string-extractor--decryptor"><span class="mr-2">String Extractor / Decryptor</span><a href="#string-extractor--decryptor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In the String Extractor/Decryptor segment, we now focus on developing a Python decryptor for the malware’s encrypted strings, given that we have the necessary tools at hand. A notable difficulty, however, lies in the Golang structure, where the lack of <code class="language-plaintext highlighter-rouge">null bytes</code> between strings complicates their extraction without causing breaks.</p><p>Consequently, we will employ Mandiant’s tool known as <a href="https://github.com/mandiant/flare-floss">FLOSS (FLARE Obfuscated String Solver)</a> for extracting strings from the Golang binary. As of December 12, 2023, FLOSS has included support for Golang string extraction.</p><p>Our first step is to execute <code class="language-plaintext highlighter-rouge">FLOSS</code> on the <code class="language-plaintext highlighter-rouge">Hornet Stealer</code>, and then we will capture and store the resulting output in an <code class="language-plaintext highlighter-rouge">output.txt</code> file.”</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">.</span><span class="n">\floss.exe</span><span class="w"> </span><span class="o">.</span><span class="nx">\hornet.exe</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">output.txt</span><span class="w">
</span></pre></table></code></div></div><p>Subsequently, our string decryptor will process each line from the <code class="language-plaintext highlighter-rouge">output.txt</code> file, decrypting them with the <code class="language-plaintext highlighter-rouge">Fernet</code> key. Successful decryptions will result in the decrypted text being printed.</p><p>Here is our Python code;</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>

<span class="k">def</span> <span class="nf">decrypt_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">fernet</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">fernet</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">decrypted_data</span><span class="p">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">decrypt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">decrypt_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">decrypted_data</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Decrypted Data:"</span><span class="p">,</span> <span class="n">decrypted_data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s">'output.txt'</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s">'MpQzH0ne3b-TkBgkJ0tbdALxiCiJuLBleGUlEoIGQoo='</span>
    <span class="n">decrypt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
</pre><td class="rouge-code"><pre>Decrypted Data: Tags: %s
BuildId: %s
UserName: %s
CPU: %s
GPU: %s
RAM: %s
OS: %s
Current date: %s
TimeZone: %s
Language: %s
Architecture: %s
Screen: %s
HWID: %s

Decrypted Data: user32.dll
Decrypted Data: usertag
Decrypted Data: False
Decrypted Data: Tokens.txt
Decrypted Data: LocalFree
Decrypted Data: Kernel32.dll
Decrypted Data: Language
Decrypted Data: SteamInfo.txt
Decrypted Data: leveldb
Decrypted Data: Wallet
Decrypted Data: Login Data
Decrypted Data: MainFolderLog
Decrypted Data: key_data
Decrypted Data: .ldb
Decrypted Data: DisplayName
Decrypted Data: Web Data
Decrypted Data: vdf
Decrypted Data: False
Decrypted Data: cookies.sqlite
Decrypted Data: Telegram
Decrypted Data: Installs
Decrypted Data: Desktop Wallets
Decrypted Data: Running
Decrypted Data: Installs
Decrypted Data: logins.json
Decrypted Data: ssfn
Decrypted Data: Installed
Decrypted Data: .log
Decrypted Data: Local State
Decrypted Data: Updating
Decrypted Data: SteamPath
Decrypted Data: AutoLoginUser
Decrypted Data: tdata
Decrypted Data: False
Decrypted Data: Crypt32.dll
Decrypted Data: settings
Decrypted Data: Extensions
Decrypted Data: UserInformation.txt
Decrypted Data: GetKeyboardLayoutList
Decrypted Data: InstalledSoftware.txt
Decrypted Data: CryptUnprotectData
Decrypted Data: Software\\Valve\\Steam
Decrypted Data: discord\\Local Storage\\leveldb
Decrypted Data: os_crypt.encrypted_key
Decrypted Data: Software\\Valve\\Steam\\Apps\\
Decrypted Data: AutoLogin: %s\nLanguage: %s\n\n
Decrypted Data: 185.221.198.118:8080
Decrypted Data: Software\\Valve\\Steam\\Apps
Decrypted Data: JAGSDiusuidsgdisbdhb32te72hqbsilydfg1
Decrypted Data: discordptb\\Local Storage\\leveldb
Decrypted Data: discordcanary\\Local Storage\\leveldb
Decrypted Data: [\w-]{24}\.[\w-]{6}\.[\w-]{25,110}
Decrypted Data: 5hKEw9TAVDZPA6CblkDK86Dhd9HF1E5B
Decrypted Data: SELECT ExecutablePath FROM Win32_Process WHERE Name =
Decrypted Data: SELECT Caption, MUILanguages FROM win32_operatingsystem
Decrypted Data: SELECT Name, NumberOfCores, ProcessorId FROM Win32_Processor
Decrypted Data: SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall
Decrypted Data: SELECT VolumeSerialNumber FROM Win32_LogicalDisk WHERE DeviceID =
Decrypted Data: Select Model, SystemType, TotalPhysicalMemory, CurrentTimeZone From Win32_ComputerSystem
Decrypted Data: SELECT Name, CurrentHorizontalResolution, CurrentVerticalResolution  FROM Win32_VideoController
Decrypted Data: Application %s\n\tGameID: %s\n\tInstalled: %s\n\tRunning: %s\n\tUpdating: %s\n\n
Decrypted Data: Telegram Desktop
Decrypted Data: Tags: %s
BuildId: %s
UserName: %s
CPU: %s
GPU: %s
RAM: %s
OS: %s
Current date: %s
TimeZone: %s
Language: %s
Architecture: %s
Screen: %s
HWID: %s

Decrypted Data: Exodus || exodus || Partitions || cache || dictionar
Atomic || atomic || cache || IndexedDB
JaxxLiberty || com.liberty.jaxx || cache
Coinomi || Coinomi\Coinomi\wallets || null-
Electrum || Electrum\wallets || null-
Electrum-LTC || Electrum-LTC\wallets || null-
ElectronCash || ElectronCash\wallets || null-
Guarda || Guarda || cache || IndexedDB
MyMonero || MyMonero || cache
Monero || Monero\\wallets || null-
Wasabi || WalletWasabi\\Client || tor || log
TokenPocket || TokenPocket || cache
Ledger Live || Ledger Live || cache || dictionar || sqlite
Binance || Binance || cache || null-
Decrypted Data: fhbohimaelbohpjbbldcngcnapndodjp || BinanceChain
fnjhmkhhmkbjkkabndcnnogagogbneec || Ronin
kjmoohlgokccodicjjfebfomlbljgfhk || Ronin
nkbihfbeogaeaoehlefnkodbefgpgknn || MetaMask
ejbalbakoplchlghecdalmeeeajnimhm || MetaMask
ibnejdfjmmkpcnlpebklmnkoeoihofec || TronLink
egjidjbpglichdcondbcbdnbeeppgdph || TrustWallet
bfnaelmomeimhlpmgjnjophhpkkoljpa || Phantom
hnfanknocfeofbddgcijnmhnfnkdnaad || Coinbase
odbfpeeihdkbihmopkbjmoonfanlbfcl || Brave
cgeeodpfagjceefieflmdfphplkenlfk || TON
aeachknmefphepccionboohckonoeemg || Coin98
mcohilncbfahbmgdjkbpemcciiolgcge || MetaX
hmeobnfnfcmdkdcmlblgagmfpfboieaf || XDEFI
lpilbniiabackdjcionkobglmddfbcjo || WavesKeeper
bhhhlbepdkbapadjdnnojkbgioiodbic || Solflare
acmacodkjbdgmoleebolmdjonilkdbch || Rabby
dkdedlpgdmmkkfjabffeganieamfklkm || CyanoWallet
cnmamaachppnkjgnildpdmkaakejnhae || AuroWallet
hcflpincpppdclinealmandijcmnkbgn || KHC
mnfifefkajgofkcjkemidiaecocnkjeh || TezBox
ookjlbkiijinhpmnjffcofjonbfbgaoc || Temple
flpiciilemghbmfalicajoolhkkenfel || ICONex
fhmfendgdocmcbmfikdcogofphimnkno || Sollet
nhnkbkgjikgcigadomkphalanndcapjk || CloverWallet
jojhfeoedkpkglbfimdfabpdfjaoolaf || PolymeshWallet
cphhlgmgameodnhkjdmkpanlelnlohao || NeoLine
dmkamcknogkgcdfhhbddcghachkejeap || Keplr
ajkhoeiiokighlmdnlakpjfoobnjinie || TerraStation
aiifbnbfobpmeekipheeijimdpnlpgpp || TerraStation
kpfopkelmapcoipemfendmdcghnegimn || Liquality
nkddgncdjgjfcddamfgcmfnlhccnimig || SaturnWallet
nanjmdknhkinifnkgdcggcfnhdaammmj || GuildWallet
jnkelfanjkeadonecabehalmbgpfodjm || Goby
nphplpgoakhhjchkkhmiggakijnkhfnd || TON
fpkhgmpbidmiogeglndfbkegfdlnajnf || Cosmostation
jiidiaalihmmhddjgbnbgdfflelocpak || BitKeep
pgiaagfkgcbnmiiolekcfmljdagdhlcm || Stargazer
cjelfplplebdjjenllpjcblmjkfcffne || JaxxLiberty
kkpllkodjeloidieedojogacfhpaihoh || Enkrypt
pkkjjapmlcncipeecdmlhaipahfdphkd || GameStopWallet
aholpfdialjgjfhomihkjbmgjidlcdno || ExodusWeb3Wallet
nngceckbapebfimnlniiiahkandclblb || Bitwarden
efbglgofoippbgcjepnhiblaibcnclgk || MartianAptos
jnlgamecbpmbajjfhmmmlhejkemejdma || Braavos
mcohilncbfahbmgdjkbpemcciiolgcge || OKX
phkbamefinggmakgklpkljjmgibohnba || PontemAptos
epapihdplajcdnnkdeiahlgigofloibg || SenderWallet
gjagmgiddbbciopjhllkdnddhcglnemk || Hashpack
cgeeodpfagjceefieflmdfphplkenlfk || EVER
cjmkndjhnagcfbpiemnkdpomccnjblmj || Finnie
aijcbedoijmgnlmjeegjaglmepbmpkpi || LeapTerra
ejjladinnckdgjemekebdpeokbikhfci || PetraAptos
kmhcihpebfmpgmihbkipmjlmmioameka || Eternl
bgpipimickeadkjlklgciifhnalhdjhe || GeroWallet
lpfcbjknijpeeillifnkikgncikgfhdo || NamiWallet
pocmplpaccanhmnllbbkpgfliimjljgo || SlopeWallet
ffnbelfdoeiohenkjibnmadjiehjhajb || Yoroi
afbcbjpbpfadlkmhmclhkeeodmamcflc || Math
hpglfhgfnhbgpjdenjgmdgoeiappafln || Guarda
kncchdigobghenbbaddojjnnaogfppfj || iWallet
amkmjjmmflddogmhpjloimipbofnfjih || Wombat
nlbmnnijcnlegkjjpcfjclmcfggfefdm || MEWCX
nknhiehlklippafakaeklbeglecifhad || NaboxWallet
jnmbobjmhlngoefaiojfljckilhhlhcj || OneKey
pdadjkfkgcafgbceimcpbkalnfnepbnk || KardiaChainWallet
</pre></table></code></div></div><h1 id="part-5---iocs">Part 5 - IOCs</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>bc3ee10c21cb07bc0dd6b84a6eaf8efbd0af889467ab7ef647acf60f8c188e83
185.221.198.118:8080
</pre></table></code></div></div><h1 id="references">References</h1><ul><li><a href="https://twitter.com/spamhaus/status/1750170178493526350">https://twitter.com/spamhaus/status/1750170178493526350</a><li><a href="https://github.com/mandiant/flare-floss">https://github.com/mandiant/flare-floss</a></ul><p><strong>I utilized AI assistance to fine-tune certain sentences in this post, enhancing clarity and precision.</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/malware-hunting/'>Malware Hunting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse engineering</a> <a href="/tags/malware-hunting/" class="post-tag no-text-decoration" >malware hunting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hunt and Analysis - Hornet Stealer - tufan.&amp;url=https://tufan-gungor.github.io/posts/hornet-stealer-analysis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hunt and Analysis - Hornet Stealer - tufan.&amp;u=https://tufan-gungor.github.io/posts/hornet-stealer-analysis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tufan-gungor.github.io/posts/hornet-stealer-analysis/&amp;text=Hunt and Analysis - Hornet Stealer - tufan." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spynote-android-malware/">Spynote Android Malware Masquerades as VPN Amid Turkey's Instagram Ban</a><li><a href="/posts/nightingale-stealer-analysis/">Hunt and Analysis - Nightingale Stealer</a><li><a href="/posts/hornet-stealer-analysis/">Hunt and Analysis - Hornet Stealer</a><li><a href="/posts/sentinel-stealer-analysis/">Hunt and Analysis - Sentinel Stealer</a><li><a href="/posts/neptune-loader-analysis/">Hunt and Analysis - Neptune Loader</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/serpent-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1704556800" > 2024-01-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Serpent Stealer</h3><div class="text-muted small"><p> Part 1 - Dissecting the First Serpent Stealer Sample On October 15, 2023, a new malware named Serpent Stealer was showcased on Breach Forums by a user named stealth. This malware, categorized as a...</p></div></div></a></div><div class="card"> <a href="/posts/neptune-loader-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705161600" > 2024-01-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Neptune Loader</h3><div class="text-muted small"><p> Part 1 - Neptune || A Native HTTP Loader A user named m0hx shared a post on hackforums.net on November 22, 2023, promoting a loader called Neptune. In the threat actor’s exact words; “Neptune is ...</p></div></div></a></div><div class="card"> <a href="/posts/sentinel-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705766400" > 2024-01-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Sentinel Stealer</h3><div class="text-muted small"><p> Part 1 - Sentinel Stealer || Stealer as a Service On January 19th, the Twitter account @FalconFeedsio reported the discovery of a new stealer, known as Sentinel Stealer. Although there were earlie...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/sentinel-stealer-analysis/" class="btn btn-outline-primary" prompt="Older"><p>Hunt and Analysis - Sentinel Stealer</p></a> <a href="/posts/nightingale-stealer-analysis/" class="btn btn-outline-primary" prompt="Newer"><p>Hunt and Analysis - Nightingale Stealer</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QEK7ERP9FL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QEK7ERP9FL'); }); </script>
